"use strict";(self.webpackChunkguardian_jtz_github_io=self.webpackChunkguardian_jtz_github_io||[]).push([[9337],{95059:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>s,metadata:()=>a,toc:()=>c});var o=n(74848),r=n(28453);const s={sidebar_position:150,tags:["Easy","Linux","\u6587\u4ef6\u4e0a\u4f20","SUID","docker","\u672a\u5b8c\u6210"],title:"Hamlet",description:"Hamlet",sidebar_label:"Hamlet",slug:"/tryhackme/150"},i="Hamlet",a={id:"box/TryHackMe/150",title:"Hamlet",description:"Hamlet",source:"@site/docs/box/TryHackMe/150.md",sourceDirName:"box/TryHackMe",slug:"/tryhackme/150",permalink:"/docs/tryhackme/150",draft:!1,unlisted:!1,tags:[{label:"Easy",permalink:"/docs/tags/easy"},{label:"Linux",permalink:"/docs/tags/linux"},{label:"\u6587\u4ef6\u4e0a\u4f20",permalink:"/docs/tags/\u6587\u4ef6\u4e0a\u4f20"},{label:"SUID",permalink:"/docs/tags/suid"},{label:"docker",permalink:"/docs/tags/docker"},{label:"\u672a\u5b8c\u6210",permalink:"/docs/tags/\u672a\u5b8c\u6210"}],version:"current",sidebarPosition:150,frontMatter:{sidebar_position:150,tags:["Easy","Linux","\u6587\u4ef6\u4e0a\u4f20","SUID","docker","\u672a\u5b8c\u6210"],title:"Hamlet",description:"Hamlet",sidebar_label:"Hamlet",slug:"/tryhackme/150"},sidebar:"boxSidebar",previous:{title:"WWBuddy",permalink:"/docs/tryhackme/149"},next:{title:"ContainMe",permalink:"/docs/tryhackme/151"}},l={},c=[{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:2},{value:"21",id:"21",level:2},{value:"80",id:"80",level:2},{value:"8000",id:"8000",level:2},{value:"\u540e\u6e17\u900f",id:"\u540e\u6e17\u900f",level:2},{value:"www-data(docker)",id:"www-datadocker",level:3},{value:"www-data(docker) \u2014&gt; root(docker)",id:"www-datadocker--rootdocker",level:3},{value:"root(docker) \u2014&gt; root",id:"rootdocker--root",level:3}];function d(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.h1,{id:"hamlet",children:"Hamlet"}),"\n",(0,o.jsx)(t.h2,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-php",children:'root@ip-10-10-77-80:~/hamlet# nmap -sTCV -p 21,22,80,501,8000,8080 --min-rate 1000 10.10.136.28\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2023-10-06 04:51 BST\nNmap scan report for ip-10-10-136-28.eu-west-1.compute.internal (10.10.136.28)\nHost is up (0.00028s latency).\n\nPORT     STATE SERVICE    VERSION\n21/tcp   open  ftp        vsftpd 3.0.3\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n| -rwxr-xr-x    1 0        0             113 Sep 15  2021 password-policy.md\n|_-rw-r--r--    1 0        0            1425 Sep 15  2021 ufw.status\n| ftp-syst: \n|   STAT: \n| FTP server status:\n|      Connected to ::ffff:10.10.77.80\n|      Logged in as ftp\n|      TYPE: ASCII\n|      No session bandwidth limit\n|      Session timeout in seconds is 300\n|      Control connection is plain text\n|      Data connections will be plain text\n|      At session startup, client count was 2\n|      vsFTPd 3.0.3 - secure, fast, stable\n|_End of status\n22/tcp   open  ssh        OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   2048 a0:ef:4c:32:28:a6:4c:7f:60:d6:a6:63:32:ac:ab:27 (RSA)\n|   256 5a:6d:1a:39:97:00:be:c7:10:6e:36:5c:7f:ca:dc:b2 (ECDSA)\n|_  256 0b:77:40:b2:cc:30:8d:8e:45:51:fa:12:7c:e2:95:c7 (EdDSA)\n80/tcp   open  http       lighttpd 1.4.45\n|_http-server-header: lighttpd/1.4.45\n|_http-title: Hamlet Annotation Project\n501/tcp  open  tcpwrapped\n8000/tcp open  http       Apache httpd 2.4.48 ((Debian))\n|_http-open-proxy: Proxy might be redirecting requests\n|_http-server-header: Apache/2.4.48 (Debian)\n|_http-title: Site doesn\'t have a title (text/html).\n8080/tcp open  http-proxy\n| fingerprint-strings: \n|   FourOhFourRequest: \n|     HTTP/1.1 500 \n|     Content-Type: application/json;charset=UTF-8\n|     Date: Fri, 06 Oct 2023 03:51:35 GMT\n|     Connection: close\n|     {"timestamp":1696564296315,"status":500,"error":"Internal Server Error","exception":"org.springframework.security.web.firewall.RequestRejectedException","message":"The request was rejected because the URL contained a potentially malicious String "%2e"","path":"/nice%20ports%2C/Tri%6Eity.txt%2ebak"}\n|   GetRequest: \n|     HTTP/1.1 302 \n|     Set-Cookie: JSESSIONID=D6D0262F1DC8DF0DDCB36DE0D977D15A; Path=/; HttpOnly\n|     X-Content-Type-Options: nosniff\n|     X-XSS-Protection: 1; mode=block\n|     Cache-Control: no-cache, no-store, max-age=0, must-revalidate\n|     Pragma: no-cache\n|     Expires: 0\n|     X-Frame-Options: SAMEORIGIN\n|     Location: http://localhost:8080/login.html\n|     Content-Length: 0\n|     Date: Fri, 06 Oct 2023 03:51:35 GMT\n|     Connection: close\n|   HTTPOptions: \n|     HTTP/1.1 302 \n|     Set-Cookie: JSESSIONID=73618669873A8066F2B2FBA661278187; Path=/; HttpOnly\n|     X-Content-Type-Options: nosniff\n|     X-XSS-Protection: 1; mode=block\n|     Cache-Control: no-cache, no-store, max-age=0, must-revalidate\n|     Pragma: no-cache\n|     Expires: 0\n|     X-Frame-Options: SAMEORIGIN\n|     Location: http://localhost:8080/login.html\n|     Content-Length: 0\n|     Date: Fri, 06 Oct 2023 03:51:35 GMT\n|     Connection: close\n|   RTSPRequest: \n|     HTTP/1.1 400 \n|     Content-Type: text/html;charset=utf-8\n|     Content-Language: en\n|     Content-Length: 435\n|     Date: Fri, 06 Oct 2023 03:51:35 GMT\n|     Connection: close\n|     <!doctype html><html lang="en"><head><title>HTTP Status 400 \n|     Request</title><style type="text/css">body {font-family:Tahoma,Arial,sans-serif;} h1, h2, h3, b {color:white;background-color:#525D76;} h1 {font-size:22px;} h2 {font-size:16px;} h3 {font-size:14px;} p {font-size:12px;} a {color:black;} .line {height:1px;background-color:#525D76;border:none;}</style></head><body><h1>HTTP Status 400\n'})}),"\n",(0,o.jsx)(t.h2,{id:"21",children:"21"}),"\n",(0,o.jsx)(t.p,{children:"\u5b58\u5728 FTP \u7684\u533f\u540d\u8eab\u4efd\u767b\u9646\u6211\u4eec\u53ef\u4ee5\u4ece\u8fd9\u91cc\u767b\u9646, \u6211\u4eec\u53ef\u4ee5\u4ece\u5176\u4e2d\u5f97\u5230\u4e24\u4e2a\u6587\u4ef6:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"password-policy.md   : \u5bc6\u7801\u7b56\u7565, \u544a\u8bc9\u6211\u4eec \u5bc6\u7801\u5168\u90e8\u5c0f\u5199 12-14"}),"\n",(0,o.jsx)(t.li,{children:"ufw.status : \u7aef\u53e3\u5f00\u653e\u72b6\u6001\u4f30\u8ba1\u662f\u5185\u7f51\u7684\u4e1c\u897f"}),"\n"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-php",children:"root@ip-10-10-77-80:~/hamlet# ftp 10.10.136.28\nConnected to 10.10.136.28.\n220 (vsFTPd 3.0.3)\nName (10.10.136.28:root): anonymous\n331 Please specify the password.\nPassword:\n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp> passive  # \u9700\u8981\u5f00\u542f\u88ab\u52a8\u6a21\u5f0f\nPassive mode on.\nftp> ls -al\n227 Entering Passive Mode (10,10,136,28,197,89).\n150 Here comes the directory listing.\ndrwxr-xr-x    2 0        114          4096 Sep 15  2021 .\ndrwxr-xr-x    2 0        114          4096 Sep 15  2021 ..\n-rwxr-xr-x    1 0        0             113 Sep 15  2021 password-policy.md  \n-rw-r--r--    1 0        0            1425 Sep 15  2021 ufw.status\n"})}),"\n",(0,o.jsx)(t.h2,{id:"80",children:"80"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-php",children:"root@ip-10-10-77-80:~/hamlet# gobuster dir -u http://10.10.136.28/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.136.28/\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Extensions:     php,txt,html\n[+] Timeout:        10s\n===============================================================\n2023/10/06 04:54:07 Starting gobuster\n===============================================================\n/index.html (Status: 200)\n/robots.txt (Status: 200)\n/hamlet.txt (Status: 200)\n/%7Echeckout%7E (Status: 403)\n===============================================================\n2023/10/06 04:55:17 Finished\n===============================================================\n"})}),"\n",(0,o.jsx)(t.p,{children:"\u8bbf\u95ee\u754c\u9762, \u6211\u4eec\u53ef\u4ee5\u4ece\u754c\u9762\u7684\u5185\u5bb9\u4e2d\u786e\u5b9a\u4ee5\u4e0b\u4e8b\u60c5:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"\u7528\u6237\u540d : ghost"}),"\n",(0,o.jsx)(t.li,{children:"\u4f5c\u8005\u5bf9 hamlet \u75f4\u8ff7, \u7ed3\u5408\u4e4b\u524d FTP \u7684\u77e5\u8bc6\u6211\u4eec\u83b7\u53d6\u53ef\u4ee5\u501f\u6b64\u6765\u521b\u5efa\u5bc6\u7801\u6587\u4ef6"}),"\n"]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-182928.png",alt:"image-20240709182927533"})}),"\n",(0,o.jsx)(t.h2,{id:"8000",children:"8000"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-php",children:"root@ip-10-10-77-80:~/hamlet# gobuster dir -u http://10.10.136.28:8000/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.136.28:8000/\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Extensions:     php,txt,html\n[+] Timeout:        10s\n===============================================================\n2023/10/06 04:58:07 Starting gobuster\n===============================================================\n/index.html (Status: 200)\n/db (Status: 301)\n/repository (Status: 301)\n/server-status (Status: 403)\n===============================================================\n2023/10/06 05:04:24 Finished\n===============================================================\n"})}),"\n",(0,o.jsxs)(t.p,{children:["\u6839\u636e\u9898\u76ee\u7684, \u8be2\u95ee\u6211\u4eec michael \u7684\u5bc6\u7801, \u6211\u4eec\u53ef\u4ee5\u57fa\u4e8e\u4e0a\u9762\u7684\u5bc6\u7801\u7b56\u7565\u521b\u5efa\u5bc6\u7801\u5e93\u8fdb\u884c\u6d4b\u8bd5 ",(0,o.jsx)(t.a,{href:"https://exploit-notes.hdks.org/exploit/web/webanno-pentesting/",children:"WebAnno Pentesting | Exploit Notes"})]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-php",children:"root@ip-10-10-77-80:~/hamlet# cewl http://10.10.136.28/hamlet.txt | tr '[:upper:]' '[:lower:]' | awk 'length($0)>=12 && length($0)<=14' | sort -u > wordlist.txt\n"})}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-182939.png",alt:"image-20240709182938130"})}),"\n",(0,o.jsx)(t.h2,{id:"\u540e\u6e17\u900f",children:"\u540e\u6e17\u900f"}),"\n",(0,o.jsx)(t.h3,{id:"www-datadocker",children:"www-data(docker)"}),"\n",(0,o.jsx)(t.p,{children:"\u8bbf\u95ee\u6211\u4eec\u4e0a\u4f20\u7684 Shell"}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-183011.png",alt:"image-20240709183009846"})}),"\n",(0,o.jsx)(t.h3,{id:"www-datadocker--rootdocker",children:"www-data(docker) \u2014> root(docker)"}),"\n",(0,o.jsxs)(t.p,{children:["\u6211\u53d1\u73b0\u5728\u7cfb\u7edf\u4e2d\u5b58\u5728\u4e00\u4e2a SUID \u7a0b\u5e8f ",(0,o.jsx)(t.a,{href:"https://gtfobins.github.io/gtfobins/cat/#suid",children:"cat#suid"})]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-183021.png",alt:"image-20240709183020384"})}),"\n",(0,o.jsxs)(t.p,{children:["\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u6b64\u6765\u8bfb\u53d6 shadow \u6765\u8fdb\u884c\u7834\u89e3\u5bc6\u7801 (\u8fd9\u91cc\u4f60\u8981\u4f7f\u7528\u6700\u65b0\u7248\u7684 John \u5426\u5219\u53ef\u80fd\u4e0d\u592a\u884c) \u8fd9\u91cc\u6211\u5e76\u6ca1\u6709\u89e3\u5bc6\u51fa\u6765, \u56e0\u4e3a\u81ea\u5df1\u7684\u73af\u5883\u5168\u90e8G\u4e86, \u5bfb\u627e\u540e\u53d1\u73b0\u660e\u6587 ",(0,o.jsx)(t.code,{children:"murder"})]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-183050.png",alt:"image-20240709183049013"})}),"\n",(0,o.jsx)(t.h3,{id:"rootdocker--root",children:"root(docker) \u2014> root"}),"\n",(0,o.jsxs)(t.p,{children:["\u5982\u679c\u6b64\u65f6\u67e5\u770b dev \u76ee\u5f55\u4f60\u4f1a\u53d1\u73b0\u5176\u4e2d\u5b58\u5728\u4e00\u4e2a ",(0,o.jsx)(t.code,{children:"dm-0"})," \u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u6302\u8f7d\u5230\u672c\u5730"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-php",children:"root@66505608bd11:/dev#  mkdir /mnt/mydevice\nroot@66505608bd11:/dev#  mount /dev/dm-0 /mnt/mydevice\nroot@66505608bd11:/dev# cd /mnt/mydevice/\nroot@66505608bd11:/mnt/mydevice# ls -al\ntotal 4015224\ndrwxr-xr-x 24 root root       4096 Sep 15  2021 .\ndrwxr-xr-x  1 root root       4096 Oct  6 07:49 ..\ndrwxr-xr-x  2 root root       4096 Sep 15  2021 bin\ndrwxr-xr-x  2 root root       4096 Sep 15  2021 boot\ndrwxr-xr-x  2 root root       4096 Sep 15  2021 cdrom\ndrwxr-xr-x  4 root root       4096 Aug  6  2020 dev\n"})})]})}function p(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>a});var o=n(96540);const r={},s=o.createContext(r);function i(e){const t=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),o.createElement(s.Provider,{value:t},e.children)}}}]);