"use strict";(self.webpackChunkguardian_jtz_github_io=self.webpackChunkguardian_jtz_github_io||[]).push([[9299],{10092:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>c,contentTitle:()=>a,default:()=>p,frontMatter:()=>t,metadata:()=>o,toc:()=>l});var i=s(74848),r=s(28453);const t={sidebar_position:76,tags:["Easy","Linux","SQLI","\u6587\u4ef6\u4e0a\u4f20","\u4fe1\u606f\u6cc4\u9732","SUID"],title:"Expose",description:"Expose",sidebar_label:"Expose",slug:"/tryhackme/76"},a="Expose",o={id:"box/TryHackMe/76",title:"Expose",description:"Expose",source:"@site/docs/box/TryHackMe/76.md",sourceDirName:"box/TryHackMe",slug:"/tryhackme/76",permalink:"/docs/tryhackme/76",draft:!1,unlisted:!1,tags:[{label:"Easy",permalink:"/docs/tags/easy"},{label:"Linux",permalink:"/docs/tags/linux"},{label:"SQLI",permalink:"/docs/tags/sqli"},{label:"\u6587\u4ef6\u4e0a\u4f20",permalink:"/docs/tags/\u6587\u4ef6\u4e0a\u4f20"},{label:"\u4fe1\u606f\u6cc4\u9732",permalink:"/docs/tags/\u4fe1\u606f\u6cc4\u9732"},{label:"SUID",permalink:"/docs/tags/suid"}],version:"current",sidebarPosition:76,frontMatter:{sidebar_position:76,tags:["Easy","Linux","SQLI","\u6587\u4ef6\u4e0a\u4f20","\u4fe1\u606f\u6cc4\u9732","SUID"],title:"Expose",description:"Expose",sidebar_label:"Expose",slug:"/tryhackme/76"},sidebar:"boxSidebar",previous:{title:"KoTH Food CTF",permalink:"/docs/tryhackme/75"},next:{title:"Red",permalink:"/docs/tryhackme/77"}},c={},l=[{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:2},{value:"21 - FTP",id:"21---ftp",level:2},{value:"1337",id:"1337",level:2},{value:"\u540e\u6e17\u900f",id:"\u540e\u6e17\u900f",level:2},{value:"www-data",id:"www-data",level:3},{value:"www-data \u2014&gt; zeamkish",id:"www-data--zeamkish",level:3},{value:"zeamkish \u2014&gt; root",id:"zeamkish--root",level:3}];function d(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.h1,{id:"expose",children:"Expose"}),"\n",(0,i.jsx)(e.h2,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"root@ip-10-10-101-245:~/expose# nmap -sTCV -p 21,22,53,1337,1883 --min-rate 1000  10.10.188.190\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2023-09-07 01:28 BST\nNmap scan report for ip-10-10-188-190.eu-west-1.compute.internal (10.10.188.190)\nHost is up (0.00024s latency).\n\nPORT     STATE SERVICE                 VERSION\n21/tcp   open  ftp                     vsftpd 2.0.8 or later\n|_ftp-anon: Anonymous FTP login allowed (FTP code 230)\n| ftp-syst: \n|   STAT: \n| FTP server status:\n|      Connected to ::ffff:10.10.101.245\n|      Logged in as ftp\n|      TYPE: ASCII\n|      No session bandwidth limit\n|      Session timeout in seconds is 300\n|      Control connection is plain text\n|      Data connections will be plain text\n|      At session startup, client count was 4\n|      vsFTPd 3.0.3 - secure, fast, stable\n|_End of status\n22/tcp   open  ssh                     OpenSSH 8.2p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0)\n53/tcp   open  domain                  ISC BIND 9.16.1-Ubuntu\n| dns-nsid: \n|_  bind.version: 9.16.1-Ubuntu\n1337/tcp open  http                    Apache httpd 2.4.41 ((Ubuntu))\n|_http-server-header: Apache/2.4.41 (Ubuntu)\n|_http-title: EXPOSED\n1883/tcp open  mosquitto version 1.6.9\n| mqtt-subscribe: \n|   Topics and their most recent payloads: \n|     $SYS/broker/load/bytes/sent/1min: 370.96\n|     $SYS/broker/clients/active: 1\n|     $SYS/broker/load/connections/15min: 0.13\n|     $SYS/broker/load/bytes/received/5min: 13.55\n|     $SYS/broker/store/messages/count: 31\n|     $SYS/broker/retained messages/count: 35\n|     $SYS/broker/load/sockets/15min: 0.26\n|     $SYS/broker/heap/current: 51056\n|     $SYS/broker/subscriptions/count: 2\n|     $SYS/broker/clients/total: 1\n|     $SYS/broker/uptime: 836 seconds\n|     $SYS/broker/load/messages/sent/15min: 0.93\n|     $SYS/broker/clients/connected: 1\n|     $SYS/broker/load/messages/received/15min: 0.20\n|     $SYS/broker/messages/sent: 14\n|     $SYS/broker/heap/maximum: 51456\n|     $SYS/broker/load/publish/sent/15min: 0.73\n|     $SYS/broker/load/connections/1min: 1.83\n|     $SYS/broker/clients/disconnected: 0\n|     $SYS/broker/publish/bytes/sent: 60\n|     $SYS/broker/load/bytes/sent/15min: 26.90\n|     $SYS/broker/load/messages/sent/1min: 12.79\n|     $SYS/broker/load/bytes/received/15min: 4.57\n|     $SYS/broker/load/publish/sent/1min: 10.05\n|     $SYS/broker/version: mosquitto version 1.6.9\n|     $SYS/broker/load/sockets/1min: 2.96\n|     $SYS/broker/publish/messages/sent: 11\n|     $SYS/broker/store/messages/bytes: 146\n|     $SYS/broker/messages/stored: 31\n|     $SYS/broker/load/bytes/sent/5min: 79.73\n|     $SYS/broker/bytes/received: 69\n|     $SYS/broker/messages/received: 3\n|     $SYS/broker/load/messages/sent/5min: 2.75\n|     $SYS/broker/load/bytes/received/1min: 63.04\n|     $SYS/broker/clients/inactive: 0\n|     $SYS/broker/load/publish/sent/5min: 2.16\n|     $SYS/broker/bytes/sent: 406\n|     $SYS/broker/load/sockets/5min: 0.75\n|     $SYS/broker/load/messages/received/1min: 2.74\n|     $SYS/broker/clients/maximum: 1\n|     $SYS/broker/load/messages/received/5min: 0.59\n|_    $SYS/broker/load/connections/5min: 0.39\nMAC Address: 02:AE:53:2B:6C:C7 (Unknown)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 23.93 seconds\n"})}),"\n",(0,i.jsx)(e.h2,{id:"21---ftp",children:"21 - FTP"}),"\n",(0,i.jsx)(e.p,{children:"\u6211\u5c1d\u8bd5\u4f7f\u7528 anonymous \u767b\u9646 FTP \u670d\u52a1, \u53d1\u73b0\u53ef\u4ee5\u767b\u9646\u4f46\u662f\u6ca1\u6709\u4efb\u4f55\u5185\u5bb9, \u6211\u5728\u6b64\u60f3\u7684\u662f:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u6709\u53ef\u80fd\u662f\u7f51\u7ad9\u67d0\u4e2a\u6587\u4ef6\u4e0a\u4f20\u5b58\u50a8\u4f4d\u7f6e\u53ef\u4ee5\u5728\u6b64\u4e0a\u4f20 Shell \u7b49\u7b49 \u4f46\u662f\u4e8b\u5b9e\u4e0d\u662f\u8fd9\u6837\u7684"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703194050.png",alt:"20240703194050"})}),"\n",(0,i.jsx)(e.h2,{id:"1337",children:"1337"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703194100.png",alt:"20240703194100"})}),"\n",(0,i.jsx)(e.p,{children:"\u53d1\u73b0\u5982\u4e0b\u5185\u5bb9:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"admin : \u4e00\u4e2a\u767b\u9646\u7ad9\u70b9, \u4f46\u662f\u67e5\u770b\u7f51\u9875\u6e90\u4ee3\u7801\u5224\u65ad\u4e3a\u662f\u4e00\u4e2a\u9759\u6001\u9875\u9762"}),"\n",(0,i.jsx)(e.li,{children:"phpmyadmin : \u5f31\u5bc6\u7801\u65e0\u6cd5\u767b\u9646, \u540c\u65f6\u4e5f\u6ca1\u6709\u529e\u6cd5\u786e\u5b9a\u7528\u6237, \u6240\u4ee5\u66b4\u529b\u731c\u6d4b\u5e76\u4e0d\u53ef\u53d6"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u67e5\u770b\u63d0\u793a\u540e, \u53d1\u73b0\u9700\u8981\u6362\u4e00\u4e2a\u5b57\u5178\u8fdb\u884c\u626b\u63cf, \u56e0\u4e3a\u9898\u4e3b\u5c06\u5176\u6587\u4ef6\u540d\u6539\u4e86, \u518d\u6b21\u626b\u63cf"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703194111.png",alt:"20240703194111"})}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u8fd9\u6b21\u626b\u63cf\u4e2d\u51fa\u73b0\u4e86:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"admin_101 : \u8bbf\u95ee\u540e\u786e\u5b9a\u662f\u4e00\u4e2a\u767b\u9646\u7ad9\u70b9, \u540c\u65f6\u53ef\u4ee5\u786e\u5b9a\u7684\u662f\u8fd9\u4e2a\u5c31\u662f\u767b\u9646\u9875\u9762, \u5e76\u4e14\u8fd8\u9ed8\u8ba4\u63d0\u4f9b\u4e86\u4e00\u4e2a\u7528\u6237\u540d"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6211\u5c1d\u8bd5\u767b\u9646\u5e76\u67e5\u770b\u5176\u8bf7\u6c42\u53d1\u73b0\u8fd9\u5176\u5b9e\u662f\u4e00\u4e2a SQL \u6ce8\u5165\u6f0f\u6d1e"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703194129.png",alt:"20240703194129"})}),"\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528 sqlmap \u76f4\u63a5\u5f00\u8dd1\u5373\u53ef, \u8fd9\u4e00\u6bb5\u5185\u5bb9\u5c31\u7701\u7565, \u6700\u7ec8\u5728 expose \u6570\u636e\u5e93\u4e2d\u6211\u627e\u5230\u4e86\u4e00\u4e9b\u5173\u952e\u5185\u5bb9"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"Database: expose\nTable: user\n[4 entries]\n+--------------------------------------+--------------------------------------+--------------------------------------+--------------------------------------+\n| id                                   | email                                | created                              | password                             |\n+--------------------------------------+--------------------------------------+--------------------------------------+--------------------------------------+\n| 2023-02-21 09:05:46                  | 2023-02-21 09:05:46                  | 2023-02-21 09:05:46                  | 2023-02-21 09:05:46                  |\n| hacker@root.thm                      | hacker@root.thm                      | hacker@root.thm                      | hacker@root.thm                      |\n| 1                                    | 1                                    | 1                                    | 1                                    |\n| VeryDifficultPassword!!#@#@!#!@#1231 | VeryDifficultPassword!!#@#@!#!@#1231 | VeryDifficultPassword!!#@#@!#!@#1231 | VeryDifficultPassword!!#@#@!#!@#1231 |\n+--------------------------------------+--------------------------------------+--------------------------------------+--------------------------------------+\n\nDatabase: expose\nTable: config\n[2 entries]\n+----+------------------------------+-----------------------------------------------------+\n| id | url                          | password                                            |\n+----+------------------------------+-----------------------------------------------------+\n| 1  | /file1010111/index.php       | 69c66901194a6486176e81f5945b8929                    |     \n| 3  | /upload-cv00101011/index.php | // ONLY ACCESSIBLE THROUGH USERNAME STARTING WITH Z |\n+----+------------------------------+-----------------------------------------------------+\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u9996\u5148\u4ece user \u8868\u4e2d\u5f97\u5230\u7684\u5bc6\u7801\u6839\u672c\u6ca1\u6709\u7528, \u8fd9\u4e2a\u9875\u9762\u597d\u50cf\u4e5f\u6ca1\u6709\u4ec0\u4e48\u7528\u4e86"}),"\n",(0,i.jsxs)(e.li,{children:["\u4ece config \u5f97\u5230\u4e24\u4e2a\u9690\u85cf\u9875\u9762, \u540c\u65f6\u8bbf\u95ee\u8fd9\u4e9b\u9875\u9762\u8fd8\u9700\u8981\u5bc6\u7801,","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"/file1010111/index.php \u8fd9\u4e2a\u7684\u5bc6\u7801\u6211\u4eec\u77e5\u9053, \u5e76\u4e14\u53ef\u4ee5\u89e3\u5bc6"}),"\n",(0,i.jsx)(e.li,{children:"/upload-cv00101011/index.php : \u6539\u5bc6\u7801\u63d0\u793a\u4e3aZ \u5f00\u5934\u7684\u7528\u6237\u540d\u79f0, \u5e76\u4e14\u67e5\u770b\u7f51\u9875\u6e90\u4ee3\u7801\u77e5\u9053\u8fd9\u4e2a\u9875\u9762\u662f\u4e00\u4e2a\u6587\u4ef6\u4e0a\u4f20\u7684\u4f4d\u7f6e"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703194147.png",alt:"20240703194147"})}),"\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528\u7834\u89e3\u7684\u5bc6\u7801\u8fdb\u884c\u767b\u9646\u53d1\u73b0\u7ed9\u51fa\u4e86\u4e00\u6bb5\u63d0\u793a\u5185\u5bb9"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703194200.png",alt:"20240703194200"})}),"\n",(0,i.jsx)(e.p,{children:"\u6240\u4ee5\u6211\u5f00\u59cb\u4f7f\u7528 wfuzz \u5f00\u59cb\u8dd1"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703194216.png",alt:"20240703194216"})}),"\n",(0,i.jsx)(e.p,{children:"\u4ece\u8fd9\u4e2a\u540d\u5b57\u53ef\u4ee5\u770b\u51fa\u8fd9\u662f\u4e00\u4e2a LFI \u6f0f\u6d1e, \u540c\u65f6\u5bf9\u4e8e /upload-cv00101011/index.php \u8fd9\u4e2a\u9875\u9762\u5b83\u5bf9\u4e8e\u5bc6\u7801\u7684\u63d0\u793a\u4e3a\u4f7f\u7528 z \u5f00\u5934\u7684\u673a\u5668\u540d\u79f0, \u56e0\u6b64\u53ef\u4ee5\u5c1d\u8bd5\u4f7f\u7528 LFI \u8bfb\u53d6 /etc/passwd \u6587\u4ef6\u5e76\u4f7f\u7528\u5f97\u5230\u7684\u7528\u6237\u540d\u8bbf\u95ee /upload-cv00101011/index.php, \u67e5\u770b\u6b64\u7f51\u9875\u7684\u6e90\u4ee3\u7801\u6211\u77e5\u9053\u53ea\u5141\u8bb8\u4e0a\u4f20 png jpg \u6587\u4ef6, \u5e76\u4e14\u53ea\u5728\u524d\u7aef\u6821\u9a8c\u540e\u7f00, \u6240\u4ee5\u5b8c\u5168\u53ef\u4ee5\u7ed5\u8fc7"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703194227.png",alt:"20240703194227"})}),"\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528 Burp \u6293\u5305\u8fdb\u884c\u4fee\u6539\u5373\u53ef, \u5e76\u4e14\u8fd8\u544a\u8bc9\u4e86\u6587\u4ef6\u4fdd\u5b58\u7684\u4f4d\u7f6e"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703194242.png",alt:"20240703194242"})}),"\n",(0,i.jsx)(e.h2,{id:"\u540e\u6e17\u900f",children:"\u540e\u6e17\u900f"}),"\n",(0,i.jsx)(e.h3,{id:"www-data",children:"www-data"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703194255.png",alt:"20240703194255"})}),"\n",(0,i.jsx)(e.h3,{id:"www-data--zeamkish",children:"www-data \u2014> zeamkish"}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u7528\u6237 zeamkish \u7684\u5bb6\u76ee\u5f55\u53d1\u73b0\u4e86 zeamkish \u7684\u51ed\u8bc1\u6587\u4ef6\u53ef\u4ee5\u76f4\u63a5\u767b\u9646"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703194312.png",alt:"20240703194312"})}),"\n",(0,i.jsx)(e.h3,{id:"zeamkish--root",children:"zeamkish \u2014> root"}),"\n",(0,i.jsx)(e.p,{children:"\u67e5\u627e SUID \u6587\u4ef6\u53d1\u73b0\u4e24\u4e2a\u7279\u6b8a\u7684\u7a0b\u5e8f"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"zeamkish@ip-10-10-188-190:/$ find / -user root -perm -4000 -print 2>/dev/null\n....\n/usr/bin/nano\n/usr/bin/su\n/usr/bin/fusermount\n/usr/bin/find\n.....\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u968f\u4fbf\u7528\u4e00\u4e2a\u6267\u884c\u5c31\u53ef\u4ee5, \u6211\u8fd9\u91cc\u4f7f\u7528 find"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703194328.png",alt:"20240703194328"})})]})}function p(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(d,{...n})}):d(n)}},28453:(n,e,s)=>{s.d(e,{R:()=>a,x:()=>o});var i=s(96540);const r={},t=i.createContext(r);function a(n){const e=i.useContext(t);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:a(n.components),i.createElement(t.Provider,{value:e},n.children)}}}]);