"use strict";(self.webpackChunkguardian_jtz_github_io=self.webpackChunkguardian_jtz_github_io||[]).push([[4711],{2537:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>c,contentTitle:()=>i,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>d});var s=t(74848),o=t(28453);const a={sidebar_position:75,tags:["Easy","Linux","\u6587\u4ef6\u9690\u5199","SUID"],title:"KoTH Food CTF",description:"KoTH Food CTF",sidebar_label:"KoTH Food CTF",slug:"/tryhackme/75"},i="KoTH Food CTF",r={id:"box/TryHackMe/75",title:"KoTH Food CTF",description:"KoTH Food CTF",source:"@site/docs/box/TryHackMe/75.md",sourceDirName:"box/TryHackMe",slug:"/tryhackme/75",permalink:"/docs/tryhackme/75",draft:!1,unlisted:!1,tags:[{label:"Easy",permalink:"/docs/tags/easy"},{label:"Linux",permalink:"/docs/tags/linux"},{label:"\u6587\u4ef6\u9690\u5199",permalink:"/docs/tags/\u6587\u4ef6\u9690\u5199"},{label:"SUID",permalink:"/docs/tags/suid"}],version:"current",sidebarPosition:75,frontMatter:{sidebar_position:75,tags:["Easy","Linux","\u6587\u4ef6\u9690\u5199","SUID"],title:"KoTH Food CTF",description:"KoTH Food CTF",sidebar_label:"KoTH Food CTF",slug:"/tryhackme/75"},sidebar:"boxSidebar",previous:{title:"MD2PDF",permalink:"/docs/tryhackme/74"},next:{title:"Expose",permalink:"/docs/tryhackme/76"}},c={},d=[{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:2},{value:"16109",id:"16109",level:2},{value:"46969",id:"46969",level:2},{value:"\u540e\u6e17\u900f",id:"\u540e\u6e17\u900f",level:2},{value:"pasta",id:"pasta",level:3},{value:"pasta \u2014&gt; root",id:"pasta--root",level:3},{value:"\u6269\u5c55",id:"\u6269\u5c55",level:2},{value:"mysql",id:"mysql",level:3},{value:"15065",id:"15065",level:3}];function l(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",...(0,o.R)(),...n.components},{Details:t}=e;return t||function(n,e){throw new Error("Expected "+(e?"component":"object")+" `"+n+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.h1,{id:"koth-food-ctf",children:"KoTH Food CTF"}),"\n",(0,s.jsx)(e.h2,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"root@ip-10-10-185-114:~/kothfoodctf# nmap -sTCV -p 22,3306,9999,15065,16109,46969 --min-rate 1000 10.10.22.160\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2023-09-06 09:24 BST\nNmap scan report for ip-10-10-22-160.eu-west-1.compute.internal (10.10.22.160)\nHost is up (0.00039s latency).\n\nPORT      STATE SERVICE VERSION\n22/tcp    open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   2048 28:0c:0c:d9:5a:7d:be:e6:f4:3c:ed:10:51:49:4d:19 (RSA)\n|   256 17:ce:03:3b:bb:20:78:09:ab:76:c0:6d:8d:c4:df:51 (ECDSA)\n|_  256 07:8a:50:b5:5b:4a:a7:6c:c8:b3:a1:ca:77:b9:0d:07 (EdDSA)\n3306/tcp  open  mysql   MySQL 5.7.29-0ubuntu0.18.04.1\n| mysql-info: \n|   Protocol: 10\n|   Version: 5.7.29-0ubuntu0.18.04.1\n|   Thread ID: 5\n|   Capabilities flags: 65535\n|   Some Capabilities: SupportsCompression, SupportsLoadDataLocal, Support41Auth, LongPassword, FoundRows, Speaks41ProtocolNew, SupportsTransactions, ODBCClient, Speaks41ProtocolOld, SwitchToSSLAfterHandshake, IgnoreSpaceBeforeParenthesis, IgnoreSigpipes, InteractiveClient, ConnectWithDatabase, DontAllowDatabaseTableColumn, LongColumnFlag, SupportsAuthPlugins, SupportsMultipleResults, SupportsMultipleStatments\n|   Status: Autocommit\n|   Salt: S\\x13\\x10%\\x1CSxfzC\\x1F\\x1C)nCx9\\x08`&\n|_  Auth Plugin Name: 96\n9999/tcp  open  abyss?\n| fingerprint-strings: \n|   FourOhFourRequest: \n|     HTTP/1.0 200 OK\n|     Date: Wed, 06 Sep 2023 08:24:49 GMT\n|     Content-Length: 4\n|     Content-Type: text/plain; charset=utf-8\n|     king\n|   GenericLines, Help, Kerberos, LDAPSearchReq, LPDString, RTSPRequest, SIPOptions, SSLSessionReq, TLSSessionReq: \n|     HTTP/1.1 400 Bad Request\n|     Content-Type: text/plain; charset=utf-8\n|     Connection: close\n|     Request\n|   GetRequest, HTTPOptions: \n|     HTTP/1.0 200 OK\n|     Date: Wed, 06 Sep 2023 08:24:48 GMT\n|     Content-Length: 4\n|     Content-Type: text/plain; charset=utf-8\n|_    king\n15065/tcp open  http    Golang net/http server (Go-IPFS json-rpc or InfluxDB API)\n|_http-title: Host monitoring\n16109/tcp open  unknown\n| fingerprint-strings: \n|   GenericLines: \n|     HTTP/1.1 400 Bad Request\n|     Content-Type: text/plain; charset=utf-8\n|     Connection: close\n|     Request\n|   GetRequest: \n|     HTTP/1.0 200 OK\n|     Date: Wed, 06 Sep 2023 08:24:48 GMT\n|     Content-Type: image/jpeg\n|     JFIF\n|     #*%%*525EE\\xff\n|     #*%%*525EE\\xff\n|     $3br\n|     %&'()*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz\n|     &'()*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz\n|     Y$?_\n|     qR]$Oyk\n|_    |$o.\n46969/tcp open  telnet  Linux telnetd\n2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :\n"})}),"\n",(0,s.jsx)(e.h2,{id:"16109",children:"16109"}),"\n",(0,s.jsx)(e.p,{children:"\u8bbf\u95ee\u6b64\u7aef\u53e3, \u9875\u9762\u663e\u793a\u662f\u4e00\u4e2a\u7167\u7247,\u6211\u5c06\u5176\u4e0b\u8f7d\u5230\u672c\u5730\u8fdb\u884c\u67e5\u770b, \u53d1\u73b0\u5176\u5b58\u5728\u6587\u4ef6\u9690\u5199, \u4e14\u6ca1\u6709\u5bc6\u7801"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'root@ip-10-10-185-114:~/kothfoodctf# steghide info download.jpeg \n"download.jpeg":\n  format: jpeg\n  capacity: 21.2 KB\nTry to get information about embedded data ? (y/n) y\nEnter passphrase: \n  embedded file "creds.txt":\n    size: 21.0 Byte\n    encrypted: rijndael-128, cbc\n    compressed: yes\nroot@ip-10-10-185-114:~/kothfoodctf# \nroot@ip-10-10-185-114:~/kothfoodctf# ls\ndownload.jpeg  _download.jpeg.extracted\nroot@ip-10-10-185-114:~/kothfoodctf# steghide extract -sf   download.jpeg \nEnter passphrase: \nwrote extracted data to "creds.txt".\nroot@ip-10-10-185-114:~/kothfoodctf# cat creds.txt \npasta:pastaisdynamic\nroot@ip-10-10-185-114:~/kothfoodctf#\n'})}),"\n",(0,s.jsx)(e.h2,{id:"46969",children:"46969"}),"\n",(0,s.jsx)(e.p,{children:"\u5728 nmap \u4e2d\u5bf9\u4e8e\u6b64\u7aef\u53e3\u7684\u626b\u63cf\u4e3a"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"46969/tcp open  telnet  Linux telnetd\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u6211\u8fdb\u884c\u8fde\u63a5\u540e, \u53d1\u73b0\u5176\u9700\u8981\u6211\u63d0\u4f9b\u7528\u6237\u540d\u548c\u5bc6\u7801, \u6b63\u597d\u4e0a\u9762\u4ece\u7167\u7247\u4e2d\u63d0\u53d6\u5230\u4e86\u5bc6\u7801, \u53d1\u73b0\u76f4\u63a5\u5c31\u53ef\u4ee5\u767b\u9646"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703193058.png",alt:"20240703193058"})}),"\n",(0,s.jsx)(e.p,{children:"\u6240\u4ee5\u8bf4\u4ece\u7167\u7247\u4e2d\u63d0\u53d6\u5230\u7684\u5bc6\u7801\u5176\u5b9e\u662f\u4e00\u4e2a\u8d26\u6237 (\u8fd9\u91cc\u5e76\u6ca1\u6709\u8003\u8651\u5168\u9762, \u5f53\u65f6\u6211\u53ea\u4f7f\u7528\u6b64\u5bc6\u7801\u5c1d\u8bd5\u4e86 mysql \u767b\u9646)"}),"\n",(0,s.jsx)(e.h2,{id:"\u540e\u6e17\u900f",children:"\u540e\u6e17\u900f"}),"\n",(0,s.jsx)(e.h3,{id:"pasta",children:"pasta"}),"\n",(0,s.jsx)(e.p,{children:"\u4f7f\u7528\u6211\u4eec\u4ece\u4e0a\u9762\u5f97\u5230\u7684\u5bc6\u7801\u8fdb\u884c\u767b\u9646"}),"\n",(0,s.jsx)(e.h3,{id:"pasta--root",children:"pasta \u2014> root"}),"\n",(0,s.jsxs)(e.p,{children:["\u5f53\u6211\u679a\u4e3e SUID \u65f6, \u6211\u53d1\u73b0\u4e00\u4e2a\u7279\u6b8a\u7684\u7a0b\u5e8f, \u8fd9\u4e2a\u7a0b\u5e8f\u662f\u5b58\u5728\u6f0f\u6d1e\u7684, \u67e5\u627e\u540e\u53d1\u73b0\u5229\u7528\u811a\u672c ",(0,s.jsx)(e.a,{href:"https://www.exploit-db.com/exploits/41154",children:"GNU Screen 4.5.0 - Local Privilege Escalation"})]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703193136.png",alt:"20240703193136"})}),"\n",(0,s.jsx)(e.p,{children:"\u4e8e\u662f\u5c06 EXP \u4e0a\u4f20\u5230\u6211\u4eec\u7684\u9776\u673a\u8fdb\u884c\u6267\u884c, \u53d1\u73b0\u53ef\u4ee5\u83b7\u53d6\u5230 root \u6743\u9650"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703193208.png",alt:"20240703193208"})}),"\n",(0,s.jsx)(e.h2,{id:"\u6269\u5c55",children:"\u6269\u5c55"}),"\n",(0,s.jsx)(e.h3,{id:"mysql",children:"mysql"}),"\n",(0,s.jsxs)(e.p,{children:["\u5728\u770b\u89c1 mysql \u65f6\u6211\u5e76\u6ca1\u6709\u4f7f\u7528\u5f31\u5bc6\u7801\u8fdb\u884c\u5c1d\u8bd5, \u800c\u662f\u8f6c\u800c\u53bb\u67e5\u770b\u5176\u4ed6\u7aef\u53e3, \u4f46\u662f\u5176\u5b9e\u8fd9\u91cc\u662f\u4e00\u4e2a\u5f31\u5bc6\u7801  ",(0,s.jsx)(e.code,{children:"root:root"})," , \u5728\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u83b7\u53d6\u5230\u4e00\u4e2a flag \u4ee5\u53ca\u4e00\u4e2a\u7528\u6237\u7684\u5bc6\u7801"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"root@ip-10-10-89-147:~# mysql -u root -h 10.10.22.160 -p\nEnter password: \nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 9\nServer version: 5.7.29-0ubuntu0.18.04.1 (Ubuntu)\n\nCopyright (c) 2000, 2023, Oracle and/or its affiliates.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql> show databases;\n+--------------------+\n| Database           |\n+--------------------+\n| information_schema |\n| mysql              |\n| performance_schema |\n| sys                |\n| users              |\n+--------------------+\n5 rows in set (0.01 sec)\n\nmysql> use users;\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\nmysql> show tables;\n+-----------------+\n| Tables_in_users |\n+-----------------+\n| User            |\n+-----------------+\n1 row in set (0.01 sec)\n\nmysql> SELECt * FROM User;\n+----------+---------------------------------------+\n| username | password                              |\n+----------+---------------------------------------+\n| ramen    | noodlesRTheBest                       |\n| flag     | thm{2f30841ff8d9646845295135adda8332} |\n+----------+---------------------------------------+\n"})}),"\n",(0,s.jsx)(e.h3,{id:"15065",children:"15065"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703193245.png",alt:"20240703193245"})}),"\n",(0,s.jsx)(e.p,{children:"\u8fdb\u884c\u76ee\u5f55\u626b\u63cf\u53ef\u4ee5\u53d1\u73b0\u4e00\u4e2a\u76ee\u5f55, \u8bbf\u95ee\u53d1\u73b0\u7684\u9875\u9762"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703193309.png",alt:"20240703193309"})}),"\n",(0,s.jsxs)(e.p,{children:["\u6211\u4eec\u67e5\u770b\u7f51\u9875, \u53ef\u4ee5\u5728\u5176\u4e2d\u53d1\u73b0\u4e00\u6bb5 JS \u5185\u5bb9, \u4f46\u662f\u5df2\u7ecf\u6df7\u6dc6\u4e86 (\u8be6\u7ec6\u5206\u6790\u67e5\u770b\u540e\u9762), \u67e5\u770b\u53d1\u51fa\u7684\u8bf7\u6c42, \u5728\u5176\u4e2d\u53d1\u73b0\u4e00\u4e2a api \u662f : ",(0,s.jsx)(e.code,{children:"/api/cmd"})," , \u5e76\u4e14\u67e5\u770b\u5176\u8bf7\u6c42\u53d1\u73b0\u5185\u5bb9\u4e3a: ",(0,s.jsx)(e.code,{children:"ping -c 4 127.0.0.1"})]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703193327.png",alt:"20240703193327"})}),"\n",(0,s.jsx)(e.p,{children:"\u6211\u4eec\u53ef\u4ee5\u57fa\u4e8e\u6b64\u6765\u8fdb\u884c\u81ea\u5b9a\u4e49 /api/cmd \u8bf7\u6c42, \u53d1\u73b0\u53ef\u4ee5\u6267\u884c, \u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u57fa\u4e8e\u6b64\u6765\u83b7\u53d6\u4e00\u4e2a Shell"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703193344.png",alt:"20240703193344"})}),"\n",(0,s.jsxs)(t,{children:[(0,s.jsx)("summary",{children:"JS \u4ee3\u7801\u89e3\u91ca"}),(0,s.jsx)(e.p,{children:"\u5f53\u6211\u4eec\u63d0\u4ea4\u8f93\u5165\u540e, \u4f1a\u6267\u884c pingHost() \u51fd\u6570, \u6211\u4eec\u53ea\u8981\u5bf9\u5176\u8fdb\u884c\u5206\u6790\u5c31\u53ef\u4ee5\u638c\u63e1\u5927\u81f4\u6d41\u7a0b"}),(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"async function pingHost() {\n    const _0x25c165 = document[_0x4d67('0x5')]('#outputSection');\n    const _0x2e78af = document[_0x4d67('0x5')](_0x4d67('0x2'));\n    const _0x1185f3 = _0x2e78af[_0x4d67('0x1')];\n    if (_0x1185f3 !== undefined && _0x1185f3 !== '' && ValidateIPaddress(_0x1185f3)) {\n        _0x25c165[_0x4d67('0x0')] = _0x4d67('0x6') + _0x1185f3 + '\\x0a';\n        const _0x27c227 = await postData('/api/cmd', 'ping\\x20-c\\x204\\x20' + _0x1185f3);\n        _0x25c165['textContent'] += await _0x27c227['text']();\n    } else {\n        _0x25c165[_0x4d67('0x0')] = _0x4d67('0x4');\n    }\n}\n"})}),(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["\u524d\u4e09\u884c\u7684\u5185\u5bb9\u662f\u4e3a\u4e86\u83b7\u53d6\u6211\u4eec\u7684\u8f93\u5165\u4ee5\u53ca\u540e\u7eed\u7ed3\u679c\u8f93\u51fa\u5730\n",(0,s.jsx)(e.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703193425.png",alt:"20240703193425"})]}),"\n",(0,s.jsx)(e.li,{children:"\u5bf9\u4e8e ValidateIPaddress() \u51fd\u6570\u7ecf\u8fc7\u5224\u65ad\u662f\u6821\u9a8c\u6211\u4eec\u7684\u8f93\u5165\u662f\u5426\u7b26\u5408 ipv4 \u7684\u8981\u6c42, \u5982\u679c\u7b26\u5408\u5c31\u5411 /api/cmd \u53d1\u51fa\u8bf7\u6c42"}),"\n"]})]})]})}function p(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(l,{...n})}):l(n)}},28453:(n,e,t)=>{t.d(e,{R:()=>i,x:()=>r});var s=t(96540);const o={},a=s.createContext(o);function i(n){const e=s.useContext(a);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:i(n.components),s.createElement(a.Provider,{value:e},n.children)}}}]);