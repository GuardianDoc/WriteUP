"use strict";(self.webpackChunkguardian_jtz_github_io=self.webpackChunkguardian_jtz_github_io||[]).push([[9763],{65830:(e,i,s)=>{s.r(i),s.d(i,{assets:()=>d,contentTitle:()=>r,default:()=>m,frontMatter:()=>t,metadata:()=>o,toc:()=>c});var a=s(74848),n=s(28453);const t={sidebar_position:104,tags:["Easy","Linux","\u547d\u4ee4\u6267\u884c","\u4fe1\u606f\u6cc4\u9732","capabilities"],title:"Empline",description:"Empline",sidebar_label:"Empline",slug:"/tryhackme/104"},r="Empline",o={id:"box/TryHackMe/104",title:"Empline",description:"Empline",source:"@site/docs/box/TryHackMe/104.md",sourceDirName:"box/TryHackMe",slug:"/tryhackme/104",permalink:"/docs/tryhackme/104",draft:!1,unlisted:!1,tags:[{label:"Easy",permalink:"/docs/tags/easy"},{label:"Linux",permalink:"/docs/tags/linux"},{label:"\u547d\u4ee4\u6267\u884c",permalink:"/docs/tags/\u547d\u4ee4\u6267\u884c"},{label:"\u4fe1\u606f\u6cc4\u9732",permalink:"/docs/tags/\u4fe1\u606f\u6cc4\u9732"},{label:"capabilities",permalink:"/docs/tags/capabilities"}],version:"current",sidebarPosition:104,frontMatter:{sidebar_position:104,tags:["Easy","Linux","\u547d\u4ee4\u6267\u884c","\u4fe1\u606f\u6cc4\u9732","capabilities"],title:"Empline",description:"Empline",sidebar_label:"Empline",slug:"/tryhackme/104"},sidebar:"boxSidebar",previous:{title:"Wekor",permalink:"/docs/tryhackme/103"},next:{title:"The Great Escape",permalink:"/docs/tryhackme/105"}},d={},c=[{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:2},{value:"80",id:"80",level:2},{value:"\u540e\u6e17\u900f",id:"\u540e\u6e17\u900f",level:2},{value:"www-data",id:"www-data",level:3},{value:"www-data \u2014&gt; george",id:"www-data--george",level:3},{value:"george \u2014&gt; root",id:"george--root",level:3}];function l(e){const i={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",...(0,n.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.h1,{id:"empline",children:"Empline"}),"\n",(0,a.jsx)(i.h2,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-bash",children:"root@ip-10-10-77-72:~/empline# nmap -sTCV -p 22,80,3306 --min-rate 1000 10.10.139.253\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2023-09-19 08:43 BST\nNmap scan report for ip-10-10-139-253.eu-west-1.compute.internal (10.10.139.253)\nHost is up (0.00014s latency).\n\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   2048 c0:d5:41:ee:a4:d0:83:0c:97:0d:75:cc:7b:10:7f:76 (RSA)\n|   256 83:82:f9:69:19:7d:0d:5c:53:65:d5:54:f6:45:db:74 (ECDSA)\n|_  256 4f:91:3e:8b:69:69:09:70:0e:82:26:28:5c:84:71:c9 (EdDSA)\n80/tcp   open  http    Apache httpd 2.4.29 ((Ubuntu))\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: Empline\n3306/tcp open  mysql   MySQL 5.5.5-10.1.48-MariaDB-0ubuntu0.18.04.1\n| mysql-info: \n|   Protocol: 10\n|   Version: 5.5.5-10.1.48-MariaDB-0ubuntu0.18.04.1\n|   Thread ID: 87\n|   Capabilities flags: 63487\n|   Some Capabilities: IgnoreSigpipes, InteractiveClient, SupportsCompression, SupportsTransactions, Support41Auth, IgnoreSpaceBeforeParenthesis, LongPassword, Speaks41ProtocolNew, Speaks41ProtocolOld, FoundRows, SupportsLoadDataLocal, DontAllowDatabaseTableColumn, ODBCClient, ConnectWithDatabase, LongColumnFlag, SupportsMultipleResults, SupportsAuthPlugins, SupportsMultipleStatments\n|   Status: Autocommit\n|   Salt: .Id<>`L:}+WW.}OQ(p~K\n|_  Auth Plugin Name: 111\nMAC Address: 02:BC:49:DF:60:C1 (Unknown)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 8.47 seconds\n"})}),"\n",(0,a.jsx)(i.p,{children:"\u8fd9\u91cc\u867d\u7136\u5f00\u653e\u4e86 3306 \u7aef\u53e3, \u4f46\u662f\u6211\u5c1d\u8bd5\u4e86\u5f31\u5bc6\u7801\u65e0\u679c\u540e\u5c31\u653e\u5f03\u4e86"}),"\n",(0,a.jsx)(i.h2,{id:"80",children:"80"}),"\n",(0,a.jsx)(i.p,{children:"\u5f53\u6211\u5728\u67e5\u770b\u7f51\u9875\u6e90\u4ee3\u7801\u65f6, \u6211\u53d1\u73b0\u5176\u4e2d\u6307\u5411\u4e86\u53e6\u4e00\u4e2a\u57df, \u6240\u4ee5\u73b0\u5728\u6709\u5fc5\u8981\u8f6c\u6218\u6218\u573a\u4e86"}),"\n",(0,a.jsx)(i.p,{children:(0,a.jsx)(i.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-131453.png",alt:"Untitled"})}),"\n",(0,a.jsx)(i.p,{children:"\u6211\u5c06\u5176\u6dfb\u52a0\u540e\u53c8\u679a\u4e3e\u4e86\u5b50\u57df\u4f46\u662f\u6ca1\u6709\u4efb\u4f55\u53d1\u73b0, \u5728\u6211\u8bbf\u95ee\u65b0\u53d1\u73b0\u7684\u57df\u65f6\u53d1\u73b0\u5176\u662f\u4e00\u4e2a CMS"}),"\n",(0,a.jsx)(i.p,{children:(0,a.jsx)(i.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-131453-1.png",alt:"Untitled"})}),"\n",(0,a.jsxs)(i.p,{children:["\u867d\u7136\u4e0d\u77e5\u9053\u7248\u672c, \u4f46\u662f\u8c37\u6b4c\u53d1\u73b0\u4e00\u4e2a RCE \u6f0f\u6d1e ",(0,a.jsx)(i.a,{href:"https://github.com/Nickguitar/RevCAT",children:"OpenCATS \u2264 0.9.4 RCE"})," \u4e0b\u8f7d\u540e\u53d1\u73b0\u53ef\u4ee5\u5229\u7528"]}),"\n",(0,a.jsx)(i.h2,{id:"\u540e\u6e17\u900f",children:"\u540e\u6e17\u900f"}),"\n",(0,a.jsx)(i.h3,{id:"www-data",children:"www-data"}),"\n",(0,a.jsx)(i.p,{children:"\u6267\u884c\u6211\u4eec\u4e0a\u9762\u7684\u7a0b\u5e8f\u6211\u4eec\u5c31\u53ef\u4ee5\u83b7\u53d6\u5230\u4e00\u4e2a Shell"}),"\n",(0,a.jsx)(i.p,{children:(0,a.jsx)(i.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-131453-2.png",alt:"Untitled"})}),"\n",(0,a.jsx)(i.h3,{id:"www-data--george",children:"www-data \u2014> george"}),"\n",(0,a.jsx)(i.p,{children:"\u8fd9\u79cd\u7f51\u7ad9\u76ee\u5f55\u4e2d\u4e00\u822c\u4f1a\u6709\u8fde\u63a5\u6570\u636e\u5e93\u7684\u914d\u7f6e\u6587\u4ef6, \u6240\u4ee5\u6211\u76f4\u63a5\u67e5\u627e\u5230\u6570\u636e\u5e93\u7684\u8fde\u63a5\u7528\u6237\u540d\u548c\u5bc6\u7801"}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-bash",children:"/* Database configuration. */\ndefine('DATABASE_USER', 'james');\ndefine('DATABASE_PASS', 'ng6pUFvsGNtw');\ndefine('DATABASE_HOST', 'localhost');\ndefine('DATABASE_NAME', 'opencats');\n"})}),"\n",(0,a.jsx)(i.p,{children:"\u4f7f\u7528\u6b64\u8fdb\u884c\u8fde\u63a5\u5e76\u4ece\u7f51\u7ad9\u6570\u636e\u5e93\u4e2d\u83b7\u53d6\u5230\u5173\u4e8e\u7528\u6237\u7684\u8d26\u6237\u4fe1\u606f"}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-bash",children:'+---------+---------+----------------+----------------------+----------------------------------+--------------+---------------------+--------------+---------------+------------+---------+------------+---------------------------------+---------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+-------+------------+------------+-------------+---------+-------+---------+------+-------+----------+---------+------------------+\n| user_id | site_id | user_name      | email                | password                         | access_level | can_change_password | is_test_user | last_name     | first_name | is_demo | categories | session_cookie                  | pipeline_entries_per_page | column_preferences                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | force_logout | title | phone_work | phone_cell | phone_other | address | notes | company | city | state | zip_code | country | can_see_eeo_info |\n+---------+---------+----------------+----------------------+----------------------------------+--------------+---------------------+--------------+---------------+------------+---------+------------+---------------------------------+---------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+-------+------------+------------+-------------+---------+-------+---------+------+-------+----------+---------+------------------+\n|       1 |       1 | admin          | admin@testdomain.com | b67b5ecc5d8902ba59c65596e4c053ec |          500 |                   1 |            0 | Administrator | CATS       |       0 | NULL       | CATS=bfkli2vopigogda9sph95k3mo6 |                        15 | a:6:{s:31:"home:ImportantPipelineDashboard";a:6:{i:0;a:2:{s:4:"name";s:10:"First Name";s:5:"width";i:85;}i:1;a:2:{s:4:"name";s:9:"Last Name";s:5:"width";i:75;}i:2;a:2:{s:4:"name";s:6:"Status";s:5:"width";i:75;}i:3;a:2:{s:4:"name";s:8:"Position";s:5:"width";i:275;}i:4;a:2:{s:4:"name";s:7:"Company";s:5:"width";i:210;}i:5;a:2:{s:4:"name";s:8:"Modified";s:5:"width";i:80;}}s:18:"home:CallsDataGrid";a:2:{i:0;a:2:{s:4:"name";s:4:"Time";s:5:"width";i:90;}i:1;a:2:{s:4:"name";s:4:"Name";s:5:"width";i:175;}}s:39:"candidates:candidatesListByViewDataGrid";a:9:{i:0;a:2:{s:4:"name";s:11:"Attachments";s:5:"width";i:31;}i:1;a:2:{s:4:"name";s:10:"First Name";s:5:"width";i:75;}i:2;a:2:{s:4:"name";s:9:"Last Name";s:5:"width";i:85;}i:3;a:2:{s:4:"name";s:4:"City";s:5:"width";i:75;}i:4;a:2:{s:4:"name";s:5:"State";s:5:"width";i:50;}i:5;a:2:{s:4:"name";s:10:"Key Skills";s:5:"width";i:215;}i:6;a:2:{s:4:"name";s:5:"Owner";s:5:"width";i:65;}i:7;a:2:{s:4:"name";s:7:"Created";s:5:"width";i:60;}i:8;a:2:{s:4:"name";s:8:"Modified";s:5:"width";i:60;}}s:25:"activity:ActivityDataGrid";a:7:{i:0;a:2:{s:4:"name";s:4:"Date";s:5:"width";i:110;}i:1;a:2:{s:4:"name";s:10:"First Name";s:5:"width";i:85;}i:2;a:2:{s:4:"name";s:9:"Last Name";s:5:"width";i:75;}i:3;a:2:{s:4:"name";s:9:"Regarding";s:5:"width";i:125;}i:4;a:2:{s:4:"name";s:8:"Activity";s:5:"width";i:65;}i:5;a:2:{s:4:"name";s:5:"Notes";s:5:"width";i:240;}i:6;a:2:{s:4:"name";s:10:"Entered By";s:5:"width";i:60;}}s:37:"companies:CompaniesListByViewDataGrid";a:9:{i:0;a:2:{s:4:"name";s:11:"Attachments";s:5:"width";i:10;}i:1;a:2:{s:4:"name";s:4:"Name";s:5:"width";i:255;}i:2;a:2:{s:4:"name";s:4:"Jobs";s:5:"width";i:40;}i:3;a:2:{s:4:"name";s:4:"City";s:5:"width";i:90;}i:4;a:2:{s:4:"name";s:5:"State";s:5:"width";i:50;}i:5;a:2:{s:4:"name";s:5:"Phone";s:5:"width";i:85;}i:6;a:2:{s:4:"name";s:5:"Owner";s:5:"width";i:65;}i:7;a:2:{s:4:"name";s:7:"Created";s:5:"width";i:60;}i:8;a:2:{s:4:"name";s:8:"Modified";s:5:"width";i:60;}}s:37:"joborders:JobOrdersListByViewDataGrid";a:12:{i:0;a:2:{s:4:"name";s:11:"Attachments";s:5:"width";i:10;}i:1;a:2:{s:4:"name";s:2:"ID";s:5:"width";i:26;}i:2;a:2:{s:4:"name";s:5:"Title";s:5:"width";i:170;}i:3;a:2:{s:4:"name";s:7:"Company";s:5:"width";i:135;}i:4;a:2:{s:4:"name";s:4:"Type";s:5:"width";i:30;}i:5;a:2:{s:4:"name";s:6:"Status";s:5:"width";i:40;}i:6;a:2:{s:4:"name";s:7:"Created";s:5:"width";i:55;}i:7;a:2:{s:4:"name";s:3:"Age";s:5:"width";i:30;}i:8;a:2:{s:4:"name";s:9:"Submitted";s:5:"width";i:18;}i:9;a:2:{s:4:"name";s:8:"Pipeline";s:5:"width";i:18;}i:10;a:2:{s:4:"name";s:9:"Recruiter";s:5:"width";i:65;}i:11;a:2:{s:4:"name";s:5:"Owner";s:5:"width";i:55;}}} |            0 |       |            |            |             | NULL    | NULL  | NULL    | NULL | NULL  | NULL     | NULL    |                0 |\n|    1250 |     180 | cats@rootadmin | 0                    | cantlogin                        |            0 |                   0 |            0 | Automated     | CATS       |       0 | NULL       | NULL                            |                        15 | NULL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |            0 |       |            |            |             | NULL    | NULL  | NULL    | NULL | NULL  | NULL     | NULL    |                0 |\n|    1251 |       1 | george         |                      | 86d0dfda99dbebc424eb4407947356ac |          400 |                   1 |            0 | Tasa          | George     |       0 | NULL       | NULL                            |                        15 | NULL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |            0 |       |            |            |             | NULL    | NULL  | NULL    | NULL | NULL  | NULL     | NULL    |                0 |\n|    1252 |       1 | james          |                      | e53fbdb31890ff3bc129db0e27c473c9 |          200 |                   1 |            0 | Gynja         | James      |       0 | NULL       | NULL                            |                        15 | NULL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |            0 |       |            |            |             | NULL    | NULL  | NULL    | NULL | NULL  | NULL     | NULL    |                0 |\n+---------+---------+----------------+----------------------+----------------------------------+--------------+---------------------+--------------+---------------+------------+---------+------------+---------------------------------+---------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+-------+------------+------------+-------------+---------+-------+---------+------+-------+----------+---------+------------------+\n'})}),"\n",(0,a.jsx)(i.p,{children:(0,a.jsx)(i.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-131453-3.png",alt:"Untitled"})}),"\n",(0,a.jsx)(i.p,{children:"\u4f7f\u7528\u5f97\u5230\u7684\u5bc6\u7801\u8fdb\u884c\u767b\u9646"}),"\n",(0,a.jsx)(i.h3,{id:"george--root",children:"george \u2014> root"}),"\n",(0,a.jsxs)(i.p,{children:["\u6211\u53d1\u73b0\u5b58\u5728 capabilities \u7a0b\u5e8f ",(0,a.jsx)(i.a,{href:"https://www.ctfiot.com/91844.html#:~:text=0%3B%0A%7D-,CAP_CHOWN,-CAP_CHOWN%3A%20%E5%8F%AF%E4%BB%A5",children:"capabilities - cap_chown"})]}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-bash",children:"george@empline:/home$ getcap -r / 2>/dev/null\n/usr/bin/mtr-packet = cap_net_raw+ep\n/usr/local/bin/ruby = cap_chown+ep\n"})}),"\n",(0,a.jsx)(i.p,{children:"\u6211\u4eec\u53ef\u4ee5\u57fa\u4e8e\u6b64\u6765\u4fee\u6539\u6587\u4ef6\u7684\u6240\u6709\u8005"}),"\n",(0,a.jsx)(i.p,{children:(0,a.jsx)(i.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-131453-4.png",alt:"Untitled"})})]})}function m(e={}){const{wrapper:i}={...(0,n.R)(),...e.components};return i?(0,a.jsx)(i,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},28453:(e,i,s)=>{s.d(i,{R:()=>r,x:()=>o});var a=s(96540);const n={},t=a.createContext(n);function r(e){const i=a.useContext(t);return a.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function o(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),a.createElement(t.Provider,{value:i},e.children)}}}]);